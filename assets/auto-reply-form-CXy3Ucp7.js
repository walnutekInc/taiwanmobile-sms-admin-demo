import{_ as We}from"./index.vuevuetypescriptsetuptruelang-C_IkRAcT.js";import{_ as xe,h as Qe,k as Je}from"./index-NTWfkyjL.js";import{d as ae,f as C,W as p,X as k,F as V,Y as o,u as e,a3 as K,a4 as F,m as ne,A as se,k as n,a5 as ve,_ as B,a9 as ye,K as Xe,c as J,a7 as Pe,$ as a,Q as Ze,ag as et,ah as tt,ab as q,G as u,r as X,H as $e,ad as nt,ac as st,D as at,w as ot,B as De}from"./vue-Ckfa8DnP.js";import{u as lt,_ as it,a as rt,b as ut,c as pt,d as ct}from"./route-leave-B1qDnqaA.js";import{_ as Te}from"./index.vuevuetypescriptsetuptruelang-CGx5Uo-M.js";import{O as je,P as dt,x as mt,T as ft,N as Ie,E as Re,Q as _t,K as P,U as gt,y as vt,V as yt,p as xt,n as ht,o as bt,J as wt,I as kt,B as $t,G as Tt,w as Ct,W as St,r as Ft,F as Mt}from"./antd-CCbBcq8G.js";import{i as Dt}from"./isToday-DHzkRyxX.js";import{u as jt,r as we}from"./custom-message-Dl8fTKJZ.js";import{u as Rt,M as Pt}from"./auto-reply-KhP3Fol0.js";import{a as ke}from"./tools-a0gbWjD6.js";import{u as It}from"./group-label-CKB1-NQJ.js";import"./context-BqaMzMDp.js";import"./index.esm-D-mEzxO1.js";import"./index.vuevuetypestyleindex0lang-B6Nhna9q.js";import"./request-CH5HkvW7.js";const At={class:"relative w-full h-full"},Nt=["controls","src"],Ot={key:0,class:"text-sms-grayscale-60 font-500 text-base text-center pt-2"},Ut={key:0,class:"text-sms-grayscale-60 font-500 text-base text-center pb-2"},zt=["src"],Ce=ae({name:"MultimediaPreview",__name:"index",props:{videoSource:{},showDelBtn:{type:Boolean,default:!0},showFileName:{type:Boolean,default:!0},canPlay:{type:Boolean,default:!0},imageClass:{default:"w-full"},size:{default:"large"}},emits:["deleteVideo"],setup(x,{emit:$}){const g=x,b=$,h=C(!1),r=C();function m(c){h.value=!c.target.paused}function f(){var c;g.canPlay&&((c=r.value)==null||c.play())}function v(){b("deleteVideo")}return(c,w)=>{const H=xe;return p(),k("div",At,[c.videoSource.type==="video"?(p(),k(V,{key:0},[o("video",{id:"video",ref_key:"videoRef",ref:r,class:"w-full h-full bg-sms-grayscale-100",controls:e(h),src:c.videoSource.url,onPlaying:m,onPause:m},null,40,Nt),c.showFileName?(p(),k("div",Ot,K(c.videoSource.fileName)+" ("+K(c.videoSource.fileSize)+") ",1)):F("",!0),ne(n(H,{name:"play-circle",width:c.size==="large"?"80px":"35px",class:"absolute top-50% left-50% translate-x-[-50%] translate-y-[-50%] cursor-pointer",onClick:f},null,8,["width"]),[[se,!e(h)]])],64)):c.videoSource.url?(p(),k(V,{key:1},[c.showFileName?(p(),k("div",Ut,K(c.videoSource.fileName)+" ("+K(c.videoSource.fileSize)+") ",1)):F("",!0),o("img",{src:c.videoSource.url,class:ve(c.imageClass)},null,10,zt)],64)):F("",!0),c.showDelBtn?(p(),B(H,{key:2,name:"close-circle",width:c.size==="large"?"32px":"16px",status:"small3",class:"absolute top-1 right-1 text-sms-grayscale-60 cursor-pointer",onClick:v},null,8,["width"])):F("",!0)])}}}),Et="/taiwanmobile-sms-admin-demo/assets/full-phone-rT6RnVLp.png",Bt=["src"],Kt={class:"max-h-706px overflow-auto absolute top-[150px] left-[30px] w-[calc(100%-50px)]"},Lt={class:"text-sms-grayscale-60 text-sm font-400 font-inter text-sm text-right"},Vt=["innerHTML"],Gt=ae({name:"FullPhonePreview",__name:"index",props:{message:{type:Array,default:()=>[]}},setup(x){function $(g="",b){return b?`<div class="font-700 text-17px font-sans">${b}</div>${g}`:g}return(g,b)=>{const h=Ce;return p(),k(V,null,[o("img",{src:e(Et),class:"w-428px"},null,8,Bt),o("div",Kt,[(p(!0),k(V,null,ye(x.message,r=>(p(),k("div",{key:r.key,class:ve(["flex flex-col mb-4",{"me-48px ms-5px":r.messageType==="GET","ms-48px me-20px":r.messageType==="SENT"}])},[o("div",Lt,K(r.phone),1),o("div",{class:ve(["flex w-full items-end justify-end gap-4",{"flex-row-reverse ":r.messageType==="GET"}])},[r.contentType==="text"?(p(),k("div",{key:0,class:ve(["bg-sms-grayscale-20 w-214px py-3 px-3 rounded-2 text-17px break-words",{"bg-sms-primary-blue-20":r.messageType==="SENT"}]),innerHTML:$(r.content,r.subject)},null,10,Vt)):r.content?(p(),B(h,{key:1,"video-source":{url:r.content,type:r.contentType},"show-file-name":!1,"show-del-btn":!1,"can-play":!1,"image-class":"w-50% block ms-auto"},null,8,["video-source"])):F("",!0)],2)],2))),128))])],64)}}}),Yt=ae({name:"TLiteTable",extends:je,inheritAttrs:!1,__name:"index",setup(x){const $=Xe(),g=J(()=>({...e($)}));return(b,h)=>(p(),B(e(je),q({class:"t-lite-table"},{...b.$props,...e(g),pagination:!1}),Pe({_:2},[ye(Object.keys(b.$slots),r=>({name:r,fn:a(m=>[Ze(b.$slots,r,et(tt(m||{})))])}))]),1040))}}),qt=o("span",{class:"text-red-500"},"*",-1),Ht=["accept"],Wt={for:"fileInput",class:"flex flex-col items-center justify-center h-full text-sms-grayscale-80 text-sm"},Qt=o("p",{class:""}," 拖曳圖片至此 ",-1),Jt=o("p",{class:""}," 拖曳影音至此 ",-1),Xt=ae({name:"DropFile",__name:"index",props:{uploadType:{type:String,default:"image"}},emits:["changeFile"],setup(x,{emit:$}){const g=x,b=$,h=[".jpg",".jpeg",".png",".gif"],r=[".mp4",".mp3"],m=C(),f=C(!1);function v(M){const O=M.target.files;O&&O.length>0&&m.value&&(b("changeFile",O),m.value.value="")}function c(M){M.preventDefault(),f.value=!0}function w(){f.value=!1}function H(M){var I,O;if(M.preventDefault(),m.value&&((I=M==null?void 0:M.dataTransfer)!=null&&I.files)){const D=[];for(const y of M.dataTransfer.files){const t=(O=y.name)==null?void 0:O.split(".").pop();g.uploadType==="image"?h.includes(`.${t}`)&&D.push(y):r.includes(`.${t}`)&&D.push(y)}D.length>0&&b("changeFile",D)}f.value=!1}return(M,I)=>{const O=xe,D=Te;return p(),k(V,null,[o("label",null,[u(K(x.uploadType==="image"?"上傳檔案":"上傳影音")+" ",1),qt]),o("div",{class:"dropzone-container",onDragover:c,onDragleave:w,onDrop:H},[o("input",{id:"fileInput",ref_key:"file",ref:m,type:"file",name:"file",class:"hidden",accept:x.uploadType==="image"?h.join(","):r.join(","),onChange:v},null,40,Ht),o("div",Wt,[n(O,{name:"upload-circle",width:"40px",class:"block mb-4",color:"var(--grayscale-40)"}),x.uploadType==="image"?(p(),k(V,{key:0},[Qt,o("p",null,[u(" 或點擊"),n(D,{class:"mx-2",onClick:I[0]||(I[0]=y=>{var t;return(t=e(m))==null?void 0:t.click()})},{default:a(()=>[u(" 開啟資料夾 ")]),_:1}),u("選擇圖片 ")])],64)):F("",!0),x.uploadType==="video"?(p(),k(V,{key:1},[Jt,o("p",null,[u(" 或點擊"),n(D,{class:"mx-2",onClick:I[1]||(I[1]=y=>{var t;return(t=e(m))==null?void 0:t.click()})},{default:a(()=>[u(" 開啟資料夾 ")]),_:1}),u("選擇影音 ")])],64)):F("",!0)])],32)],64)}}});function Zt(x){let $,g;return h=>({draggable:!0,ondrag(){$=h},ondrop(){g=h},ondragend(){if($&&g&&$!==g){const r=x.indexOf($),m=x.indexOf(g);[x[r],x[m]]=[x[m],x[r]],$=void 0,g=void 0}},ondragover(){return!1}})}const en={class:"px-20px pb-24px"},tn={class:"text-sms-grayscale-80 font-400 text-base text-center"},nn=o("br",null,null,-1),sn={class:"text-sms-primary-blue-80 font-700"},an={class:"text-sms-primary-blue-80 font-700"},on={class:"text-sms-primary-blue-80 font-700"},ln={class:"text-sms-status-alert-red text-sm font-400 text-center mt-4"},rn=o("p",{class:"text-sms-grayscale-80 font-400 text-base"}," 可上傳 2 張圖片，格式為 jpg、png、gif ",-1),un=o("p",{class:"text-sms-grayscale-80 font-400 text-base"}," 可上傳 1 個影音，格式為 mp4、mp3 ",-1),pn={key:1,class:"h-auto"},cn=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"}," 刪除的檔案將無法復原 ",-1),dn={key:0,class:"text-center py-40px w-523px h-auto text-base mx-auto"},mn=ae({__name:"multimedia-upload-modal",emits:["updateMultimediaFile"],setup(x,{expose:$,emit:g}){const b=g;function h(_){return _===0?"0KB":`${Number.parseFloat((_/1024**1).toFixed(0))}KB`}const r=C("image"),m=C(!1),f=X([]),v=X([]),c=C(!1),w=J(()=>{let _=v.reduce((i,T)=>i+(T==null?void 0:T.size),0);return _=f.reduce((i,T)=>i+(T==null?void 0:T.size),_),_});function H(_){for(const i of _)v.push({key:v.length+1,fileName:i.name,size:i.size,fileSize:h(i.size),file:i,type:"image",url:URL.createObjectURL(i)})}function M(_){if(_.length>0){const i=_[0];f.push({key:f.length+1,fileName:i.name,size:i.size,fileSize:h(i.size),file:i,type:"video",url:URL.createObjectURL(i)})}}function I(_){v.length=0;const i=Object.assign([],_.filter(G=>G.type==="image"));v.push(...i),f.length=0;const T=Object.assign([],_.filter(G=>G.type==="video"));f.push(...T),m.value=!0}const D=[{title:"拖曳順序",dataIndex:"drop",key:"drop",width:"80px",customCell:Zt(v)},{title:"檔案名稱",dataIndex:"fileName",key:"fileName",width:"200px",ellipsis:!0},{title:"檔案大小",dataIndex:"fileSize",key:"fileSize",width:"80px"},{title:"預覽",dataIndex:"preview",key:"preview",width:"60px"},{title:"刪除",dataIndex:"del",key:"del",width:"60px"}],y=X({open:!1,type:"image",index:0,delAll:!1});function t(_,i,T){Object.assign(y,{open:!0,type:i,delAll:_,index:T})}function Z(){y.delAll?(v.length=0,f.length=0,U()):y.type==="image"?v.splice(y.index,1):f.splice(y.index,1),y.open=!1}function he(_){_.stopImmediatePropagation(),v.length>0||f.length>0?t(!0):m.value=!1}function U(){if(Number.parseInt(h(w.value).replace("KB",""))>300){c.value=!0;return}b("updateMultimediaFile",e(v).concat(e(f))),m.value=!1}const W=X({open:!1,file:void 0});return $({show:I}),(_,i)=>{const T=Xt,G=xe,Y=Te,ue=Yt,pe=mt,oe=Ce,ce=ft,le=Ie;return p(),k(V,null,[n(le,{open:e(m),"onUpdate:open":i[2]||(i[2]=j=>$e(m)?m.value=j:null),title:"多媒體附件上傳",centered:"",width:"600px","cancel-text":"取消","ok-text":"確定",onOk:U},{closeIcon:a(()=>[n(e(dt),{class:"ant-modal-close-icon text-black",onClick:he})]),default:a(()=>[o("div",en,[o("div",tn,[u(" 請注意，MMS 多媒體附件 (圖片檔/影音檔)，總大小不可超過 300KB "),nn,u(" 目前已上傳 "),o("span",sn,K(e(v).length),1),u(" 個圖片檔、"),o("span",an,K(e(f).length),1),u(" 個影音檔，共 "),o("span",on,K(h(e(w))),1)]),ne(o("div",ln," 超過 300KB 上限，請修正 ",512),[[se,e(c)]])]),n(ce,{activeKey:e(r),"onUpdate:activeKey":i[1]||(i[1]=j=>$e(r)?r.value=j:null),type:"card","destroy-inactive-tab-pane":!0,class:"full-border-tab last-child-rounded"},{default:a(()=>[n(pe,{key:"image",tab:"圖片"},{default:a(()=>[rn,e(v).length<2?(p(),B(T,{key:0,"upload-type":"image",onChangeFile:H})):F("",!0),ne(n(ue,{columns:D,"data-source":e(v)},{bodyCell:a(({column:j,index:de,record:be})=>[j.dataIndex==="drop"?(p(),B(Y,{key:0,status:"small3"},{icon:a(()=>[n(G,{name:"menu",class:"text-sms-grayscale-100",width:"16px"})]),_:1})):F("",!0),j.dataIndex==="preview"?(p(),B(Y,{key:1,status:"small3",onClick:me=>{e(W).file=be,e(W).open=!0}},{icon:a(()=>[n(G,{name:"preview-blue",class:"text-sms-primary-blue-80"})]),_:2},1032,["onClick"])):F("",!0),j.dataIndex==="del"?(p(),B(Y,{key:2,status:"small3",onClick:me=>t(!1,"image",de)},{icon:a(()=>[n(G,{name:"del-blue",class:"text-sms-primary-blue-80"})]),_:2},1032,["onClick"])):F("",!0)]),_:1},8,["data-source"]),[[se,e(v).length>0]])]),_:1},8,["tab"]),n(pe,{key:"video",tab:"影音"},{default:a(()=>[un,e(f).length<1?(p(),B(T,{key:0,"upload-type":"video",onChangeFile:M})):F("",!0),e(f).length>0?(p(),k("div",pn,[n(oe,{"video-source":e(f)[0],onDeleteVideo:i[0]||(i[0]=j=>t(!1,"video",0))},null,8,["video-source"])])):F("",!0)]),_:1},8,["tab"])]),_:1},8,["activeKey"])]),_:1},8,["open"]),n(le,{open:e(y).open,"onUpdate:open":i[3]||(i[3]=j=>e(y).open=j),title:e(y).delAll?"是否刪除所有已上傳的檔案？":"是否刪除已上傳的檔案？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onOk:Z},{default:a(()=>[cn]),_:1},8,["open","title"]),n(le,{open:e(W).open,"onUpdate:open":i[4]||(i[4]=j=>e(W).open=j),title:" ",centered:"",footer:null,width:"960px"},{default:a(()=>[e(W).file?(p(),k("div",dn,[n(oe,{"video-source":e(W).file,"show-del-btn":!1,"image-class":"h-auto w-auto"},null,8,["video-source"])])):F("",!0)]),_:1},8,["open"])],64)}}}),fn=o("span",{class:"pe-.5"},"接收關鍵字",-1),_n=o("span",{class:"text-red-500 pe-2"},"*",-1),gn={href:"javascript:;"},vn=o("br",null,null,-1),yn=o("br",null,null,-1),xn=o("br",null,null,-1),hn={class:"flex justify-between w-full items-center"},bn=o("span",{class:"pe-1"},"群組標籤設定",-1),wn={href:"javascript:;"},kn=o("span",null,"新增群組標籤",-1),$n=o("span",{class:"pe-.5"},"自動回覆訊息內容",-1),Tn=o("span",{class:"text-red-500 pe-2"},"*",-1),Cn={href:"javascript:;"},Sn=o("br",null,null,-1),Fn=o("br",null,null,-1),Mn={class:"flex gap-2 overflow-y-auto h-95px"},Dn={class:"text-sms-grayscale-60 text-xs font-500 font-sans text-center break-words"},jn=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"}," 刪除的檔案將無法復原 ",-1),Rn=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"},[u(" 您編輯過的內容將全部清空 "),o("br"),o("p",null,[u(" 提醒您，SMS支援的字數較MMS少，"),o("br"),u(" 且不能上傳多媒體附件 ")])],-1),Hn=ae({__name:"auto-reply-form",setup(x){Re.extend(Dt);const{getGroupLabelOption:$,groupOptions:g}=It(),{setHideAlert:b,setShowAlert:h}=lt(),r=nt(),m=Qe(),f=st(),v=Je(),{replaceFieldToHtml:c}=jt(),{autoReply:w,getAutoReply:H,updateAutoReply:M,createAutoReply:I,checkAcceptKeywordExist:O}=Rt(),D=J(()=>f.name==="AutoReplyCreate");let y={phone:void 0,acceptKeyword:"",subject:"",messageType:"SMS",multimediaFile:[],group:void 0,newGroupName:"",takeEffectDates:void 0,content:""};const t=X(_t(y)),Z=J(()=>t.messageType==="SMS"?335:1e3),he=X({phone:[{required:!0,message:"請選擇發送門號",trigger:"blur"}],acceptKeyword:[{async validator(l,s){return P(s)?Promise.reject("請輸入接收關鍵字"):!P(s)&&await O(s)?Promise.reject(`生效開始與結束日期已存在接收關鍵字「 ${s} 」的設定，請勿重複新增`):Promise.resolve()},trigger:"blur"}],takeEffectDates:[{required:!0,message:"請選擇生效起迄日",trigger:"blur"}],subject:[{async validator(l,s){return t.messageType==="MMS"&&P(s)?Promise.reject("請輸入訊息主旨"):Promise.resolve()},trigger:"blur"}],content:[{async validator(l,s){var S;return P(s)?Promise.reject("請輸入自動回覆訊息內容"):!P(s)&&((S=t.content)==null?void 0:S.replace(we,"").length)>Z.value?Promise.reject(`限制輸入 ${Z.value} 字以內`):Promise.resolve()},trigger:"blur"}]}),{validateInfos:U,validate:W,clearValidate:_,resetFields:i}=gt(t,he);at(async()=>{var l,s,S,z,R,A,L,ee,_e,te,ge;D.value||(await H(f.params.id),y={phone:(l=w.value)==null?void 0:l.phone,acceptKeyword:((s=w.value)==null?void 0:s.acceptKeyword)??"",subject:((S=w.value)==null?void 0:S.subject)??"",messageType:((z=w.value)==null?void 0:z.messageType)??"SMS",multimediaFile:((R=w.value)==null?void 0:R.multimediaFile)??[],group:(L=(A=w.value)==null?void 0:A.group)!=null&&L.id?[(ee=w.value)==null?void 0:ee.group.id]:void 0,newGroupName:"",takeEffectDates:(_e=w.value)!=null&&_e.startDate&&((te=w.value)!=null&&te.endDate)?[w.value.startDate,w.value.endDate]:void 0,content:c((ge=w.value)==null?void 0:ge.content)},i(y)),m.handleSelectedKeys(["/sms-marketing/auto-reploy"]),$()});const T=C(),G=J(()=>vt(t.group)||P(t.group)?g.value:g.value.map(l=>({...l,class:"pointer-events-none"}))),Y=C(!0),ue=J(()=>D.value?"新增自動回覆":"編輯自動回覆");ot(()=>t,l=>{yt(l,y)?b():h()},{deep:!0});function pe(){W().then(async()=>{var S;((S=(await(e(D)?I:M)(t,f.params.id)).data)==null?void 0:S.status)==="success"&&(v.success({message:e(D)?"自動回覆新增成功":"自動回覆編輯成功",placement:"top"}),b(),r.push("/sms-marketing/auto-reply"))}).catch(l=>{console.log(l)})}const oe=C(null);function ce(l){t.content=c(l)}const le=C(null);function j(l){for(const s of l)t.content=`${t.content}<span>${s}</span>`}const de=C(null);function be(l){t.content=`${t.content}<a href="${l}">${l}</a>`}const me=C(null),fe=C();function Ae(l){fe.value=l}function Ne(l){const s=l&&!l.isToday()&&l<Re().endOf("day");if(fe.value&&fe.value[0]){const S=l.diff(fe.value[0],"day")>365;return s||S}else return s}const Oe=J(()=>{const l=[];if(P(t.acceptKeyword)||l.push({content:t.acceptKeyword,messageType:"GET",contentType:"text"}),(!P(t.content)||!P(t.subject))&&l.push({phone:t.phone,content:t.content,...t.messageType==="MMS"&&{subject:t.subject},messageType:"SENT",contentType:"text"}),!P(t.multimediaFile))for(const s of t.multimediaFile)l.push({phone:t.phone,content:s.url,messageType:"SENT",contentType:s.type});return l.map((s,S)=>({...s,key:S}))}),Se=C(null);function Ue(l){t.multimediaFile=l}const ie=X({open:!1});function ze(l){Object.assign(ie,{open:!0,delFile:l})}function Ee(){t.multimediaFile=t.multimediaFile.filter(l=>{var s;return l.url!==((s=ie.delFile)==null?void 0:s.url)}),Object.assign(ie,{open:!1,delFile:void 0})}const re=C(!1);function Be(){t.messageType==="SMS"?!P(t.content)||!P(t.multimediaFile)?re.value=!0:t.messageType="SMS":t.messageType="MMS"}return(l,s)=>{const S=xt,z=ht,R=bt,A=xe,L=wt,ee=kt,_e=$t,te=Te,ge=Tt,Ke=Ct,Le=St,Ve=Ce,Ge=ct,Fe=Ft,Ye=Mt,qe=Gt,Me=Ie,He=We;return p(),B(He,{title:e(ue),"custom-breadcrumb":[{title:"訊息行銷活動"},{path:"/sms-marketing/auto-reply",title:"自動回覆"},{title:e(ue)}]},{default:a(()=>[n(Fe,{class:"bg-sms-grayscale-0 rounded-4 p-10 pl-1",wrap:!1},{default:a(()=>[n(R,{flex:"auto"},{default:a(()=>[n(Ye,{class:"px-32px",layout:"vertical",autocomplete:"off",onSubmit:pe},{default:a(()=>[n(Fe,{gutter:[16,14]},{default:a(()=>[n(R,{span:24},{default:a(()=>[n(z,q(e(U).phone,{label:"發送門號",required:""}),{default:a(()=>[n(S,{value:e(t).phone,"onUpdate:value":s[0]||(s[0]=d=>e(t).phone=d),options:[{label:"0935-111-111",value:"0935-111-111"},{label:"0947-127-998",value:"0947-127-998"},{label:"0958-892-006",value:"0958-892-006"}],"allow-clear":"",placeholder:"請選擇發送門號"},null,8,["value"])]),_:1},16)]),_:1}),n(R,{span:24},{default:a(()=>[n(z,q(e(U).acceptKeyword,{extra:"最少 1 個字"}),{label:a(()=>[fn,_n,n(L,{placement:"top","get-popup-container":e(ke)},{title:a(()=>[u(" 假設情境："),vn,u(" Step1. 於此處設定接收關鍵字為「1」"),yn,u(" Step2. 傳送訊息，請客戶回覆「1」"),xn,u(" Step3. 若客戶回覆「1」，立即觸發自動回覆功能 ")]),default:a(()=>[o("a",gn,[n(A,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:a(()=>[n(ee,{value:e(t).acceptKeyword,"onUpdate:value":s[1]||(s[1]=d=>e(t).acceptKeyword=d),placeholder:"請輸入接收關鍵字"},null,8,["value"])]),_:1},16)]),_:1}),n(R,{span:24},{default:a(()=>[n(z,q(e(U).group,{"label-col":{style:{width:"100%"}},extra:"可選擇或新增 1 個標籤"}),{label:a(()=>[o("div",hn,[o("div",null,[bn,n(L,{placement:"top","get-popup-container":e(ke)},{title:a(()=>[u(" 將回傳該「接收關鍵字」的多筆門號打包至單一群組標籤，後續可進行再行銷 ")]),default:a(()=>[o("a",wn,[n(A,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),e(Y)?(p(),B(_e,{key:0,type:"link",class:"m-0 p-0",onClick:s[2]||(s[2]=De(()=>Y.value=!1,["prevent"]))},{icon:a(()=>[n(A,{name:"plus"})]),default:a(()=>[u(" 新增群組標籤 ")]),_:1})):F("",!0)])]),default:a(()=>[n(S,{ref_key:"groupRef",ref:T,value:e(t).group,"onUpdate:value":s[3]||(s[3]=d=>e(t).group=d),options:e(G),"allow-clear":"","show-arrow":"",disabled:!e(Y),placeholder:"請輸入",mode:"multiple",class:"w-full","option-filter-prop":"label","menu-item-selected-icon":" ",onSelect:s[4]||(s[4]=d=>{var Q;return(Q=e(T))==null?void 0:Q.blur()})},null,8,["value","options","disabled"])]),_:1},16)]),_:1}),ne(n(R,{span:24,class:"bg-sms-bg-light-mode-gray rounded-md !p-2 !px-3"},{default:a(()=>[n(z,q({extra:"只能新增 1 個群組標籤，15 字以內。"},e(U).newSmsCategory,{"label-col":{style:{width:"100%"}}}),{label:a(()=>[kn,n(te,{status:"small3",class:"m-0 p-0 ms-auto",onClick:s[5]||(s[5]=De(()=>{e(_)("newSmsCategory"),Y.value=!0},["prevent"]))},{icon:a(()=>[n(A,{name:"close"})]),_:1})]),default:a(()=>[n(ee,{value:e(t).newGroupName,"onUpdate:value":s[6]||(s[6]=d=>e(t).newGroupName=d),placeholder:"請輸入新群組標籤",maxlength:15},null,8,["value"])]),_:1},16)]),_:1},512),[[se,!e(Y)]]),n(R,{span:24},{default:a(()=>[n(z,q(e(U).takeEffectDates,{label:"生效開始與結束日期",extra:"最多可設定 1 年"}),{default:a(()=>[n(ge,{value:e(t).takeEffectDates,"onUpdate:value":s[7]||(s[7]=d=>e(t).takeEffectDates=d),format:"YYYY/MM/DD","value-format":"YYYY/MM/DD",placeholder:["請選擇生效開始結束日期",""],class:"w-full",separator:"～","disabled-date":Ne,onCalendarChange:Ae},null,8,["value"])]),_:1},16)]),_:1}),n(R,{span:24},{default:a(()=>[n(z,q({label:"訊息類型"},e(U).messageType,{required:""}),{default:a(()=>[n(Le,{value:e(t).messageType,"onUpdate:value":s[8]||(s[8]=d=>e(t).messageType=d),onChange:Be},{default:a(()=>[(p(!0),k(V,null,ye(Object.entries(e(Pt)),([d,Q])=>(p(),B(Ke,{key:d,value:d},{default:a(()=>[u(K(Q),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16)]),_:1}),ne(n(R,{span:24},{default:a(()=>[n(z,q({label:"訊息主旨"},e(U).subject,{required:"",extra:"15 字以內"}),{default:a(()=>[n(ee,{value:e(t).subject,"onUpdate:value":s[9]||(s[9]=d=>e(t).subject=d),placeholder:"請輸入訊息主旨","max-length":15},null,8,["value"])]),_:1},16)]),_:1},512),[[se,e(t).messageType==="MMS"]]),n(R,{span:24},{default:a(()=>{var d;return[n(z,q(e(U).content,{class:"relative",extra:`${e(t).messageType} 上限 ${e(Z).toLocaleString()} 字，目前 ${e(P)(e(t).content)?"--":(d=e(t).content)==null?void 0:d.replace(e(we),"").length} 字`}),{label:a(()=>[$n,Tn,n(L,{placement:"top","get-popup-container":e(ke)},{title:a(()=>[u(" 假設情境："),Sn,u(" Step1. 客戶回覆包含「接收關鍵字」的訊息"),Fn,u(" Step2. 系統自動回覆此欄位內的內容 ")]),default:a(()=>[o("a",Cn,[n(A,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:a(()=>{var Q;return[n(Ge,{modelValue:e(t).content,"onUpdate:modelValue":s[14]||(s[14]=E=>e(t).content=E),contenteditable:"true",style:{height:"292px"},"content-len":(Q=e(t).content)==null?void 0:Q.replace(e(we),"").length,"max-len":e(Z),placeholder:"請輸入文字"},Pe({default:a(()=>[n(L,null,{title:a(()=>[u(" 載入現有的自訂訊息 ")]),default:a(()=>[n(A,{name:"import",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[10]||(s[10]=E=>{var N;return(N=e(oe))==null?void 0:N.show()})})]),_:1}),n(L,null,{title:a(()=>[u(" 增加縮網址 ")]),default:a(()=>[n(A,{name:"link",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[11]||(s[11]=E=>{var N;return(N=e(de))==null?void 0:N.show()})})]),_:1}),n(L,null,{title:a(()=>[u(" 多媒體附件上傳 ")]),default:a(()=>[ne(n(A,{name:"cloud-upload",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[12]||(s[12]=E=>{var N;return(N=e(Se))==null?void 0:N.show(e(t).multimediaFile)})},null,512),[[se,e(t).messageType==="MMS"]])]),_:1}),n(L,null,{title:a(()=>[u(" AI 文字生成訊息 ")]),default:a(()=>[n(A,{name:"AI",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[13]||(s[13]=E=>{var N;return(N=e(me))==null?void 0:N.show()})})]),_:1})]),_:2},[e(t).multimediaFile.length>0?{name:"multimediaBlock",fn:a(()=>[o("div",Mn,[(p(!0),k(V,null,ye(e(t).multimediaFile,E=>(p(),k("div",{key:E.url,class:"w-90px max-h-60px"},[n(Ve,{"video-source":{url:E.url,type:E.type},"show-file-name":!1,"can-play":!1,size:"small","image-class":"object-cover w-full h-full",onDeleteVideo:N=>ze(E)},null,8,["video-source","onDeleteVideo"]),o("div",Dn,K(E.fileName),1)]))),128))])]),key:"0"}:void 0]),1032,["modelValue","content-len","max-len"])]}),_:1},16,["extra"])]}),_:1}),n(R,{span:24,class:"text-end"},{default:a(()=>[n(te,{status:"small2",class:"me-2",onClick:s[15]||(s[15]=d=>l.$router.push("/sms-marketing/custom-message?tabActived=customMessage"))},{default:a(()=>[u(" 取消 ")]),_:1}),n(te,{status:"small1","html-type":"submit"},{default:a(()=>[u(" 確定 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n(R,{flex:"428px",class:"relative"},{default:a(()=>[n(qe,{message:e(Oe)},null,8,["message"])]),_:1})]),_:1}),n(it,{ref_key:"importCustomMessageRef",ref:oe,content:e(t).content,onUpdateContent:ce},null,8,["content"]),n(rt,{ref_key:"addFieldRef",ref:le,onAddFieldToContent:j},null,512),n(ut,{ref_key:"addLinkRef",ref:de,onAddLinkToContent:be},null,512),n(pt,{ref_key:"aiTextGenerationRef",ref:me,content:e(t).content,onUpdateContent:ce},null,8,["content"]),n(mn,{ref_key:"multimediaUploadRef",ref:Se,onUpdateMultimediaFile:Ue},null,512),n(Me,{open:e(ie).open,"onUpdate:open":s[16]||(s[16]=d=>e(ie).open=d),title:"是否刪除已上傳的檔案？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onOk:Ee},{default:a(()=>[jn]),_:1},8,["open"]),n(Me,{open:e(re),"onUpdate:open":s[17]||(s[17]=d=>$e(re)?re.value=d:null),title:"是否放棄目前編輯的內容？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onCancel:s[18]||(s[18]=d=>e(t).messageType="MMS"),onOk:s[19]||(s[19]=()=>{e(t).content="",e(t).multimediaFile=[],e(t).subject="",re.value=!1})},{default:a(()=>[Rn]),_:1},8,["open"])]),_:1},8,["title","custom-breadcrumb"])}}});export{Hn as default};
