import{M as ls,b as wt,_ as Tt,c as gt,a as St}from"./MessageTypeEnum-DNFQ6lOj.js";import{u as Mt,_ as Ct,a as $t,b as Rt,c as Ft,d as jt}from"./route-leave-z6MgRuNA.js";import{_ as xt}from"./index.vuevuetypescriptsetuptruelang-CXg0iFgk.js";import{j as Pt,k as It,_ as st}from"./index-D8HSlZzh.js";import{d as $e,f as g,W as m,_ as G,$ as s,u as e,H as Ce,Y as n,r as Le,c as Me,k as t,ah as Nt,X as C,F as Y,G as l,a3 as h,a4 as ee,ac as is,ad as Dt,z as nt,o as Lt,w as Et,m as ie,ab as Q,B as rs,a9 as xe,A as re,a7 as At,a5 as de,y as _t,ag as bt,l as Ut}from"./vue-BvWPEeCa.js";import{z as Re,E as te,K as Bt,N as yt,O as tt,P as k,Q as Ot,U as at,V as ot,H as Vt,I as zt,o as Gt,p as Yt,q as Ht,y as cs,W as ds,T as us,x as Kt,J as qt,r as Wt,s as Jt,F as Xt,X as kt,B as ps}from"./antd-DfxlYADO.js";import{i as Qt}from"./isToday-DmLvfIEi.js";import{_ as Zt}from"./index.vuevuetypestyleindex0lang-B-PEREiJ.js";import{_ as es,u as ms}from"./request-DwxIs7Uf.js";import{u as fs}from"./contact-person-DpzIAIDc.js";import{u as ts}from"./group-label-DSbp8rro.js";import{u as ss,r as De}from"./custom-message-DbOlgFhm.js";import{b as z}from"./tools-DuR4KSGu.js";const _s=n("div",{class:"text-center px-24px py-20px w-328px text-base mx-auto"}," 刪除的檔案將無法復原 ",-1),ns=$e({name:"DelMultimediaFileModal",__name:"del-multimedia-file-modal",setup(F,{expose:D}){const P=g(!1),V=g();function H(R){V.value=R,P.value=!0}function b(){var R;(R=V.value)==null||R.call(V),P.value=!1}return D({show:H}),(R,$)=>{const p=Re;return m(),G(p,{open:e(P),"onUpdate:open":$[0]||($[0]=N=>Ce(P)?P.value=N:null),title:"是否刪除已上傳的檔案？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onOk:b},{default:s(()=>[_s]),_:1},8,["open"])}}}),gs={class:"px-24px"},xs=$e({__name:"select-contact",props:{formState:{}},emits:["updateFormState"],setup(F,{expose:D,emit:P}){const V=F,H=P,b=Le({selectedRowKeys:[],selectedRows:[],loading:!1}),{contactPerson:R,getAllContactPerson:$,pagination:p}=fs(),N=[{title:"手機門號",dataIndex:"phone",key:"phone",width:"110px"},{title:"姓名",dataIndex:"name",key:"name",width:"110px"},{title:"黑名單",dataIndex:"isBlackList",key:"isBlackList",width:"110px"},{title:"備註",dataIndex:"note",key:"note",width:"110px"}],S=g({keyword:"",sortField:"createTime",sortOrder:"descend"}),A=Me(()=>{const y=(p.value.current-1)*p.value.pageSize;return R.value.slice(y,p.value.current*p.value.pageSize)});async function ue(y,v){p.value={...p.value,current:y,pageSize:v}}async function oe(y=1,v=10){const se={current:y,pageSize:v,...e(S)};await $(se,b.selectedRowKeys)}function pe(y){console.log("selectedRowKeys changed: ",y),b.selectedRowKeys=y}const W=g(!1);async function me(y){b.selectedRowKeys=y,oe(),W.value=!0}function I(){W.value=!1,H("updateFormState",{recipients:{...V.formState.recipients,contactPerson:b.selectedRowKeys}})}return D({show:me}),(y,v)=>{const se=es,U=Zt,E=Re;return m(),G(E,{open:e(W),"onUpdate:open":v[2]||(v[2]=J=>Ce(W)?W.value=J:null),title:"選擇聯絡人",centered:"","cancel-text":"取消","ok-text":"確定",width:"600px",onOk:I},{default:s(()=>[n("div",gs,[t(se,{modelValue:e(S).keyword,"onUpdate:modelValue":v[0]||(v[0]=J=>e(S).keyword=J),"show-filter-btn":!1,placeholder:"搜尋聯絡人",class:"mb-2",onKeydown:v[1]||(v[1]=Nt(J=>oe(1,e(p).pageSize),["enter"]))},null,8,["modelValue"]),t(U,{class:"modal-table","data-source":e(A),columns:N,"show-sorter-tooltip":!1,"row-selection":{selectedRowKeys:e(b).selectedRowKeys,onChange:pe,preserveSelectedRowKeys:!0},pagination:{...e(p)},onChangePagination:ue},{bodyCell:s(({column:J,text:ne})=>[J.dataIndex==="isBlackList"?(m(),C(Y,{key:0},[l(h(ne?"黑名單":""),1)],64)):ee("",!0)]),_:1},8,["data-source","row-selection","pagination"])])]),_:1},8,["open"])}}}),ys={class:"px-24px"},hs=$e({__name:"select-group",props:{formState:{}},emits:["updateFormState"],setup(F,{expose:D,emit:P}){const V=F,H=P,b=Le({selectedRowKeys:[],selectedRows:[],loading:!1}),{groupLabels:R,getAllGroupLabel:$,pagination:p}=ts(),N=[{title:"群組標籤名稱",dataIndex:"name",key:"name",width:"145px"},{title:"門號數量",dataIndex:"phoneCount",key:"phoneCount",width:"145px"},{title:"黑名單數量",dataIndex:"blackListCount",key:"blackListCount",width:"145px"}],S=g({keyword:"",sortField:"createTime",sortOrder:"descend"}),A=Me(()=>{const y=(p.value.current-1)*p.value.pageSize;return R.value.slice(y,p.value.current*p.value.pageSize)});async function ue(y,v){p.value={...p.value,current:y,pageSize:v}}async function oe(y=1,v=10){const se={current:y,pageSize:v,...e(S)};await $(se,b.selectedRowKeys)}function pe(y,v){console.log("selectedRowKeys changed: ",y),b.selectedRowKeys=y,b.selectedRows=v}const W=g(!1);async function me(y){b.selectedRowKeys=y.map(v=>v.id),oe(),W.value=!0}function I(){W.value=!1,H("updateFormState",{recipients:{...V.formState.recipients,group:b.selectedRows.map(y=>({id:y.key,label:y.name}))}})}return D({show:me}),(y,v)=>{const se=es,U=Zt,E=Re;return m(),G(E,{open:e(W),"onUpdate:open":v[2]||(v[2]=J=>Ce(W)?W.value=J:null),title:"選擇群組標籤",centered:"","cancel-text":"取消","ok-text":"確定",width:"600px",onOk:I},{default:s(()=>[n("div",ys,[t(se,{modelValue:e(S).keyword,"onUpdate:modelValue":v[0]||(v[0]=J=>e(S).keyword=J),"show-filter-btn":!1,placeholder:"搜尋群組標籤",class:"mb-2",onKeydown:v[1]||(v[1]=Nt(J=>oe(1,e(p).pageSize),["enter"]))},null,8,["modelValue"]),t(U,{class:"modal-table","data-source":e(A),columns:N,"show-sorter-tooltip":!1,"row-selection":{selectedRowKeys:e(b).selectedRowKeys,onChange:pe,preserveSelectedRowKeys:!0},pagination:{...e(p)},onChangePagination:ue},null,8,["data-source","row-selection","pagination"])])]),_:1},8,["open"])}}});var Ge=(F=>(F.SMS_General="SMS 一般訊息",F.MMS_General="MMS 一般訊息",F.SMS_Parameter="SMS 參數訊息",F.MMS_Parameter="MMS 參數訊息",F))(Ge||{});const vs={key:"1",name:"季末大促銷",messageType:"MMS",subject:"主旨",phone:"0961-238-888",content:"愛戀情人節，獨家驚喜等您發現！ 情人節將至，愛戀之情將再次升華！我們特別為您準備了一場浪漫的情人節限定活動，帶來一系列獨家驚喜等您發現。無論您是想要為您的另一半挑選一份特別的禮物，還是希望一起度過浪漫的夜晚，我們都有豐富的選擇和活動等待著您。讓我們一同創造美好的回憶，共度這個充滿愛意的情人節！",multimediaFile:[{url:"https://cdn.pixabay.com/photo/2019/08/09/13/51/boat-4395122_1280.jpg",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"},{url:"https://cdn.pixabay.com/photo/2018/06/09/21/37/summer-thunder-storm-3465247_1280.jpg",fileName:"invitation_username.jpg",size:86400,key:"2",fileSize:"",file:void 0,type:"image"},{url:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",fileName:"BigBuckBunny.mp4",size:86400,key:"2",fileSize:"",file:void 0,type:"video"}],recipients:{contactPerson:["1","2"],group:[{id:"1",label:"群組A"}],manual:"0912345678,0912345678",file:void 0},sendTimeType:"RESERVATION",reservationTime:"2024/02/14 17:30",effectiveTime:""},bs={name:"季末大促銷季末大促銷季末大促銷季末大促銷季末大促銷季末大促銷",messageType:"MMS",phone:"0961-238-888",content:"愛戀情人節，獨家驚喜等您發現！ 情人節將至，愛戀之情將再次升華！我們特別為您準備了一場浪漫的情人節限定活動，帶來一系列獨家驚喜等您發現。無論您是想要為您的另一半挑選一份特別的禮物，還是希望一起度過浪漫的夜晚，我們都有豐富的選擇和活動等待著您。讓我們一同創造美好的回憶，共度這個充滿愛意的情人節！",multimediaFile:[{url:"https://cdn.pixabay.com/photo/2019/08/09/13/51/boat-4395122_1280.jpg",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"}],file:{fileName:"test.xlsx",url:""},isCommonContent:!0,multimediaFileWithSubject:[],recipients:[{number:"1",phone:"0938118293",field1:"小馬",field2:"9412918",field3:"-",field4:"-",field5:"-"},{number:"2",phone:"0946184761",field1:"安潔",field2:"5439577",field3:"-",field4:"-",field5:"-"},{number:"3",phone:"0966092938",field1:"Lucy",field2:"5634840",field3:"-",field4:"-",field5:"-"},{number:"4",phone:"0956482371",field1:"Sam",field2:"3437402",field3:"-",field4:"-",field5:"-"},{number:"5",phone:"0978049940",field1:"Tim",field2:"8480277",field3:"-",field4:"-",field5:"-"}],subject:"測試",sendTimeType:"NOW",effectiveTime:"",reservationTime:""},ft=[{key:"1",name:"季末大促銷",account:"taiwan_media_00",sendNumber:"AJ593749G2",sendStatus:"RESERVATION",messageType:"MMS",phone:"0961-238-888",content:"愛戀情人節，獨家驚喜等您發現！ 情人節將至，愛戀之情將再次升華！我們特別為您準備了一場浪漫的情人節限定活動，帶來一系列獨家驚喜等您發現。無論您是想要為您的另一半挑選一份特別的禮物，還是希望一起度過浪漫的夜晚，我們都有豐富的選擇和活動等待著您。讓我們一同創造美好的回憶，共度這個充滿愛意的情人節！",multimediaFile:[{url:"https://cdn.pixabay.com/photo/2019/08/09/13/51/boat-4395122_1280.jpg",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"},{url:"https://cdn.pixabay.com/photo/2018/06/09/21/37/summer-thunder-storm-3465247_1280.jpg",fileName:"invitation_username.jpg",size:86400,key:"2",fileSize:"",file:void 0,type:"image"},{url:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",fileName:"BigBuckBunny.mp4",size:86400,key:"2",fileSize:"",file:void 0,type:"video"}],isParameter:!1,statistics:{total:0,sending:0,success:0,fail:0,successRate:0},sendTime:"2024/10/28 17:30",createTime:"2024/10/28 17:30",updateTime:"2024/10/28 17:30"},{key:"2",name:"9月壽星活動",account:"taiwan_media_00",sendNumber:"AJ593749G2",sendStatus:"EXECUTING",messageType:"SMS",phone:"0961-238-888",content:"慶祝9月壽星 %field1%，特別優惠等你來享！ 九月生日的朋友們，這個月是您獨特的時刻！為了慶祝您的生日，我們特別準備了一系列令人驚喜的優惠和禮物。無論您是想要一項特別的折扣、額外的積分還是免費的驚喜禮物，我們都會在您的生日月份為您提供。請加入我們，一起慶祝這個特別的時刻，讓我們為您的生日帶來更多的歡樂和驚喜！",multimediaFile:[{url:"https://cdn.pixabay.com/photo/2019/08/09/13/51/boat-4395122_1280.jpg",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"}],isParameter:!1,statistics:{total:0,sending:0,success:0,fail:0,successRate:0},sendTime:te().format("YYYY/MM/DD HH:mm"),createTime:"2024/10/28 17:30",updateTime:"2024/10/28 17:30"},{key:"3",name:"季末大促銷季末大促銷季末大促銷季末大促銷季末大促銷季末大促銷",account:"taiwan_media_00",sendNumber:"AJ593749G2",sendStatus:"RESERVATION",messageType:"MMS",phone:"0961-238-888",content:"愛戀情人節，獨家驚喜等您發現！ 情人節將至，愛戀之情將再次升華！我們特別為您準備了一場浪漫的情人節限定活動，帶來一系列獨家驚喜等您發現。無論您是想要為您的另一半挑選一份特別的禮物，還是希望一起度過浪漫的夜晚，我們都有豐富的選擇和活動等待著您。讓我們一同創造美好的回憶，共度這個充滿愛意的情人節！",multimediaFile:[{url:"https://cdn.pixabay.com/photo/2019/08/09/13/51/boat-4395122_1280.jpg",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"}],isParameter:!0,statistics:{total:0,sending:0,success:0,fail:0,successRate:0},sendTime:"2024/02/14 17:30",createTime:"2024/10/28 17:30",updateTime:"2024/10/28 17:30"},{key:"4",name:"週年慶",account:"taiwan_media_00",sendNumber:"AJ593749G2",sendStatus:"IS_SENT",messageType:"MMS",phone:"0961-238-888",content:`準備好享受驚人的優惠和特別禮遇，因為我們正在慶祝週年紀念！ 不要錯過這場盛會 - 來店內或線上參加，盡情享受您最喜愛的產品的驚人折扣！這些週年慶特惠不會持續太久！立即購物，讓這個慶典變得難忘！
提供您專屬折扣碼：%field1%
有限期限至：%field2%`,multimediaFile:[{url:"https://cdn.pixabay.com/photo/2019/08/09/13/51/boat-4395122_1280.jpg",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"}],isParameter:!0,statistics:{total:0,sending:0,success:0,fail:0,successRate:0},sendTime:"2024/02/01 17:30",createTime:"2024/10/28 17:30",updateTime:"2024/10/28 17:30"},{key:"5",name:"聖誕佳節",account:"taiwan_media_00",sendNumber:"AJ593749G2",sendStatus:"RESERVATION_FAILED",messageType:"SMS",phone:"0961-238-888",content:"聖誕節大促銷來啦！快來店裡或線上參加我們的節慶活動，享受驚喜禮遇！找尋最適合送給親朋好友的禮物，一起度過溫馨愉快的節日時光！敬請期待我們的特別優惠，讓您的聖誕更加美好！",multimediaFile:[{url:"https://cdn.pixabay.com/photo/2019/08/09/13/51/boat-4395122_1280.jpg",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"}],isParameter:!0,statistics:{total:0,sending:0,success:0,fail:0,successRate:0},sendTime:"2023/12/20 17:30",createTime:"2024/10/28 17:30",updateTime:"2024/10/28 17:30"}];function as(){const{list:F,pagination:D,setResponseList:P}=ms(),V=async I=>{P({total:11,pages:1,current:1,pageSize:10,records:ft})},H=g(),b=async I=>{const y=ft.find(v=>v.key===I);return H.value=y,{data:{...y}}},R=async I=>({data:{status:"success",id:"1"}}),$=async(I,y)=>({data:{status:"success",id:"1"}}),p=I=>({data:{fileName:I.name,url:window.URL.createObjectURL(I)}}),N=async I=>(console.log(I),{data:{...vs}}),S=async I=>({data:{status:"success",id:"1"}}),A=async(I,y)=>({data:{status:"success",id:"1"}}),ue=async I=>(console.log(I),{data:{...bs}}),oe=g([{label:"不設定(預設)",value:""},{label:"1 小時",value:"1 小時"},{label:"2 小時",value:"2 小時"},{label:"3 小時",value:"3 小時"},{label:"4 小時",value:"4 小時"},{label:"5 小時",value:"5 小時"},{label:"6 小時",value:"6 小時"},{label:"7 小時",value:"7 小時"},{label:"8 小時",value:"8 小時"}]);return{getMessageSendings:V,messageSendings:F,pagination:D,createGeneralMessageSending:R,updateGeneralMessageSending:$,messageSending:H,getMessageSending:b,getGeneralMessageSendingById:N,uploadBatchRecipientsExcel:p,effectiveTimeOption:oe,getActiveStatusLabel:(I,y)=>I==="MMS"?y?Ge.MMS_Parameter:Ge.MMS_General:y?Ge.SMS_Parameter:Ge.SMS_General,checkMessageSendingDetail:async(I,y=!1)=>({data:{...I,isParameter:y,price:5,recipientsCount:6208,isBlackListCount:12,estimatedTotalAmount:31400,estimatedRemainingAmount:-3580,totalLongMessages:3,estimatedTotalMessages:3}}),checkMessageSendingNameExist:async(I,y)=>{const v=Bt(ft,{name:I});return v?!(!yt(y)&&v.key===y):!1},createParameterMessageSending:S,updateParameterMessageSending:A,getParameterMessageSendingById:ue}}var ht=(F=>(F.NOW="現在",F.RESERVATION="預約",F))(ht||{});const ks=n("span",{class:"pe-.5"},"活動名稱",-1),ws=n("span",{class:"text-red-500 pe-2"},"*",-1),Ts={href:"javascript:;"},Ss=n("span",{class:"pe-.5"},"接收門號",-1),Ms=n("span",{class:"text-red-500 pe-2"},"*",-1),Cs={href:"javascript:;"},$s=n("br",null,null,-1),Rs=n("br",null,null,-1),Fs=n("br",null,null,-1),js=n("br",null,null,-1),Ps=n("br",null,null,-1),Is={class:"text-sm text-sms-secondary-dark-blue-100 font-400"},Ns=n("div",{class:"ant-form-item-extra"}," 若有多筆門號，使用 “ , ” 隔開，例如：0911111222,0922123456,0933987654 ",-1),Ds={href:"javascript:;",class:"underline underline-offset-2 text-sms-primary-blue-80 text-sm line-height-14px py-1"},Ls={href:"javascript:;",class:"underline underline-offset-2 text-sms-primary-blue-80 text-sm line-height-14px py-1"},Es=n("span",{class:"pe-.5"},"訊息類型",-1),As=n("span",{class:"text-red-500 pe-2"},"*",-1),Us={href:"javascript:;"},Bs=n("br",null,null,-1),Os={class:"flex gap-2 overflow-y-auto h-95px"},Vs={class:"text-sms-grayscale-60 text-xs font-500 font-sans text-center break-words"},zs=n("span",{class:"pe-.5"},"發送時間",-1),Gs=n("span",{class:"text-red-500 pe-2"},"*",-1),Ys={href:"javascript:;"},Hs=n("span",{class:"pe-.5"},"有效時間",-1),Ks=n("span",{class:"text-red-500 pe-2"},"*",-1),qs={href:"javascript:;"},Ws={key:0,id:"confirmDetail",class:"px-32px"},Js=n("div",{class:"mb-4"},[n("h2",{class:"font-500 text-22px text-sms-secondary-dark-blue-100"}," 內容確認 "),n("p",{class:"text-sm text-sms-grayscale-80"}," 若有使用縮網址功能，請在發送訊息前再次確認短網址有效性，平台不會檢驗短網址有效性 ")],-1),Xs={class:"border border-solid border-sms-light-gray-60 p-16px pb-24px rounded-12px mb-2"},Qs=n("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 活動名稱 ",-1),Zs={class:"text-base font-400 text-sms-grayscale-100"},en=n("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 發送時間 ",-1),tn={key:0,class:"text-base font-400 text-sms-grayscale-100"},sn=n("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 訊息類型 ",-1),nn={class:"text-base font-400 text-sms-grayscale-100"},an=n("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 發送門號 ",-1),on={class:"text-base font-400 text-sms-grayscale-100"},ln=n("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 訊息總數 (長訊息) ",-1),rn={class:"text-base font-400 text-sms-grayscale-100"},cn=n("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 單價 ",-1),dn={class:"text-base font-400 text-sms-grayscale-100"},un={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},pn={href:"javascript:;"},mn={class:"text-base font-400 text-sms-grayscale-100"},fn=n("span",{class:"text-sms-grayscale-60 text-sm"}," (非最終數量)",-1),_n={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},gn={href:"javascript:;"},xn={class:"text-base font-400 text-sms-grayscale-100"},yn=n("span",{class:"text-sms-grayscale-60 text-sm"}," (非最終數量)",-1),hn={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},vn={href:"javascript:;"},bn=n("br",null,null,-1),kn={class:"text-base font-400 text-sms-grayscale-100"},wn={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},Tn={href:"javascript:;"},Sn=n("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"},[l(" 您編輯過的內容將全部清空 "),n("br"),n("p",null,[l(" 提醒您，SMS支援的字數較MMS少，"),n("br"),l(" 且不能上傳多媒體附件 ")])],-1),Mn={class:"text-center px-30px py-20px w-328px text-base mx-auto"},Cn={class:"text-base text-center text-sms-gary-80"},$n=["href"],So=$e({__name:"create-or-update-form",props:{isCreate:{type:Boolean,default:!1},id:{},editCallback:{},showPreview:{type:Boolean,default:!0}},setup(F){const D=F;te.extend(Qt);const{setHideAlert:P,setShowAlert:V}=Mt(),H=Pt(),b=is(),R=Dt(),$=nt(D,"isCreate"),p=nt(D,"id"),{replaceFieldToHtml:N}=ss(),S=g(),{updateGeneralMessageSending:A,getGeneralMessageSendingById:ue,createGeneralMessageSending:oe,uploadBatchRecipientsExcel:pe,effectiveTimeOption:W,getActiveStatusLabel:me,checkMessageSendingDetail:I,checkMessageSendingNameExist:y}=as(),{getGroupLabelOption:v,groupOptions:se}=ts(),U=g("");let E={name:"",phone:void 0,recipients:{contactPerson:[],group:[],manual:"",file:void 0},messageType:"SMS",subject:"",multimediaFile:[],sendTimeType:"NOW",content:"",effectiveTime:"",reservationTime:""};const J=[{label:"0935-111-111",value:"0935-111-111"},{label:"0947-127-998",value:"0947-127-998"},{label:"0958-892-006",value:"0958-892-006"}],ne=g("ContactPerson"),r=g(!1),c=Le(tt(E)),Fe=Me(()=>c.messageType==="SMS"?335:1e3),le=Le({name:[{async validator(o,a){return k(a)?Promise.reject("請輸入活動名稱"):await y(a,p.value)?Promise.reject("此活動名稱已存在，請重新命名 "):Promise.resolve()},trigger:"blur"}],phone:[{required:!0,message:"請選擇發送門號",trigger:"blur"}],subject:[{async validator(o,a){return c.messageType==="MMS"&&k(a)?Promise.reject("請輸入訊息主旨"):Promise.resolve()},trigger:"blur"}],recipients:[{async validator(o){if(k(c.recipients.contactPerson)&&k(c.recipients.group)&&k(c.recipients.manual)&&yt(c.recipients.file))return Promise.reject("至少 1 個接收門號");if(k(c.recipients.manual)){const a=c.recipients.manual.split(",").length,_=c.recipients.contactPerson.length,x=c.recipients.group.length;if(a+_+x>5e4)return Promise.reject("總接收門號數不可超過 5萬筆")}else if(!/^09[0-9]{8}(,09[0-9]{8})*$/.test(c.recipients.manual))return ne.value="ManualInput",Promise.reject("格式錯誤");return Promise.resolve()},trigger:"blur"}],content:[{async validator(o,a){var _;return k(a)?Promise.reject("請輸入訊息內容"):!k(a)&&((_=c.content)==null?void 0:_.replace(De,"").length)>Fe.value?Promise.reject(`限制輸入 ${Fe.value} 字以內`):Promise.resolve()},trigger:"blur"}],reservationTime:[{async validator(o,a){if(c.sendTimeType==="RESERVATION"){if(k(a))return Promise.reject("請選擇預約日期或現在發送");if(te().diff(te(a),"minute")>0)return Promise.reject("閒置過久，請重新選擇預約時間")}return Promise.resolve()},trigger:"blur"}]}),{validateInfos:ce,validate:lt,resetFields:j}=Ot(c,le);Lt(async()=>{var o,a,_,x,w,O,M,Z,K,X,be,ke,we,Te,Ie,_e,Ne,ge,Se,f;if(await v(),U.value=te().format("YYYY/MM/DD_HH:mm"),!$.value&&p.value){const L=await ue(p.value);L.data&&(S.value=L.data,E={name:((o=S.value)==null?void 0:o.name)??e(U),phone:((a=S.value)==null?void 0:a.phone)??void 0,recipients:{contactPerson:((x=(_=S.value)==null?void 0:_.recipients)==null?void 0:x.contactPerson)??[],group:((O=(w=S.value)==null?void 0:w.recipients)==null?void 0:O.group)??[],manual:((Z=(M=S.value)==null?void 0:M.recipients)==null?void 0:Z.manual)??"",file:((X=(K=S.value)==null?void 0:K.recipients)==null?void 0:X.file)??void 0},messageType:((be=S.value)==null?void 0:be.messageType)??"SMS",subject:((ke=S.value)==null?void 0:ke.subject)??"",multimediaFile:((we=S.value)==null?void 0:we.multimediaFile)??[],sendTimeType:((Te=S.value)==null?void 0:Te.sendTimeType)??"NOW",content:((Ie=S.value)==null?void 0:Ie.content)??"",effectiveTime:((_e=S.value)==null?void 0:_e.effectiveTime)??"",reservationTime:((Ne=S.value)==null?void 0:Ne.reservationTime)??""})}else{if((ge=b.query)!=null&&ge.isRe){U.value=`RE_${U.value}`;const L=(Se=b.query)!=null&&Se.rePhone?b.query.rePhone:void 0,d=(f=b.query)!=null&&f.recipientsPhone?b.query.recipientsPhone:void 0;L&&(E.phone=L),d&&(Bt(J,{value:d})?E.recipients.contactPerson=[d]:(ne.value="ManualInput",E.recipients.manual=d))}E.name=e(U)}j(E)}),Et(()=>c,o=>{const a=at(o,E);$.value&&!p.value&&(a?P():V())},{deep:!0});const B=g(null);function it(){lt().then(async()=>{const o=await I(c);if(o.data){B.value=o.data,r.value=!0,await _t();const a=document.getElementById("app");a&&(a.scrollTop=0)}}).catch(o=>{console.log(o)})}async function Ye(){var _,x,w,O;const a=await(e($)?oe:A)(c,p.value);if(((_=a.data)==null?void 0:_.status)==="success")if($.value&&!p.value)if(P(),(x=b.query)!=null&&x.isRe&&((w=b.query)!=null&&w.rePhone)&&((O=b.query)!=null&&O.recipientsPhone)){const{post:M,close:Z}=bt({name:"in-chat-message-page"});M(a.data.id),Z(),window.close()}else H.success({message:"訊息新增成功",placement:"top"}),R.push("/sms-marketing/message-sending").then(()=>{setTimeout(()=>{var K;const{post:M,close:Z}=bt({name:"in-message-sending-page"});M((K=a.data)==null?void 0:K.id),Z()},800)});else D.editCallback&&D.editCallback(!0,p.value),H.success({message:"訊息編輯成功",placement:"top"})}const Ee=g(null);function Ae(o){c.content=N(o)}const rt=g(null);function He(o){for(const a of o)c.content=`${c.content}<span>${a}</span>`}const Ke=g(null);function qe(o){c.content=`${c.content}<a href="${o}">${o}</a>`}const We=g(null),Ue=Me(()=>{const o=[];if((!k(c.content)||!k(c.subject))&&o.push({phone:c.phone,content:c.content,...c.messageType==="MMS"&&{subject:c.subject},messageType:"SENT",contentType:"text"}),!k(c.multimediaFile))for(const a of c.multimediaFile)o.push({phone:c.phone,content:a.url,messageType:"SENT",contentType:a.type});return o.map((a,_)=>({...a,key:_}))}),Be=g(null);function Je(o){c.multimediaFile=o}const Xe=g(null);function Oe(o){c.multimediaFile=c.multimediaFile.filter(a=>a.url!==o.url)}const ye=g(!1);function ct(){c.messageType==="SMS"?!k(c.content)||!k(c.multimediaFile)?ye.value=!0:c.messageType="SMS":c.messageType="MMS"}const Ve=g(null),Qe=g(null);function Ze(o){Object.assign(c,o)}const he=g({open:!1,url:""}),je=g();async function fe(o){const _=o.target.files;try{if(_.length>0){const x=await pe(_[0]);c.recipients.file=x.data,he.value={open:!0,url:""}}}catch(x){console.log(x)}finally{je.value&&(je.value.value="")}}const dt=It();function et(){dt.confirm({title:"是否取消上傳檔案？",icon:t("span"),content:Ut("div",{innerHTML:"該檔案將取消上傳",class:"text-center px-30px py-20px w-328px text-base mx-auto"}),width:"400px",centered:!0,closable:!0,async onOk(){c.recipients.file=void 0}})}const ve=te();function Pe(o){const a=ve.add(1,"year");return o&&(o<ve||o>=a)}function ut(o){if(o&&o.isToday()){const a=te().add(5,"minute"),_=a.hour(),x=a.minute();return{disabledHours:()=>ot(0,24).slice(0,_),disabledMinutes:()=>ot(0,60).slice(0,x)}}return{}}function pt(){const o=at(c,E);D.editCallback&&D.editCallback(o)}function mt(){$.value&&!p.value?R.push("/sms-marketing/message-sending"):pt()}const ze=g("responsive");function u(o){c.recipients.group=c.recipients.group.filter(a=>a.id!==o)}async function i(o){const x=o.target.value.replace(/[^\d|,]/g,"");await _t(),c.recipients.manual=x}return(o,a)=>{const _=st,x=Vt,w=zt,O=Gt,M=Yt,Z=Ht,K=xt,X=cs,be=ds,ke=us,we=Kt,Te=qt,Ie=Tt,_e=jt,Ne=Wt,ge=Jt,Se=Xt,f=gt,L=Re;return m(),C(Y,null,[t(ge,{class:de(["bg-sms-grayscale-0 rounded-4",{"p-10 pl-1":e($)&&!e(p)}]),wrap:!1},{default:s(()=>[t(M,{flex:"auto"},{default:s(()=>[ie(t(Se,{class:"px-32px",layout:"vertical",autocomplete:"off",onSubmit:it},{default:s(()=>[t(ge,{gutter:[16,14]},{default:s(()=>[t(M,{span:24},{default:s(()=>[t(O,Q(e(ce).name,{"html-for":""}),{label:s(()=>[ks,ws,t(x,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 活動名稱可使用系統預設或自行輸入，但不可重複 ")]),default:s(()=>[n("a",Ts,[t(_,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:s(()=>[t(w,{value:e(c).name,"onUpdate:value":a[0]||(a[0]=d=>e(c).name=d),placeholder:"請輸入文字",maxlength:30,onFocus:a[1]||(a[1]=()=>{e(c).name===e(U)&&(e(c).name="")}),onBlur:a[2]||(a[2]=()=>{e(c).name===""&&(e(c).name=e(U))})},null,8,["value"])]),_:1},16)]),_:1}),t(M,{span:24},{default:s(()=>[t(O,Q(e(ce).phone,{label:"發送門號",required:""}),{default:s(()=>[t(Z,{value:e(c).phone,"onUpdate:value":a[3]||(a[3]=d=>e(c).phone=d),options:J,"allow-clear":"",placeholder:"請選擇發送門號"},null,8,["value"])]),_:1},16)]),_:1}),t(M,{span:24},{default:s(()=>[t(O,Q({"html-for":""},e(ce).recipients),{label:s(()=>[Ss,Ms,t(x,{"overlay-inner-style":{width:"315px"},placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 4 種方式增加接收門號 ，且可混合使用(總上限5萬筆)："),$s,l(" 1. 從名單管理匯入聯絡人"),Rs,l(" 2. 從名單管理匯入群組標籤"),Fs,l(" 3. 直接輸入接收門號"),js,l(" 4. Excel 快速上傳門號"),Ps]),default:s(()=>[n("a",Cs,[t(_,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:s(()=>[t(ke,{activeKey:e(ne),"onUpdate:activeKey":a[10]||(a[10]=d=>Ce(ne)?ne.value=d:null),size:"small",class:"full-border-tab",type:"card","destroy-inactive-tab-pane":!0},{default:s(()=>[t(X,{key:"ContactPerson",tab:"聯絡人"},{default:s(()=>[t(K,{status:"small2",class:"me-2",onClick:a[4]||(a[4]=d=>{var T,q;return(q=e(Ve))==null?void 0:q.show(((T=e(c).recipients)==null?void 0:T.contactPerson)??[])})},{icon:s(()=>[t(_,{name:"plus",width:"16px"})]),default:s(()=>[l(" 選擇聯絡人 ")]),_:1}),n("span",Is,"已選擇 "+h(e(c).recipients.contactPerson.length.toLocaleString())+" 筆",1)]),_:1},8,["tab"]),t(X,{key:"GroupLabel",tab:"群組標籤"},{default:s(()=>[e(c).recipients.group.length>0?(m(),G(Z,{key:0,class:"mb-2",open:!1,options:e(se),value:e(c).recipients.group.map(d=>d.id),mode:"tags","max-tag-count":e(ze),onDeselect:u,onBlur:a[6]||(a[6]=d=>ze.value="responsive")},{maxTagPlaceholder:s(d=>[n("span",{href:"javascript:;",onClick:a[5]||(a[5]=rs(T=>ze.value=void 0,["prevent"]))},[t(_,{name:"plus",width:"12px"}),l(h(d.length)+"...",1)])]),_:1},8,["options","value","max-tag-count"])):ee("",!0),t(K,{status:"small2",class:"me-2",onClick:a[7]||(a[7]=d=>{var T;return(T=e(Qe))==null?void 0:T.show(e(c).recipients.group??[])})},{icon:s(()=>[t(_,{name:"plus",width:"16px"})]),default:s(()=>[l(" 選擇群組標籤 ")]),_:1})]),_:1},8,["tab"]),t(X,{key:"ManualInput",tab:"手動輸入"},{default:s(()=>[t(be,{value:e(c).recipients.manual,"onUpdate:value":a[8]||(a[8]=d=>e(c).recipients.manual=d),placeholder:"請輸入接收門號",rows:6,onInput:i},null,8,["value"]),Ns]),_:1},8,["tab"]),t(X,{key:"FileUpload",tab:"上傳檔案"},{default:s(()=>[e(c).recipients.file?(m(),C(Y,{key:1},[n("a",Ls,h(e(c).recipients.file.fileName),1),t(_,{name:"download-circle",width:"16px",class:"mx-2 cursor-pointer"}),t(_,{name:"delete-circle",width:"16px",class:"cursor-pointer",onClick:et})],64)):(m(),C(Y,{key:0},[n("input",{ref_key:"uploadBatchRecipientsFile",ref:je,type:"file",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",class:"!hidden",onChange:fe},null,544),t(K,{status:"small2",class:"me-2",onClick:a[9]||(a[9]=d=>{var T;return(T=e(je))==null?void 0:T.click()})},{icon:s(()=>[t(_,{name:"plus",width:"16px"})]),default:s(()=>[l(" 上傳EXCEL ")]),_:1}),n("a",Ds,[t(_,{name:"download",width:"16px"}),l(" 匯出範例 ")])],64))]),_:1},8,["tab"])]),_:1},8,["activeKey"])]),_:1},16)]),_:1}),t(M,{span:24},{default:s(()=>[t(O,Q({"html-for":""},e(ce).messageType),{label:s(()=>[Es,As,t(x,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" SMS：上限 335 字"),Bs,l(" MMS：上限 1,000 字，可上傳多媒體 ")]),default:s(()=>[n("a",Us,[t(_,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:s(()=>[t(Te,{value:e(c).messageType,"onUpdate:value":a[11]||(a[11]=d=>e(c).messageType=d),onChange:ct},{default:s(()=>[(m(!0),C(Y,null,xe(Object.entries(e(ls)),([d,T])=>(m(),G(we,{key:d,value:d},{default:s(()=>[l(h(T),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16)]),_:1}),ie(t(M,{span:24},{default:s(()=>[t(O,Q({label:"訊息主旨"},e(ce).subject,{required:"",extra:"15 字以內"}),{default:s(()=>[t(w,{value:e(c).subject,"onUpdate:value":a[12]||(a[12]=d=>e(c).subject=d),placeholder:"請輸入訊息主旨",maxlength:15},null,8,["value"])]),_:1},16)]),_:1},512),[[re,e(c).messageType==="MMS"]]),t(M,{span:24},{default:s(()=>{var d;return[t(O,Q({"html-for":"",label:"訊息內容"},e(ce).content,{class:"relative",extra:`${e(c).messageType} 上限 ${e(Fe).toLocaleString()} 字，目前 ${e(k)(e(c).content)?"--":(d=e(c).content)==null?void 0:d.replace(e(De),"").length} 字`}),{default:s(()=>{var T;return[t(_e,{modelValue:e(c).content,"onUpdate:modelValue":a[17]||(a[17]=q=>e(c).content=q),contenteditable:"true",style:{height:"292px"},"content-len":(T=e(c).content)==null?void 0:T.replace(e(De),"").length,"max-len":e(Fe),placeholder:"請輸入文字"},At({default:s(()=>[t(x,null,{title:s(()=>[l(" 載入現有的自訂訊息 ")]),default:s(()=>[t(_,{name:"import",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:a[13]||(a[13]=q=>{var ae;return(ae=e(Ee))==null?void 0:ae.show()})})]),_:1}),t(x,null,{title:s(()=>[l(" 增加縮網址 ")]),default:s(()=>[t(_,{name:"link",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:a[14]||(a[14]=q=>{var ae;return(ae=e(Ke))==null?void 0:ae.show()})})]),_:1}),t(x,null,{title:s(()=>[l(" 多媒體附件上傳 ")]),default:s(()=>[ie(t(_,{name:"cloud-upload",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:a[15]||(a[15]=q=>{var ae;return(ae=e(Be))==null?void 0:ae.show(e(c).multimediaFile)})},null,512),[[re,e(c).messageType==="MMS"]])]),_:1}),t(x,null,{title:s(()=>[l(" AI 文字生成訊息 ")]),default:s(()=>[t(_,{name:"AI",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:a[16]||(a[16]=q=>{var ae;return(ae=e(We))==null?void 0:ae.show()})})]),_:1})]),_:2},[e(c).multimediaFile.length>0?{name:"multimediaBlock",fn:s(()=>[n("div",Os,[(m(!0),C(Y,null,xe(e(c).multimediaFile,q=>(m(),C("div",{key:q.url,class:"w-90px max-h-60px"},[t(Ie,{source:{url:q.url,type:q.type},"show-file-name":!1,"can-play":!1,size:"small","image-class":"object-cover w-full h-full",onDeleteVideo:ae=>{var vt;return(vt=e(Xe))==null?void 0:vt.show(()=>Oe(q))}},null,8,["source","onDeleteVideo"]),n("div",Vs,h(q.fileName),1)]))),128))])]),key:"0"}:void 0]),1032,["modelValue","content-len","max-len"])]}),_:1},16,["extra"])]}),_:1}),t(M,{span:24,class:"bg-sms-bg-light-mode-gray rounded-md !p-20px"},{default:s(()=>[t(O,Q(e(ce).reservationTime,{"html-for":"",class:"mb-4"}),{label:s(()=>[zs,Gs,t(x,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 最快可預約5分鐘之後以及系統當下 1 年內時間，惟實際發送時間以系統排程為主 ")]),default:s(()=>[n("a",Ys,[t(_,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:s(()=>[t(Te,{value:e(c).sendTimeType,"onUpdate:value":a[18]||(a[18]=d=>e(c).sendTimeType=d)},{default:s(()=>[(m(!0),C(Y,null,xe(Object.entries(e(ht)),([d,T])=>(m(),G(we,{key:d,value:d},{default:s(()=>[l(h(T),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),ie(t(Ne,{value:e(c).reservationTime,"onUpdate:value":a[19]||(a[19]=d=>e(c).reservationTime=d),format:"YYYY/MM/DD HH:mm","value-format":"YYYY/MM/DD HH:mm","disabled-date":Pe,"disabled-time":ut,"show-time":!0,"show-now":!1},null,8,["value"]),[[re,e(c).sendTimeType==="RESERVATION"]])]),_:1},16),t(O,Q(e(ce).sendTimeType,{"html-for":""}),{label:s(()=>[Hs,Ks,t(x,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 因接收門號而無法成功送達訊息，會在此設定有效時間內重複嘗試發送 ")]),default:s(()=>[n("a",qs,[t(_,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:s(()=>[t(Z,{value:e(c).effectiveTime,"onUpdate:value":a[20]||(a[20]=d=>e(c).effectiveTime=d),options:e(W),"list-height":300,placeholder:"請選擇有效時間"},null,8,["value","options"])]),_:1},16)]),_:1}),t(M,{span:24,class:de({"text-end":e($)&&!e(p),"text-center py-6 ":!e($)&&e(p)})},{default:s(()=>[t(K,{status:"small2",class:"me-2",onClick:mt},{default:s(()=>[l(" 取消 ")]),_:1}),t(K,{status:"small1","html-type":"submit"},{default:s(()=>[l(" 確定 ")]),_:1})]),_:1},8,["class"])]),_:1})]),_:1},512),[[re,!e(r)]]),e(r)&&e(B)?(m(),C("div",Ws,[Js,n("div",Xs,[t(ge,{gutter:[16,16]},{default:s(()=>[t(M,{span:24,class:"mb-"},{default:s(()=>[Qs,n("div",Zs,h(e(B).name),1)]),_:1}),t(M,{span:8},{default:s(()=>[en,e(B).sendTimeType==="RESERVATION"?(m(),C("div",tn,h(e(B).reservationTime),1)):(m(),C("div",{key:1,class:de(["text-base font-400 text-sms-grayscale-100",{"text-sms-status-alert-red":Math.sign(e(B).estimatedRemainingAmount)===-1}])}," 現在 ",2))]),_:1}),t(M,{span:8},{default:s(()=>[sn,n("div",nn,h(e(me)(e(B).messageType,e(B).isParameter)),1)]),_:1}),t(M,{span:8},{default:s(()=>[an,n("div",on,h(e(B).phone),1)]),_:1}),e(B).messageType==="SMS"?(m(),G(M,{key:0,span:8},{default:s(()=>[ln,n("div",rn,h(e(B).totalLongMessages),1)]),_:1})):ee("",!0),t(M,{span:8},{default:s(()=>[cn,n("div",dn," NT$ "+h(e(B).price),1)]),_:1}),t(M,{span:8},{default:s(()=>[n("div",un,[l(" 接收門號總數 "),t(x,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 未過濾所有黑名單，發送時會再檢核，最終接收門號數量可能變動 ")]),default:s(()=>[n("a",pn,[t(_,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),n("div",mn,[l(h(e(B).recipientsCount.toLocaleString())+" ",1),fn])]),_:1}),t(M,{span:8},{default:s(()=>[n("div",_n,[l(" 黑名單門號總數 "),t(x,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 目前已篩選掉該黑名單數量，發送時會再檢核最新黑名單，最終黑名單門號總數可能變動 ")]),default:s(()=>[n("a",gn,[t(_,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),n("div",xn,[l(h(e(B).isBlackListCount.toLocaleString())+" ",1),yn])]),_:1}),t(M,{span:8},{default:s(()=>[n("div",hn,[l(" 預估發送總金額 "),t(x,{placement:"top","get-popup-container":e(z),"overlay-inner-style":{width:"397px"}},{title:s(()=>[l(" 發送總金額 = 訊息總數 x ( 接收門號總數 - 黑名單門號總數 ) x 單價"),bn,l(" 參數訊息之訊息總數以一則計算，實際計價以發送字數等於幾則來計價 ")]),default:s(()=>[n("a",vn,[t(_,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),n("div",kn," NT$ "+h(e(B).estimatedTotalAmount.toLocaleString()),1)]),_:1}),t(M,{span:8},{default:s(()=>[n("div",wn,[l(" 預估剩餘金額 "),t(x,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 餘額不足仍可預約，請注意於預約時間前進行儲值才可成功發送訊息 ")]),default:s(()=>[n("a",Tn,[t(_,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),n("div",{class:de(["text-base font-400 text-sms-grayscale-100",{"text-sms-status-alert-red":Math.sign(e(B).estimatedRemainingAmount)===-1}])}," NT$ "+h(e(B).estimatedRemainingAmount.toLocaleString()),3)]),_:1})]),_:1})]),n("div",{class:de(["flex items-center justify-end",{"py-4":!e($)&&e(p)}])},[ie(n("div",{class:"text-sms-status-alert-red text-base me-4"},h(e(B).sendTimeType==="RESERVATION"?"可預約，請於發送時間之前儲值完畢，以免發送失敗":"剩餘金額不足，建議回上一步改成預約發送後再盡快儲值"),513),[[re,Math.sign(e(B).estimatedRemainingAmount)===-1]]),t(K,{status:"small2",class:"me-2",onClick:a[21]||(a[21]=()=>{r.value=!1,B.value=null})},{default:s(()=>[l(" 上一步 ")]),_:1}),t(K,{onClick:Ye},{default:s(()=>[l(" 確定 ")]),_:1})],2)])):ee("",!0)]),_:1}),o.showPreview?(m(),G(M,{key:0,flex:"428px",class:"relative"},{default:s(()=>[t(f,{message:e(Ue)},null,8,["message"])]),_:1})):ee("",!0)]),_:1},8,["class"]),t(Ct,{ref_key:"importCustomMessageRef",ref:Ee,content:e(c).content,onUpdateContent:Ae},null,8,["content"]),t($t,{ref_key:"addFieldRef",ref:rt,onAddFieldToContent:He},null,512),t(Rt,{ref_key:"addLinkRef",ref:Ke,onAddLinkToContent:qe},null,512),t(Ft,{ref_key:"aiTextGenerationRef",ref:We,content:e(c).content,onUpdateContent:Ae},null,8,["content"]),t(wt,{ref_key:"multimediaUploadRef",ref:Be,onUpdateMultimediaFile:Je},null,512),t(ns,{ref_key:"delMultimediaFileRef",ref:Xe},null,512),t(L,{open:e(ye),"onUpdate:open":a[22]||(a[22]=d=>Ce(ye)?ye.value=d:null),title:"是否放棄目前編輯的內容？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onCancel:a[23]||(a[23]=d=>e(c).messageType="MMS"),onOk:a[24]||(a[24]=()=>{e(c).content="",e(c).multimediaFile=[],e(c).subject="",ye.value=!1})},{default:s(()=>[Sn]),_:1},8,["open"]),t(xs,{ref_key:"selectContactRef",ref:Ve,"form-state":e(c),onUpdateFormState:Ze},null,8,["form-state"]),t(hs,{ref_key:"selectGroupRef",ref:Qe,"form-state":e(c),onUpdateFormState:Ze},null,8,["form-state"]),t(L,{open:e(he).open,"onUpdate:open":a[26]||(a[26]=d=>e(he).open=d),title:"資料格式有誤，請重新確認上傳",width:"400px",centered:""},{footer:s(()=>[t(K,{onClick:a[25]||(a[25]=d=>e(he).open=!1)},{default:s(()=>[l(" 確定 ")]),_:1})]),default:s(()=>[n("div",Mn,[n("p",Cn,[l(" 正確的格式範例 "),n("a",{class:"text-sms-primary-blue-80 ms-1 underline underline-offset-2",href:e(he).url,download:""},"點擊此處下載",8,$n)])])]),_:1},8,["open"])],64)}}}),Rn={class:"flex justify-center py-20px pt-54px"},Fn={class:"relative"},jn=$e({name:"PreviewGroupMultimedia",__name:"preview-group-multimedia",setup(F,{expose:D}){const P=g(!1),V=g([]);function H(b){P.value=!0;const R=[];if(k(b.subject)||R.push({phone:"",content:"",subject:b.subject,messageType:"SENT",contentType:"text"}),!k(b.multimediaFile))for(const $ of b.multimediaFile)R.push({phone:"",content:$.url,messageType:"SENT",contentType:$.type});V.value=R.map(($,p)=>({...$,key:p}))}return D({show:H}),(b,R)=>{const $=gt,p=Re;return m(),G(p,{open:e(P),"onUpdate:open":R[0]||(R[0]=N=>Ce(P)?P.value=N:null),width:"600px",footer:null},{default:s(()=>[n("div",Rn,[n("div",Fn,[t($,{message:e(V)},null,8,["message"])])])]),_:1},8,["open"])}}}),Pn={class:"px-20px pb-24px font-400 text-base text-sms-grayscale-80"},In=n("p",{class:"mb-4"},[l(" SMS：上限 335 字"),n("br"),l(" MMS：上限 1,000 字，可上傳多媒體 ")],-1),Nn=n("p",{class:"font-700 mb-4"}," 方式一：接收門號不同，且訊息內容不同 (支援SMS/MMS) ",-1),Dn={class:"list-decimal pl-20px m-0"},Ln=n("li",null,"若選擇 MMS 訊息，必須輸入訊息主旨與上傳多媒體檔案，請留意多媒體組別",-1),En=n("li",null," 系統將直接發送訊息內容到相應的手機號碼，請確保欄位為有效門號和訊息內容，不允許有空白欄位 ",-1),An=n("p",{class:"font-700 mb-4"}," 方式二：接收門號不同，訊息內容可使用 5 個參數 (支援SMS/MMS) ",-1),Un={class:"list-decimal pl-20px m-0"},Bn=n("li",null,"承上，請注意每個參數欄位上限 50 字",-1),On=n("li",null,"上傳檔案進行發送參數訊息，系統將自動將訊息內容中的參數替換為參數檔案門號列",-1),Vn={class:"text-xs"},zn=n("li",{class:"mb-4"},[l(" 訊息內容輸入： "),n("div",{class:"py-12.5px px-12px mt-4 rounded-12px border-sms-border-light-mode-light-gary border-solid -ms-20px"},[l(" %field1% 您好，您所填入的資料如下"),n("br"),l(" 會員編號： %field2% "),n("br"),l(" 性別： %field3% "),n("br"),l(" 生日： %field4% "),n("br"),l(" 年齡： %field5% ")])],-1),Gn=n("li",null,[l(" 兩門號收到的訊息分別如下： "),n("div",{class:"py-12.5px px-12px mt-4 rounded-12px border-sms-border-light-mode-light-gary border-solid -ms-20px"},[l(" 珊珊您好，您所填入的資料如下"),n("br"),l(" 會員編號： 9412918"),n("br"),l(" 性別： 女"),n("br"),l(" 生日： 08/22"),n("br"),l(" 年齡： 25"),n("br")]),n("div",{class:"py-12.5px px-12px mt-4 rounded-12px border-sms-border-light-mode-light-gary border-solid -ms-20px"},[l(" 馬可您好，您所填入的資料如下"),n("br"),l(" 會員編號： 5439577"),n("br"),l(" 性別： 男"),n("br"),l(" 生日： 08/29"),n("br"),l(" 年齡： 17"),n("br")])],-1),Yn=$e({__name:"instructions-modal",setup(F,{expose:D}){const P=g(!1);function V(){P.value=!0}return D({show:V}),(H,b)=>{const R=st,$=xt,p=St,N=Re;return m(),G(N,{open:e(P),"onUpdate:open":b[0]||(b[0]=S=>Ce(P)?P.value=S:null),"ok-text":"確定","cancel-text":"取消",title:"操作說明",width:"600px"},{default:s(()=>[n("div",Pn,[In,Nn,n("ul",Dn,[n("li",null,[l(" 請下載Excel範例並填寫後上傳 "),t($,{status:"small3",class:"!px-0 !py-0 !text-sms-primary-blue-80"},{icon:s(()=>[t(R,{name:"download"})]),default:s(()=>[l(" SMS匯出範例 ")]),_:1}),t($,{status:"small3",class:"!pl-2 !py-0 !text-sms-primary-blue-80"},{icon:s(()=>[t(R,{name:"download"})]),default:s(()=>[l(" MMS匯出範例 ")]),_:1})]),Ln,En,n("li",null,[l(" SMS 範例如下，兩個門號將收到不同內容的訊息： "),t(p,{class:"!-ms-20px mb-4",columns:[{key:"phone",dataIndex:"phone",title:"接收門號"},{key:"content",dataIndex:"content",title:"訊息內容"}],"data-source":[{phone:"0922333111",content:"VIP會員你好，邀請你參加會員專屬活動"},{phone:"0908111111",content:"你好，歡迎加入 ooo 專屬品牌會員"}]})]),n("li",null,[l(" MMS 範例如下，每個門號將收到不同文字內容和多媒體的訊息： "),t(p,{class:"!-ms-20px mb-4",columns:[{key:"phone",dataIndex:"phone",title:"接收門號"},{key:"content",dataIndex:"content",title:"訊息內容"},{key:"group",dataIndex:"group",title:"對應組別"}],"data-source":[{phone:"0922333111",content:"VIP會員你好，邀請你參加會員專屬活動...",group:"第一組"},{phone:"0908111111",content:"邀請你參加會員專屬活動，點擊下方連結...",group:"第二組"},{phone:"0908111111",content:"邀請你參加會員專屬活動，點擊下方連結...",group:"第二組"}]})])]),An,n("ul",Un,[n("li",null,[l(" 請下載Excel範例並填寫後上傳 "),t($,{status:"small3",class:"!px-0 !py-0 !text-sms-primary-blue-80"},{icon:s(()=>[t(R,{name:"download"})]),default:s(()=>[l(" SMS匯出範例 ")]),_:1}),t($,{status:"small3",class:"!pl-2 !py-0 !text-sms-primary-blue-80"},{icon:s(()=>[t(R,{name:"download"})]),default:s(()=>[l(" MMS匯出範例 ")]),_:1})]),Bn,n("li",null,[l("訊息輸入內容中使用 "),t(R,{name:"link"}),l(" 插入參數（%field1% 至 %field5%），系統將自動替換為檔案中的欄位參數內容")]),On,n("li",null,[l(" 若上傳檔案的內容如下： "),t(p,{class:"!-ms-20px mb-4 max-w-none instruction-table2",columns:[{key:"phone",dataIndex:"phone",title:"接收門號",width:"104px"},{key:"field1",dataIndex:"field1",title:"參數1",width:"74px"},{key:"field2",dataIndex:"field2",title:"參數2",width:"74px"},{key:"field3",dataIndex:"field3",title:"參數3",width:"74px"},{key:"field4",dataIndex:"field4",title:"參數4",width:"74px"},{key:"field5",dataIndex:"field5",title:"參數5",width:"74px"}],"data-source":[{phone:"0922333111",field1:"珊珊",field2:"9412918",field3:"女",field4:"08/22",field5:"25"},{phone:"0946184761",field1:"馬克",field2:"5439577",field3:"男",field4:"08/29",field5:"17"}]},{headerCell:s(({column:S})=>[S.key!=="phone"?(m(),C(Y,{key:0},[l(h(S.title)+" ",1),n("span",Vn,"(%"+h(S.key)+"%)",1)],64)):(m(),C(Y,{key:1},[l(h(S.title),1)],64))]),_:1})]),zn,Gn])])]),_:1},8,["open"])}}}),Hn=n("span",{class:"pe-.5"},"活動名稱",-1),Kn=n("span",{class:"text-red-500 pe-2"},"*",-1),qn={href:"javascript:;"},Wn=n("span",{class:"pe-.5"},"參數訊息類型",-1),Jn=n("span",{class:"text-red-500"},"*",-1),Xn=n("span",{class:"pe-.5"},"訊息主旨與上傳多媒體",-1),Qn=n("span",{class:"text-red-500 pe-2"},"*",-1),Zn={href:"javascript:;"},ea={key:0,class:"text-red-500 ps-2"},ta={class:"mb-2"},sa=n("div",null,"訊息主旨",-1),na={key:0,class:"flex gap-2 overflow-y-auto h-95px my-2"},aa={class:"text-sms-grayscale-60 text-xs font-500 font-sans text-center break-words"},oa=n("span",{class:"pe-.5"},"上傳參數檔案",-1),la=n("span",{class:"text-red-500 pe-2"},"*",-1),ia={href:"javascript:;"},ra=n("br",null,null,-1),ca={href:"javascript:;",class:"underline underline-offset-2 text-sms-primary-blue-80 text-sm line-height-14px py-1"},da=n("span",{class:"pe-.5"},"預覽參數檔案",-1),ua=n("span",{class:"text-red-500"},"*",-1),pa={key:0,class:"bg-sms-bg-light-mode-gray rounded-12px border-solid border-sms-grayscale-40 flex flex-col justify-center items-center h-106px"},ma=n("span",{class:"text-sms-grayscale-60"},"請先上傳參數檔案",-1),fa={class:"text-xs"},_a={class:"flex gap-2 overflow-y-auto h-95px"},ga={class:"text-sms-grayscale-60 text-xs font-500 font-sans text-center break-words"},xa=n("span",{class:"pe-.5"},"發送時間",-1),ya=n("span",{class:"text-red-500 pe-2"},"*",-1),ha={href:"javascript:;"},va=n("span",{class:"pe-.5"},"有效時間",-1),ba=n("span",{class:"text-red-500 pe-2"},"*",-1),ka={href:"javascript:;"},wa={key:0,id:"confirmDetail",class:"px-32px"},Ta={class:"mb-4"},Sa=n("h2",{class:"font-500 text-22px text-sms-secondary-dark-blue-100"}," 內容確認 ",-1),Ma={key:0,class:"text-sm text-sms-grayscale-80"},Ca={key:1,class:"list-disc m-0 text-sm pl-20px"},$a=n("li",null,"若有使用縮網址功能，請在發送訊息前再次確認短網址有效性，平台不會檢驗短網址有效性",-1),Ra={key:0},Fa={class:"border border-solid border-sms-light-gray-60 p-16px pb-24px rounded-12px mb-2"},ja=n("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 活動名稱 ",-1),Pa={class:"text-base font-400 text-sms-grayscale-100"},Ia=n("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 發送時間 ",-1),Na={key:0,class:"text-base font-400 text-sms-grayscale-100"},Da=n("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 訊息類型 ",-1),La={class:"text-base font-400 text-sms-grayscale-100"},Ea=n("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 發送門號 ",-1),Aa={class:"text-base font-400 text-sms-grayscale-100"},Ua=n("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 訊息總數 (長訊息) ",-1),Ba={class:"text-base font-400 text-sms-grayscale-100"},Oa={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},Va={href:"javascript:;"},za={class:"text-base font-400 text-sms-grayscale-100"},Ga=n("span",{class:"text-sms-grayscale-60 text-sm"}," (非最終數量)",-1),Ya=n("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 單價 ",-1),Ha={class:"text-base font-400 text-sms-grayscale-100"},Ka={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},qa={href:"javascript:;"},Wa={class:"text-base font-400 text-sms-grayscale-100"},Ja=n("span",{class:"text-sms-grayscale-60 text-sm"}," (非最終數量)",-1),Xa={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},Qa={href:"javascript:;"},Za={class:"text-base font-400 text-sms-grayscale-100"},eo=n("span",{class:"text-sms-grayscale-60 text-sm"}," (非最終數量)",-1),to={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},so={href:"javascript:;"},no=n("br",null,null,-1),ao={class:"text-base font-400 text-sms-grayscale-100"},oo={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},lo={href:"javascript:;"},io=n("div",{class:"text-center px-24px py-20px w-328px text-base mx-auto"},[l(" 您編輯過的訊息內容將全部清空 "),n("br"),n("br"),n("p",{class:"mb-0"}," 提醒您，您已上傳的檔案也會全部清除 ")],-1),ro={class:"text-center px-30px py-20px w-328px text-base mx-auto"},co={class:"text-base text-center text-sms-gary-80"},uo=["href"];var os=(F=>(F.smsDiffContent="接收門號不同，且訊息內容不同 (SMS)",F.mmsDiffContent="接收門號不同，且訊息內容不同 (MMS)",F.smsCommonContent="接收門號不同，訊息內容可使用 5 個參數 (SMS)",F.mmsCommonContent="接收門號不同，訊息內容可使用 5 個參數 (MMS)",F))(os||{});const Mo=$e({__name:"create-or-update-form",props:{isCreate:{type:Boolean,default:!1},id:{},editCallback:{},showPreview:{type:Boolean,default:!0}},setup(F){const D=F;te.extend(Qt);const{setHideAlert:P,setShowAlert:V}=Mt(),H=g(null),b=g(null),R=Pt(),$=Dt(),p=nt(D,"isCreate"),N=nt(D,"id"),{replaceFieldToHtml:S}=ss(),A=g(),{updateParameterMessageSending:ue,getParameterMessageSendingById:oe,createParameterMessageSending:pe,effectiveTimeOption:W,getActiveStatusLabel:me,checkMessageSendingNameExist:I,checkMessageSendingDetail:y}=as(),v=g(""),se=[{key:"第一組",subject:"",multimediaFile:[]},{key:"第二組",subject:"",multimediaFile:[]},{key:"第三組",subject:"",multimediaFile:[]}],U=g("smsDiffContent");let E={name:"",phone:void 0,isCommonContent:!1,messageType:"SMS",subject:"",multimediaFile:[],sendTimeType:"NOW",content:"",effectiveTime:"",reservationTime:"",multimediaFileWithSubject:tt(se),recipients:[]};const J=[{label:"0935-111-111",value:"0935-111-111"},{label:"0947-127-998",value:"0947-127-998"},{label:"0958-892-006",value:"0958-892-006"}],ne=g(!1),r=Le(tt(E)),c=Me(()=>r.messageType==="SMS"?335:1e3),Fe=Le({name:[{async validator(u,i){return k(i)?Promise.reject("請輸入活動名稱"):await I(i,N.value)?Promise.reject("此活動名稱已存在，請重新命名 "):Promise.resolve()},trigger:"blur"}],phone:[{required:!0,message:"請選擇發送門號",trigger:"blur"}],subject:[{async validator(u,i){return r.messageType==="MMS"&&r.isCommonContent&&k(i)?Promise.reject("請輸入訊息主旨"):Promise.resolve()},trigger:"blur"}],file:[{async validator(u,i){return kt(i)||yt(i)?Promise.reject("請上傳參數檔案"):Promise.resolve()},trigger:"blur"}],content:[{async validator(u,i){var o;if(r.isCommonContent){if(k(i))return Promise.reject("請輸入訊息內容");if(!k(i)&&((o=r.content)==null?void 0:o.replace(De,"").length)>c.value)return Promise.reject(`限制輸入 ${c.value} 字以內`)}return Promise.resolve()},trigger:"blur"}],reservationTime:[{async validator(u,i){if(r.sendTimeType==="RESERVATION"){if(k(i))return Promise.reject("請選擇預約日期或現在發送");if(te().diff(te(i),"minute")>0)return Promise.reject("閒置過久，請重新選擇預約時間")}return Promise.resolve()},trigger:"blur"}],multimediaFileWithSubject:[{async validator(u,i){if(U.value==="mmsDiffContent"){if(k(i))return Promise.reject("MMS 參數訊息請至少上傳一組訊息主旨與多媒體");if(i.filter(a=>k(a.multimediaFile)&&k(a.subject)).length===3)return Promise.reject("MMS 參數訊息請至少上傳一組訊息主旨與多媒體")}return Promise.resolve()},trigger:"blur"}]}),{validateInfos:le,validate:ce,resetFields:lt}=Ot(r,Fe);Lt(async()=>{var u,i,o,a,_,x,w,O;if(v.value=te().format("YYYY/MM/DD_HH:mm"),!p.value&&N.value){const M=await oe(N.value);M.data&&(A.value=M.data,E={name:((u=A.value)==null?void 0:u.name)??e(v),phone:((i=A.value)==null?void 0:i.phone)??void 0,isCommonContent:((o=A.value)==null?void 0:o.isCommonContent)??!1,messageType:((a=A.value)==null?void 0:a.messageType)??"SMS",subject:((_=A.value)==null?void 0:_.subject)??"",multimediaFile:((x=A.value)==null?void 0:x.multimediaFile)??[],sendTimeType:((w=A.value)==null?void 0:w.sendTimeType)??"NOW",content:A.value.content??"",effectiveTime:A.value.effectiveTime??"",reservationTime:A.value.reservationTime??"",recipients:A.value.recipients??[],multimediaFileWithSubject:((O=A.value)==null?void 0:O.multimediaFileWithSubject)??[],file:A.value.file??void 0}),E.messageType==="MMS"?E.isCommonContent?U.value="mmsCommonContent":U.value="mmsDiffContent":E.isCommonContent?U.value="smsCommonContent":U.value="smsDiffContent"}else E.name=e(v),E.file=void 0;lt(E)}),Et(()=>r,u=>{const i=at(u,E);p.value&&!N.value&&(i?P():V())},{deep:!0});const j=g(null);function B(){ce().then(async()=>{const u=await y(r,!0);if(u.data){j.value=u.data,ne.value=!0,await _t();const i=document.getElementById("app");i&&(i.scrollTop=0)}}).catch(u=>{console.log(u)})}async function it(){var o;((o=(await(e(p)?pe:ue)(r,N.value)).data)==null?void 0:o.status)==="success"&&(p.value&&!N.value?P():(D.editCallback&&D.editCallback(!0,N.value),R.success({message:"訊息編輯成功",placement:"top"})))}const Ye=g(null);function Ee(u){r.content=S(u)}const Ae=g(null);function rt(u){for(const i of u)r.content=`${r.content}<span>${i}</span>`}const He=g(null);function Ke(u){r.content=`${r.content}<a href="${u}">${u}</a>`}const qe=g(null),We=Me(()=>{const u=[];switch(e(U)){case"smsCommonContent":case"mmsCommonContent":{const i=r.recipients[0];let o=r.content;if((!k(r.content)||!k(r.subject))&&(i&&(i.field1&&i.field1!=="-"&&(o=o.replace(/%field1%/g,i.field1)),i.field2&&i.field1!=="-"&&(o=o.replace(/%field2%/g,i.field2)),i.field3&&i.field3!=="-"&&(o=o.replace(/%field3%/g,i.field3)),i.field4&&i.field4!=="-"&&(o=o.replace(/%field4%/g,i.field4)),i.field5&&i.field5!=="-"&&(o=o.replace(/%field5%/g,i.field5))),u.push({phone:r.phone,content:o,...r.messageType==="MMS"&&{subject:r.subject},messageType:"SENT",contentType:"text"})),!k(r.multimediaFile))for(const a of r.multimediaFile)u.push({phone:r.phone,content:a.url,messageType:"SENT",contentType:a.type});break}case"mmsDiffContent":{const i=r.recipients[0];if(i){const o=r.multimediaFileWithSubject.find(a=>a.key===i.group);if(u.push({phone:r.phone,content:i.content,...r.messageType==="MMS"&&{subject:(o==null?void 0:o.subject)??""},messageType:"SENT",contentType:"text"}),o&&!k(o.multimediaFile))for(const a of o.multimediaFile)u.push({phone:r.phone,content:a.url,messageType:"SENT",contentType:a.type})}break}case"smsDiffContent":{const i=r.recipients[0];i&&u.push({phone:r.phone,content:i.content,messageType:"SENT",contentType:"text"});break}}return u.map((i,o)=>({...i,key:o}))}),Ue=g(null),Be=g(null);function Je(u,i=null){var o;(o=Be.value)==null||o.show(u),Ue.value=i}function Xe(u){kt(Ue.value)?r.multimediaFile=u:r.multimediaFileWithSubject[Ue.value].multimediaFile=u}const Oe=g(null);function ye(u){r.multimediaFile=r.multimediaFile.filter(i=>i.url!==u.url)}function ct(u,i){r.multimediaFileWithSubject[u].multimediaFile=r.multimediaFileWithSubject[u].multimediaFile.filter(o=>o.url!==i.url)}const Ve=te();function Qe(u){const i=Ve.add(1,"year");return u&&(u<Ve||u>=i)}function Ze(u){if(u&&u.isToday()){const i=te().add(5,"minute"),o=i.hour(),a=i.minute();return{disabledHours:()=>ot(0,24).slice(0,o),disabledMinutes:()=>ot(0,60).slice(0,a)}}return{}}function he(){const u=at(r,E);D.editCallback&&D.editCallback(u)}function je(){p.value&&!N.value?$.push("/sms-marketing/message-sending"):he()}const fe=g({open:!1,parameterMessageType:"smsCommonContent"});function dt(u){const i=r.multimediaFileWithSubject.filter(o=>!k(o.multimediaFile)||!k(o.subject));r.file||!k(r.recipients)||!k(r.content)||!k(r.subject)||!k(r.multimediaFile)||!k(i)?fe.value={open:!0,parameterMessageType:u.target.value}:et(u.target.value)}function et(u){switch(U.value=u,e(u)){case"smsCommonContent":r.messageType="SMS",r.isCommonContent=!0;break;case"mmsCommonContent":r.messageType="MMS",r.isCommonContent=!0;break;case"mmsDiffContent":r.messageType="MMS",r.isCommonContent=!1;break;default:r.messageType="SMS",r.isCommonContent=!1;break}r.file&&(r.file=void 0),fe.value.open&&(fe.value.open=!1,r.content="",r.subject="",r.recipients=[],r.multimediaFile=[],r.multimediaFileWithSubject=tt(se))}const ve=g({open:!1,url:""}),Pe=g(null);function ut(u){const o=u.target.files;if(o&&o.length>0&&Pe.value){switch(e(U)){case"smsDiffContent":r.recipients=[{number:"1",phone:"0937118365",content:"親愛的黃先生您好，邀請您參加季末促銷活動！在這個特別的時刻"},{number:"2",phone:"0934837779",content:"親愛的邱會員，感謝您一直以來對我們的支持！為了回饋您的"},{number:"3",phone:"0973789398",content:"哈囉！您的專屬會員優惠已經準備就緒，等待您的立即領取！"},{number:"4",phone:"0911848298",content:"黃金會員專屬優惠啟動！您的獨享超級禮遇即將開始，千萬別"},{number:"5",phone:"0948393711",content:"親愛的會員，您是我們最珍貴的財富！為了感謝您長久以來的"}];break;case"mmsDiffContent":r.recipients=[{number:"1",phone:"0937118365",content:"親愛的黃先生您好，邀請您參加季末促銷活動！在這個特別的時刻",group:"第二組"},{number:"2",phone:"0934837779",content:"親愛的邱會員，感謝您一直以來對我們的支持！為了回饋您的",group:"第二組"},{number:"3",phone:"0973789398",content:"哈囉！您的專屬會員優惠已經準備就緒，等待您的立即領取！",group:"第二組"},{number:"4",phone:"0911848298",content:"黃金會員專屬優惠啟動！您的獨享超級禮遇即將開始，千萬別",group:"第一組"},{number:"5",phone:"0948393711",content:"親愛的會員，您是我們最珍貴的財富！為了感謝您長久以來的",group:"第一組"}];break;case"smsCommonContent":case"mmsCommonContent":r.recipients=[{number:"1",phone:"0938118293",field1:"小馬",field2:"9412918",field3:"-",field4:"-",field5:"-"},{number:"2",phone:"0946184761",field1:"安潔",field2:"5439577",field3:"-",field4:"-",field5:"-"},{number:"3",phone:"0966092938",field1:"Lucy",field2:"5634840",field3:"-",field4:"-",field5:"-"},{number:"4",phone:"0956482371",field1:"Sam",field2:"3437402",field3:"-",field4:"-",field5:"-"},{number:"5",phone:"0978049940",field1:"Tim",field2:"8480277",field3:"-",field4:"-",field5:"-"}];break}r.file={fileName:o[0].name,url:window.URL.createObjectURL(o[0])},Pe.value.value=""}}const pt=Me(()=>{let u=[];switch(e(U)){case"mmsDiffContent":u=[{title:"編號",key:"number",dataIndex:"number",width:"57px",align:"center"},{title:"接收門號",key:"phone",dataIndex:"phone",width:"100px"},{title:"訊息內容",key:"content",dataIndex:"content",width:"278.5px",ellipsis:!0},{title:"對應組別",key:"group",dataIndex:"group",width:"107.5px"}];break;case"smsDiffContent":u=[{title:"編號",key:"number",dataIndex:"number",width:"57px",align:"center"},{title:"接收門號",key:"phone",dataIndex:"phone",width:"100px"},{title:"訊息內容",key:"content",dataIndex:"content",width:"278.5px",ellipsis:!0}];break;case"smsCommonContent":case"mmsCommonContent":u=[{title:"編號",key:"number",dataIndex:"number",width:"57px",align:"center"},{title:"接收門號",key:"phone",dataIndex:"phone",width:"100px"},{key:"field1",dataIndex:"field1",title:"參數1",width:"74px"},{key:"field2",dataIndex:"field2",title:"參數2",width:"74px"},{key:"field3",dataIndex:"field3",title:"參數3",width:"74px"},{key:"field4",dataIndex:"field4",title:"參數4",width:"74px"},{key:"field5",dataIndex:"field5",title:"參數5",width:"74px"}];break;default:u=[];break}return u}),mt=It();function ze(){mt.confirm({title:"是否取消上傳檔案？",icon:t("span"),content:Ut("div",{innerHTML:"該檔案將取消上傳",class:"text-center px-30px py-20px w-328px text-base mx-auto"}),width:"400px",centered:!0,closable:!0,async onOk(){r.file=void 0,r.recipients=[]}})}return(u,i)=>{const o=st,a=Vt,_=zt,x=Gt,w=Yt,O=Ht,M=ps,Z=Kt,K=qt,X=xt,be=Tt,ke=st,we=St,Te=jt,Ie=Wt,_e=Jt,Ne=Xt,ge=gt,Se=Re;return m(),C(Y,null,[t(_e,{class:de(["bg-sms-grayscale-0 rounded-4",{"p-10 pl-1":e(p)&&!e(N)}]),wrap:!1},{default:s(()=>[t(w,{flex:"auto"},{default:s(()=>[ie(t(Ne,{class:"px-32px",layout:"vertical",autocomplete:"off",onSubmit:B},{default:s(()=>[t(_e,{gutter:[16,14]},{default:s(()=>[t(w,{span:24},{default:s(()=>[t(x,Q(e(le).name,{"html-for":""}),{label:s(()=>[Hn,Kn,t(a,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 活動名稱可使用系統預設或自行輸入，但不可重複 ")]),default:s(()=>[n("a",qn,[t(o,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:s(()=>[t(_,{value:e(r).name,"onUpdate:value":i[0]||(i[0]=f=>e(r).name=f),placeholder:"請輸入文字",maxlength:30,onFocus:i[1]||(i[1]=()=>{e(r).name===e(v)&&(e(r).name="")}),onBlur:i[2]||(i[2]=()=>{e(r).name===""&&(e(r).name=e(v))})},null,8,["value"])]),_:1},16)]),_:1}),t(w,{span:24},{default:s(()=>[t(x,Q(e(le).phone,{label:"發送門號",required:""}),{default:s(()=>[t(O,{value:e(r).phone,"onUpdate:value":i[3]||(i[3]=f=>e(r).phone=f),options:J,"allow-clear":"",placeholder:"請選擇發送門號"},null,8,["value"])]),_:1},16)]),_:1}),t(w,{span:24},{default:s(()=>[t(x,{"html-for":""},{label:s(()=>[Wn,Jn,t(M,{type:"link",status:"small3",onClick:i[4]||(i[4]=f=>{var L;return(L=e(b))==null?void 0:L.show()})},{icon:s(()=>[t(o,{name:"doc",width:"16px"})]),default:s(()=>[l(" 操作說明 ")]),_:1})]),default:s(()=>[t(K,{value:e(U),onChange:dt},{default:s(()=>[(m(!0),C(Y,null,xe(Object.entries(os),([f,L])=>(m(),G(Z,{key:f,style:{display:"flex",alignItems:"center",marginBottom:"10.5px"},value:f},{default:s(()=>[l(h(L)+" ",1),t(M,{type:"link",class:"!py-4px !px-0"},{icon:s(()=>[t(o,{name:"download"})]),default:s(()=>[l(" 匯出範例 ")]),_:1})]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),!e(r).isCommonContent&&e(r).messageType==="MMS"?(m(),G(w,{key:0,span:24},{default:s(()=>[t(x,{"html-for":""},{label:s(()=>{var f;return[Xn,Qn,t(a,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 多上傳三組多媒體檔案，並請依匯出範例欄位填入對應多媒體組別 ")]),default:s(()=>[n("a",Zn,[t(o,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"]),e(le).multimediaFileWithSubject.validateStatus==="error"?(m(),C("span",ea,h((f=e(le).multimediaFileWithSubject)==null?void 0:f.help.join(" ")),1)):ee("",!0)]}),default:s(()=>[(m(!0),C(Y,null,xe(e(r).multimediaFileWithSubject,(f,L)=>(m(),G(w,{span:24,class:"bg-sms-bg-light-mode-gray rounded-md !p-20px mb-2",key:f.key},{default:s(()=>[n("div",ta,[l(h(f.key)+" ",1),t(X,{class:"text-sms-primary-blue-80 !px-0",status:"small3",onClick:d=>{var T;return(T=e(H))==null?void 0:T.show(f)}},{icon:s(()=>[t(o,{name:"preview-blue",width:"16px"})]),_:2},1032,["onClick"])]),t(x,{"html-for":"",name:["multimediaFileWithSubject",L,"subject"],extra:"15 字以內"},{label:s(()=>[sa]),default:s(()=>[t(_,{value:f.subject,"onUpdate:value":d=>f.subject=d,placeholder:"請輸入訊息主旨",maxlength:15},null,8,["value","onUpdate:value"])]),_:2},1032,["name"]),f.multimediaFile.length>0?(m(),C("div",na,[(m(!0),C(Y,null,xe(f.multimediaFile,d=>(m(),C("div",{key:d.url,class:"w-90px max-h-60px"},[t(be,{source:{url:d.url,type:d.type},"show-file-name":!1,"can-play":!1,size:"small","image-class":"object-cover w-full h-full",onDeleteVideo:()=>{var T;return(T=e(Oe))==null?void 0:T.show(()=>ct(L,d))}},null,8,["source","onDeleteVideo"]),n("div",aa,h(d.fileName),1)]))),128))])):ee("",!0),t(X,{status:"small2",onClick:d=>Je(f.multimediaFile,L)},{icon:s(()=>[t(o,{name:"upload"})]),default:s(()=>[l(" 上傳多媒體 ")]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),_:1})):ee("",!0),t(w,{span:24},{default:s(()=>[t(x,Q({"html-for":""},e(le).file),{label:s(()=>[oa,la,t(a,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 1.每則訊息字數(含參數)不能超過限制。SMS 上限 335 字，MMS 上限1,000 字。"),ra,l(" 2.每個參數欄位上限 50 字 ")]),default:s(()=>[n("a",ia,[t(o,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:s(()=>[n("input",{ref_key:"uploadFileRef",ref:Pe,type:"file",class:"!hidden",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onChange:ut},null,544),e(r).file?(m(),C(Y,{key:1},[n("a",ca,h(e(r).file.fileName),1),t(o,{name:"download-circle",width:"16px",class:"mx-2 cursor-pointer"}),t(o,{name:"delete-circle",width:"16px",class:"cursor-pointer",onClick:ze})],64)):(m(),G(X,{key:0,status:"small2",onClick:i[5]||(i[5]=f=>{var L;return(L=e(Pe))==null?void 0:L.click()})},{icon:s(()=>[t(ke,{name:"upload"})]),default:s(()=>[l(" 上傳EXCEL ")]),_:1}))]),_:1},16)]),_:1}),t(w,{span:24},{default:s(()=>[t(x,{"html-for":""},{label:s(()=>[da,ua]),default:s(()=>[e(r).file?(m(),G(we,{key:1,columns:e(pt),"data-source":e(r).recipients},{headerCell:s(({column:f})=>[f.key.includes("field")?(m(),C(Y,{key:0},[l(h(f.title)+" ",1),n("span",fa,"(%"+h(f.key)+"%)",1)],64)):(m(),C(Y,{key:1},[l(h(f.title),1)],64))]),_:1},8,["columns","data-source"])):(m(),C("div",pa,[t(ke,{name:"upload-circle-2",width:"40px",class:"text-sms-grayscale-40 mb-2"}),ma]))]),_:1})]),_:1}),ie(t(w,{span:24},{default:s(()=>[t(x,Q({label:"訊息主旨"},e(le).subject,{extra:"15 字以內"}),{default:s(()=>[t(_,{value:e(r).subject,"onUpdate:value":i[6]||(i[6]=f=>e(r).subject=f),placeholder:"請輸入訊息主旨",maxlength:15},null,8,["value"])]),_:1},16)]),_:1},512),[[re,e(r).messageType==="MMS"&&e(r).isCommonContent]]),ie(t(w,{span:24},{default:s(()=>{var f;return[t(x,Q({"html-for":"",label:"訊息內容"},e(le).content,{class:"relative",extra:`${e(r).messageType} 上限 ${e(c).toLocaleString()} 字，目前 ${e(k)(e(r).content)?"--":(f=e(r).content)==null?void 0:f.replace(e(De),"").length} 字`}),{default:s(()=>{var L;return[t(Te,{modelValue:e(r).content,"onUpdate:modelValue":i[12]||(i[12]=d=>e(r).content=d),contenteditable:"true",style:{height:"292px"},"content-len":(L=e(r).content)==null?void 0:L.replace(e(De),"").length,"max-len":e(c),placeholder:"請輸入文字"},At({default:s(()=>[t(a,null,{title:s(()=>[l(" 載入現有的自訂訊息 ")]),default:s(()=>[t(o,{name:"import",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:i[7]||(i[7]=d=>{var T;return(T=e(Ye))==null?void 0:T.show()})})]),_:1}),t(a,null,{title:s(()=>[l(" 加入參數 ")]),default:s(()=>[t(o,{name:"code",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:i[8]||(i[8]=d=>{var T;return(T=e(Ae))==null?void 0:T.show()})})]),_:1}),t(a,null,{title:s(()=>[l(" 增加縮網址 ")]),default:s(()=>[t(o,{name:"link",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:i[9]||(i[9]=d=>{var T;return(T=e(He))==null?void 0:T.show()})})]),_:1}),t(a,null,{title:s(()=>[l(" 多媒體附件上傳 ")]),default:s(()=>[ie(t(o,{name:"cloud-upload",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:i[10]||(i[10]=d=>Je(e(r).multimediaFile))},null,512),[[re,e(r).messageType==="MMS"]])]),_:1}),t(a,null,{title:s(()=>[l(" AI 文字生成訊息 ")]),default:s(()=>[t(o,{name:"AI",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:i[11]||(i[11]=d=>{var T;return(T=e(qe))==null?void 0:T.show()})})]),_:1})]),_:2},[e(r).multimediaFile.length>0?{name:"multimediaBlock",fn:s(()=>[n("div",_a,[(m(!0),C(Y,null,xe(e(r).multimediaFile,d=>(m(),C("div",{key:d.url,class:"w-90px max-h-60px"},[t(be,{source:{url:d.url,type:d.type},"show-file-name":!1,"can-play":!1,size:"small","image-class":"object-cover w-full h-full",onDeleteVideo:T=>{var q;return(q=e(Oe))==null?void 0:q.show(()=>ye(d))}},null,8,["source","onDeleteVideo"]),n("div",ga,h(d.fileName),1)]))),128))])]),key:"0"}:void 0]),1032,["modelValue","content-len","max-len"])]}),_:1},16,["extra"])]}),_:1},512),[[re,e(r).isCommonContent]]),t(w,{span:24,class:"bg-sms-bg-light-mode-gray rounded-md !p-20px"},{default:s(()=>[t(x,Q(e(le).reservationTime,{"html-for":"",class:"mb-4"}),{label:s(()=>[xa,ya,t(a,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 最快可預約5分鐘之後以及系統當下 1 年內時間，惟實際發送時間以系統排程為主 ")]),default:s(()=>[n("a",ha,[t(o,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:s(()=>[t(K,{value:e(r).sendTimeType,"onUpdate:value":i[13]||(i[13]=f=>e(r).sendTimeType=f)},{default:s(()=>[(m(!0),C(Y,null,xe(Object.entries(e(ht)),([f,L])=>(m(),G(Z,{key:f,value:f},{default:s(()=>[l(h(L),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),ie(t(Ie,{value:e(r).reservationTime,"onUpdate:value":i[14]||(i[14]=f=>e(r).reservationTime=f),format:"YYYY/MM/DD HH:mm","value-format":"YYYY/MM/DD HH:mm","disabled-date":Qe,"disabled-time":Ze,"show-time":!0,"show-now":!1},null,8,["value"]),[[re,e(r).sendTimeType==="RESERVATION"]])]),_:1},16),t(x,Q(e(le).sendTimeType,{"html-for":""}),{label:s(()=>[va,ba,t(a,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 因接收門號而無法成功送達訊息，會在此設定有效時間內重複嘗試發送 ")]),default:s(()=>[n("a",ka,[t(o,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:s(()=>[t(O,{value:e(r).effectiveTime,"onUpdate:value":i[15]||(i[15]=f=>e(r).effectiveTime=f),options:e(W),"list-height":300,placeholder:"請選擇有效時間"},null,8,["value","options"])]),_:1},16)]),_:1}),t(w,{span:24,class:de({"text-end":e(p)&&!e(N),"text-center py-6 ":!e(p)&&e(N)})},{default:s(()=>[t(X,{status:"small2",class:"me-2",onClick:je},{default:s(()=>[l(" 取消 ")]),_:1}),t(X,{status:"small1","html-type":"submit"},{default:s(()=>[l(" 確定 ")]),_:1})]),_:1},8,["class"])]),_:1})]),_:1},512),[[re,!e(ne)]]),e(ne)&&e(j)?(m(),C("div",wa,[n("div",Ta,[Sa,e(j).isParameter?(m(),C("ul",Ca,[$a,e(j).messageType==="SMS"?(m(),C("li",Ra," 當參數檔案中的欄位字數不一致時，每個參數都會單獨計算字數。若任何一個參數訊息超過70字，將會以長簡訊方式發送。")):ee("",!0)])):(m(),C("p",Ma," 若有使用縮網址功能，請在發送訊息前再次確認短網址有效性，平台不會檢驗短網址有效性 "))]),n("div",Fa,[t(_e,{gutter:[16,16]},{default:s(()=>[t(w,{span:24,class:"mb-"},{default:s(()=>[ja,n("div",Pa,h(e(j).name),1)]),_:1}),t(w,{span:8},{default:s(()=>[Ia,e(j).sendTimeType==="RESERVATION"?(m(),C("div",Na,h(e(j).reservationTime),1)):(m(),C("div",{key:1,class:de(["text-base font-400 text-sms-grayscale-100",{"text-sms-status-alert-red":Math.sign(e(j).estimatedRemainingAmount)===-1}])}," 現在 ",2))]),_:1}),t(w,{span:8},{default:s(()=>[Da,n("div",La,h(e(me)(e(j).messageType,e(j).isParameter)),1)]),_:1}),t(w,{span:8},{default:s(()=>[Ea,n("div",Aa,h(e(j).phone),1)]),_:1}),e(j).messageType==="SMS"&&!e(j).isParameter?(m(),G(w,{key:0,span:8},{default:s(()=>[Ua,n("div",Ba,h(e(j).totalLongMessages),1)]),_:1})):ee("",!0),e(j).messageType==="SMS"&&e(j).isParameter?(m(),G(w,{key:1,span:8},{default:s(()=>[n("div",Oa,[l(" 預估訊息總數 "),t(a,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 參數訊息類型一的字數以「一則訊息」估算。參數訊息類型二以「訊息內容字數進行估算(不含參數字數)」，惟實際發送時依參數檔案欄位字數計算 ")]),default:s(()=>[n("a",Va,[t(o,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),n("div",za,[l(h(e(j).estimatedTotalMessages)+" ",1),Ga])]),_:1})):ee("",!0),t(w,{span:8},{default:s(()=>[Ya,n("div",Ha," NT$ "+h(e(j).price),1)]),_:1}),t(w,{span:8},{default:s(()=>[n("div",Ka,[l(" 接收門號總數 "),t(a,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 未過濾所有黑名單，發送時會再檢核，最終接收門號數量可能變動 ")]),default:s(()=>[n("a",qa,[t(o,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),n("div",Wa,[l(h(e(j).recipientsCount.toLocaleString())+" ",1),Ja])]),_:1}),t(w,{span:8},{default:s(()=>[n("div",Xa,[l(" 黑名單門號總數 "),t(a,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 目前已篩選掉該黑名單數量，發送時會再檢核最新黑名單，最終黑名單門號總數可能變動 ")]),default:s(()=>[n("a",Qa,[t(o,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),n("div",Za,[l(h(e(j).isBlackListCount.toLocaleString())+" ",1),eo])]),_:1}),t(w,{span:8},{default:s(()=>[n("div",to,[l(" 預估發送總金額 "),t(a,{placement:"top","get-popup-container":e(z),"overlay-inner-style":{width:"397px"}},{title:s(()=>[l(" 發送總金額 = 訊息總數 x ( 接收門號總數 - 黑名單門號總數 ) x 單價"),no,l(" 參數訊息之訊息總數以一則計算，實際計價以發送字數等於幾則來計價 ")]),default:s(()=>[n("a",so,[t(o,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),n("div",ao," NT$ "+h(e(j).estimatedTotalAmount.toLocaleString()),1)]),_:1}),t(w,{span:8},{default:s(()=>[n("div",oo,[l(" 預估剩餘金額 "),t(a,{placement:"top","get-popup-container":e(z)},{title:s(()=>[l(" 餘額不足仍可預約，請注意於預約時間前進行儲值才可成功發送訊息 ")]),default:s(()=>[n("a",lo,[t(o,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),n("div",{class:de(["text-base font-400 text-sms-grayscale-100",{"text-sms-status-alert-red":Math.sign(e(j).estimatedRemainingAmount)===-1}])}," NT$ "+h(e(j).estimatedRemainingAmount.toLocaleString()),3)]),_:1})]),_:1})]),n("div",{class:de(["flex items-center justify-end",{"py-4":!e(p)&&e(N)}])},[ie(n("div",{class:"text-sms-status-alert-red text-base me-4"},h(e(j).sendTimeType==="RESERVATION"?"可預約，請於發送時間之前儲值完畢，以免發送失敗":"剩餘金額不足，建議回上一步改成預約發送後再盡快儲值"),513),[[re,Math.sign(e(j).estimatedRemainingAmount)===-1]]),t(X,{status:"small2",class:"me-2",onClick:i[16]||(i[16]=()=>{ne.value=!1,j.value=null})},{default:s(()=>[l(" 上一步 ")]),_:1}),t(X,{onClick:it},{default:s(()=>[l(" 確定 ")]),_:1})],2)])):ee("",!0)]),_:1}),u.showPreview?(m(),G(w,{key:0,flex:"428px",class:"relative"},{default:s(()=>[t(ge,{message:e(We)},null,8,["message"])]),_:1})):ee("",!0)]),_:1},8,["class"]),t(Ct,{ref_key:"importCustomMessageRef",ref:Ye,content:e(r).content,onUpdateContent:Ee},null,8,["content"]),t($t,{ref_key:"addFieldRef",ref:Ae,onAddFieldToContent:rt},null,512),t(Rt,{ref_key:"addLinkRef",ref:He,onAddLinkToContent:Ke},null,512),t(Ft,{ref_key:"aiTextGenerationRef",ref:qe,content:e(r).content,onUpdateContent:Ee},null,8,["content"]),t(wt,{ref_key:"multimediaUploadRef",ref:Be,onUpdateMultimediaFile:Xe},null,512),t(ns,{ref_key:"delMultimediaFileRef",ref:Oe},null,512),t(Se,{open:e(fe).open,"onUpdate:open":i[17]||(i[17]=f=>e(fe).open=f),title:"是否放棄目前編輯的訊息內容？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onOk:i[18]||(i[18]=f=>et(e(fe).parameterMessageType))},{default:s(()=>[io]),_:1},8,["open"]),t(Se,{open:e(ve).open,"onUpdate:open":i[20]||(i[20]=f=>e(ve).open=f),title:"資料格式有誤，請重新確認上傳",width:"400px",centered:""},{footer:s(()=>[t(X,{onClick:i[19]||(i[19]=f=>e(ve).open=!1)},{default:s(()=>[l(" 確定 ")]),_:1})]),default:s(()=>[n("div",ro,[n("p",co,[l(" 正確的格式範例 "),n("a",{class:"text-sms-primary-blue-80 ms-1 underline underline-offset-2",href:e(ve).url,download:""},"點擊此處下載",8,uo)])])]),_:1},8,["open"]),t(Yn,{ref_key:"instructionsModalRef",ref:b},null,512),t(jn,{ref_key:"previewGroupMultimediaRef",ref:H},null,512)],64)}}});export{Ge as M,So as _,Mo as a,as as u};
