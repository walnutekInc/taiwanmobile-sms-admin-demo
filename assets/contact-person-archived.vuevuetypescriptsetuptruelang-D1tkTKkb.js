import{_ as de}from"./index.vuevuetypestyleindex0lang-Dy5B8DSM.js";import{_ as ue}from"./index.vuevuetypescriptsetuptruelang-M0oBbQZh.js";import{_ as ie,a as re}from"./index.vuevuetypescriptsetuptruelang-B10Rmm3B.js";import{_ as pe}from"./index-lhkxvzbI.js";import{_ as ce}from"./index.vuevuetypescriptsetuptruelang-JVP7TRv3.js";import{j as me,_ as fe}from"./index-CYqi8OAn.js";import{a as _e,g as ve}from"./tools-DuR4KSGu.js";import{_ as xe}from"./request-BPdP2g-k.js";import{u as ye}from"./contact-person-B448c8Al.js";import{G as ge}from"./GenderEnum-DlheD0SA.js";import{u as we}from"./group-label-DDfzgg2s.js";import{P as ke,I as he,p as be,q as Ce,G as Ie,s as Re,F as Te,H as Ye,z as Le}from"./antd-BeRLmHJE.js";import{d as Me,f as x,D as De,o as Pe,r as Ue,u as e,W as m,X as y,Y as p,k as a,$ as n,G as r,F as g,a3 as f,a4 as w,_ as Ke,H as V}from"./vue-BvWPEeCa.js";const Ve={class:"flex justify-between px-2 items-center mb-2"},Oe={class:"me-1"},Be={href:"javascript:;"},Fe=p("span",null,"全域黑名單功能: 主帳號將特定手機門號加入黑名單，主帳號和子帳號皆無法發送該門號任何訊息",-1),Se=p("div",{class:"h-59px px-20px py-24px"},[p("p",{class:"text-center text-sms-grayscale-80"}," 您選擇的聯絡人將直接永久刪除。 ")],-1),$e=p("div",{class:"h-59px px-20px py-24px"},[p("p",{class:"text-center text-sms-grayscale-80"}," 聯絡人列表中，已經存在相同的聯絡人。 ")],-1),et=Me({__name:"contact-person-archived",props:{toContactPerson:{type:Function,required:!0}},setup(O){const B=O,Y=x([{value:"true",label:"是"},{value:"false",label:"否"}]),{contactPerson:L,pagination:_,getContactPersonArchived:F,deleteContactPerson:S,unArchivedContactPerson:$}=ye(),{getGroupLabelOption:E,groupOptions:M}=we(),D=me(),G=x(!1);De(async()=>{k(),await E()}),Pe(()=>{G.value=!0});const N=[{title:"手機門號",dataIndex:"phone",key:"phone",sorter:!0,fixed:"left",width:"130px"},{title:"姓名",dataIndex:"name",key:"name",sorter:!0,fixed:"left",width:"80px"},{title:"群組標籤",dataIndex:"group",key:"group",fixed:"left",width:"250px"},{title:"性別",dataIndex:"gender",key:"gender",sorter:!0,width:"70px"},{title:"黑名單",dataIndex:"isBlackList",key:"isBlackList",sorter:!0,width:"100px"},{title:"聯絡電話",dataIndex:"contact",key:"contact",sorter:!0,width:"110px"},{title:"公司名稱",dataIndex:"company",key:"company",sorter:!0,ellipsis:!0,width:"121px"},{title:"Email",dataIndex:"email",key:"email",sorter:!0,ellipsis:!0,width:"184px"},{title:"生日",dataIndex:"birth",key:"birth",sorter:!0,width:"95px"},{title:"通訊地址",dataIndex:"address",key:"address",sorter:!0,ellipsis:!0,width:"108px"},{title:"備註",dataIndex:"note",key:"note",sorter:!0,width:"108px"},{title:"建立時間",dataIndex:"createTime",key:"createTime",defaultSortOrder:"descend",sorter:!0,width:"140px"},{title:"修改時間",dataIndex:"updateTime",key:"updateTime",sorter:!0,width:"140px"}],i=Ue({selectedRowKeys:[],selectedRows:[],loading:!1});function j(s,t){console.log("selectedRowKeys changed: ",s,t),i.selectedRowKeys=s,i.selectedRows=t}const l=x({sortField:"createTime",sortOrder:"descend",phone:"",name:"",group:[],company:"",createTime:void 0,updateTime:void 0,keyword:"",blackList:void 0}),z=x();async function k(s=1,t=10){const d={current:s,pageSize:t,...e(l)};await F(d)}async function A(s,t,d){console.log("sorter:",d),l.value=Object.assign(l.value,{sortField:d.field,sortOrder:d.order}),await k(_.value.current,_.value.pageSize)}async function q(s,t){await k(s,t)}const R=x(null);function H(){var s;k(1),(s=R.value)==null||s.hide()}const h=x(!1);async function W(){var t;((t=(await S(i.selectedRows.map(d=>d.key))).data)==null?void 0:t.status)==="success"&&(k(_.value.current===1||L.value.length-i.selectedRowKeys.length>1?_.value.current:_.value.current-1,_.value.pageSize),i.selectedRowKeys=[],i.selectedRows=[],h.value=!1,D.success({message:"聯絡人刪除成功",placement:"top"}))}const C=x(!1);function X(){C.value=!0}async function J(){var t;((t=(await $(i.selectedRowKeys)).data)==null?void 0:t.status)==="success"&&(D.success({message:"聯絡人回復成功",placement:"top"}),B.toContactPerson())}function Q(){J()}function Z(){return document.body}return(s,t)=>{const d=fe,b=ce,T=he,v=pe,c=be,ee=ie,te=re,P=Ce,U=Ie,ae=Re,oe=Te,ne=Ye,le=ue,se=de,K=Le;return m(),y(g,null,[p("div",Ve,[p("div",null,[a(b,{status:"small2",class:"me-2",disabled:e(i).selectedRowKeys.length===0,onClick:X},{icon:n(()=>[a(d,{name:"change",width:"16px"})]),default:n(()=>[r(" 回復聯絡人 ")]),_:1},8,["disabled"]),a(b,{status:"small2",class:"me-2",disabled:e(i).selectedRowKeys.length===0},{icon:n(()=>[a(d,{name:"download",width:"16px"})]),default:n(()=>[r(" 匯出CSV ")]),_:1},8,["disabled"]),a(b,{status:"small2",class:"me-2",disabled:e(i).selectedRowKeys.length===0,onClick:t[0]||(t[0]=o=>h.value=!0)},{icon:n(()=>[a(d,{name:"delete",width:"16px"})]),default:n(()=>[r(" 永久刪除 ")]),_:1},8,["disabled"])]),a(xe,{ref_key:"filterKeywordInputRef",ref:R,modelValue:e(l).keyword,"onUpdate:modelValue":t[10]||(t[10]=o=>e(l).keyword=o),class:"w-440px h-40px",placeholder:"搜尋門號、姓名、公司、通訊地址、Email、備註",onClearFilter:t[11]||(t[11]=()=>{l.value={...e(l),phone:"",name:"",group:[],company:"",createTime:void 0,updateTime:void 0,keyword:"",blackList:void 0}})},{filterForm:n(()=>[a(oe,{ref_key:"formRef",ref:z,layout:"vertical",model:e(l),autocomplete:"off"},{default:n(()=>[a(ae,{gutter:[16,12]},{default:n(()=>[a(c,{span:24},{default:n(()=>[a(v,{label:"手機門號",valueed:e(l).phone},{default:n(()=>[a(T,{value:e(l).phone,"onUpdate:value":t[1]||(t[1]=o=>e(l).phone=o)},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(v,{label:"姓名",valueed:e(l).name},{default:n(()=>[a(T,{value:e(l).name,"onUpdate:value":t[2]||(t[2]=o=>e(l).name=o)},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(v,{id:"group",label:"群組標籤",valueed:e(_e)(e(l).group)},{default:n(()=>[a(P,{value:e(l).group,"onUpdate:value":t[4]||(t[4]=o=>e(l).group=o),options:e(M),"max-tag-count":2,"show-arrow":!0,"show-search":!1,mode:"multiple",class:"w-full"},{dropdownRender:n(({menuNode:o})=>[a(ee,{modelValue:e(l).group,"onUpdate:modelValue":t[3]||(t[3]=u=>e(l).group=u),menu:o,options:e(M)},null,8,["modelValue","menu","options"])]),option:n(({value:o,label:u})=>[a(te,{values:e(l).group,value:o,label:u},null,8,["values","value","label"])]),_:1},8,["value","options"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(v,{label:"黑名單",valueed:e(ve)(e(l).blackList,e(Y))},{default:n(()=>[a(P,{value:e(l).blackList,"onUpdate:value":t[5]||(t[5]=o=>e(l).blackList=o),options:e(Y),"max-tag-count":2,"show-arrow":!0,"show-search":!1,class:"w-full"},null,8,["value","options"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(v,{label:"公司名稱",valueed:e(l).company},{default:n(()=>[a(T,{value:e(l).company,"onUpdate:value":t[6]||(t[6]=o=>e(l).company=o),name:"company"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(v,{label:"建立時間",valueed:e(l).createTime},{default:n(()=>[a(U,{value:e(l).createTime,"onUpdate:value":t[7]||(t[7]=o=>e(l).createTime=o),class:"w-full",placement:"topLeft",format:"YYYY-MM-DD","value-format":"YYYY/MM/DD"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(v,{label:"修改時間",valueed:e(l).updateTime},{default:n(()=>[a(U,{value:e(l).updateTime,"onUpdate:value":t[8]||(t[8]=o=>e(l).updateTime=o),class:"w-full",placement:"topLeft",format:"YYYY-MM-DD","value-format":"YYYY/MM/DD"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24,class:"text-center"},{default:n(()=>[a(b,{status:"small2",class:"me-5",onClick:t[9]||(t[9]=o=>{var u;return(u=e(R))==null?void 0:u.hide()})},{default:n(()=>[r(" 取消 ")]),_:1}),a(b,{status:"small1",onClick:H},{default:n(()=>[r(" 確定 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),a(se,{"data-source":e(L),columns:N,scroll:{x:1500},size:"small","show-sorter-tooltip":!1,"row-selection":{selectedRowKeys:e(i).selectedRowKeys,onChange:j},pagination:{...e(_)},onChange:A,onChangePagination:q},{headerCell:n(({column:o})=>[o.key==="isBlackList"?(m(),y(g,{key:0},[p("span",Oe,f(o.title),1),a(ne,{placement:"top","get-popup-container":Z},{title:n(()=>[Fe]),default:n(()=>[p("a",Be,[a(d,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1})],64)):w("",!0)]),bodyCell:n(({column:o,record:u,text:I})=>[o.dataIndex==="group"?(m(),Ke(le,{key:0,chips:u.group,"max-count":3},null,8,["chips"])):w("",!0),o.dataIndex==="phone"?(m(),y(g,{key:1},[r(f(u.countryCode)+f(u.phone),1)],64)):w("",!0),o.dataIndex==="contact"?(m(),y(g,{key:2},[r(f(u.areaCode)+f(u.contact),1)],64)):w("",!0),o.dataIndex==="gender"?(m(),y(g,{key:3},[r(f(e(ge)[I]),1)],64)):w("",!0),o.dataIndex==="isBlackList"?(m(),y(g,{key:4},[r(f(I?"黑名單":""),1)],64)):w("",!0),o.dataIndex==="note"?(m(),y(g,{key:5},[r(f(e(ke)(I)?"-":I),1)],64)):w("",!0)]),_:1},8,["data-source","row-selection","pagination"]),a(K,{open:e(h),"onUpdate:open":t[12]||(t[12]=o=>V(h)?h.value=o:null),centered:"",title:"是否永久刪除選取的聯絡人？",width:"440px","cancel-text":"取消","ok-text":"確定",onOk:W},{default:n(()=>[Se]),_:1},8,["open"]),a(K,{open:e(C),"onUpdate:open":t[13]||(t[13]=o=>V(C)?C.value=o:null),centered:"",title:"是否覆蓋現有的聯絡人？",width:"440px","cancel-text":"取消","ok-text":"確定",onOk:Q},{default:n(()=>[$e]),_:1},8,["open"])],64)}}});export{et as _};
