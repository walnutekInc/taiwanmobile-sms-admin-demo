import{F as ae,_ as se}from"./request-2a151a2a.js";import{_ as oe}from"./index-2459c927.js";import{_ as ne}from"./index.vuevuetypescriptsetuptruelang-6de7385f.js";import{k as le,_ as re}from"./index-b73c7166.js";import{u as ie}from"./group-label-03435c95.js";import{E as L,H as ue,Q as de,r as ce,u as me,F as pe,I as _e,G as fe}from"./antd-100bd80b.js";import{d as ye,r as K,f as y,D as ve,o as ke,u as t,a0 as O,W as c,X as v,_ as S,k as s,$ as o,G as d,E as ge,a4 as Y,Y as _,F as $,a3 as h,H as we}from"./vue-b9a22f97.js";const xe={class:"flex justify-between px-2 items-center mb-2"},be={key:1},Ce={key:1},he={key:0},Te={class:"editable-cell-wrapper"},Re={class:"text-sms-status-alert-red text-xs"},Ye={key:1,class:"editable-cell-wrapper"},De=_("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"},[d(" 您選擇的訊息類別將永久刪除。"),_("br"),d(" 原本屬於該訊息類別的自訂訊息，"),_("br"),d(" 將改為未分類狀態。 ")],-1),Ne=ye({__name:"group-label",setup(Me){const{getGroupLabels:N,groupLabels:g,pagination:V,updateGroupLabel:E,deleteGroupLabel:G}=ie(),r=K({}),D=y(!1);ve(async()=>{w()}),ke(()=>{D.value=!0});const U=[{title:"訊息類別",dataIndex:"categoryName",key:"categoryName",sorter:!0,width:"320px"},{title:"訊息數量",dataIndex:"smsCount",key:"smsCount",sorter:!0,width:"160px",align:"right"},{title:"建立時間",dataIndex:"createTime",key:"createTime",defaultSortOrder:"descend",sorter:!0,width:"160px"},{title:"修改時間",dataIndex:"updateTime",key:"updateTime",sorter:!0}],m=K({selectedRowKeys:[],selectedRows:[],loading:!1}),B=(a,e)=>{console.log("selectedRowKeys changed: ",a,e),m.selectedRowKeys=a,m.selectedRows=e},l=y({sortField:"createTime",sortOrder:"descend",createTime:[void 0,void 0],updateTime:[void 0,void 0],keyword:"",keys:[]}),j=y(),w=async(a=1,e=10)=>{let u={current:a,pageSize:e,...t(l)};await N(u)},P=a=>{r[a]={...ue(g.value.filter(e=>a===e.key)[0]),msg:""}},M=async a=>{var p;const e=r[a];if(L(e.name)){r[a].msg="請輸入群組標籤";return}g.value.find(f=>e.name===f.name&&e.key!==f.key)?r[a].msg=`系統中已有「${r[a].name}」，請勿重複新增`:((p=(await E(e.key,e.name)).data)==null?void 0:p.status)==="success"&&(Object.assign(g.value.filter(x=>a===x.key)[0],e),delete r[a],F.success({message:"群組標籤編輯成功",placement:"top"}))},z=async(a,e,u)=>{console.log("pagination:",a,"sorter:",u),l.value=Object.assign(l.value,{sortField:u.field,sortOrder:u.order}),await w(a.current,a.pageSize)},T=y(null),H=()=>{var a;w(1),(a=T.value)==null||a.hide()},F=le(),k=y(!1),q=()=>{k.value=!0},A=async()=>{var e;((e=(await G(m.selectedRowKeys)).data)==null?void 0:e.status)==="success"&&(F.success({message:"群組標籤刪除成功",placement:"top"}),k.value=!1,m.selectedRowKeys=[],m.selectedRows=[])},I=y(null);return(a,e)=>{const u=re,p=ne,f=de,x=oe,R=ce,Q=me,W=pe,X=O("RouterLink"),J=_e,Z=se,ee=O("SmsCategoryCreate"),te=fe;return c(),v($,null,[t(D)?(c(),S(ge,{key:0,to:"#extraContent"},[s(p,{status:"small1",onClick:e[0]||(e[0]=i=>{var n;return(n=t(I))==null?void 0:n.show()})},{icon:o(()=>[s(u,{name:"plus",width:"16px"})]),default:o(()=>[d("新增類別訊息 ")]),_:1})])):Y("",!0),_("div",xe,[_("div",null,[s(p,{status:"small2",class:"me-2",onClick:q,disabled:t(m).selectedRowKeys.length===0},{icon:o(()=>[s(u,{name:"delete",width:"16px"})]),default:o(()=>[d("刪除 ")]),_:1},8,["disabled"])]),s(ae,{ref_key:"filterKeywordInputRef",ref:T,class:"w-440px h-40px",modelValue:t(l).keyword,"onUpdate:modelValue":e[4]||(e[4]=i=>t(l).keyword=i),placeholder:"搜尋訊息類別",onClearFilter:e[5]||(e[5]=()=>{l.value={...t(l),keyword:"",createTime:[void 0,void 0],updateTime:[void 0,void 0]}})},{filterForm:o(()=>[s(W,{ref_key:"formRef",ref:j,layout:"vertical",model:t(l),autocomplete:"off"},{default:o(()=>[s(Q,{gutter:[16,12]},{default:o(()=>[s(R,{span:24},{default:o(()=>[s(x,{label:"建立時間",valueed:t(l).createTime},{default:o(()=>[s(f,{class:"w-full",value:t(l).createTime,"onUpdate:value":e[1]||(e[1]=i=>t(l).createTime=i),placement:"topLeft",format:"YYYY-MM-DD",valueFormat:"YYYY/MM/DD"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),s(R,{span:24},{default:o(()=>[s(x,{label:"修改時間",valueed:t(l).updateTime},{default:o(()=>[s(f,{class:"w-full",value:t(l).updateTime,"onUpdate:value":e[2]||(e[2]=i=>t(l).updateTime=i),placement:"topLeft",format:"YYYY-MM-DD",valueFormat:"YYYY/MM/DD"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),s(R,{span:24,class:"text-center"},{default:o(()=>[s(p,{status:"small2",class:"me-5",onClick:e[3]||(e[3]=i=>{var n;return(n=t(T))==null?void 0:n.hide()})},{default:o(()=>[d("取消")]),_:1}),s(p,{status:"small1",onClick:H},{default:o(()=>[d("確定")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),s(Z,{dataSource:t(g),columns:U,size:"small",showSorterTooltip:!1,"row-selection":{selectedRowKeys:t(m).selectedRowKeys,onChange:B},onChange:z,pagination:{...t(V)}},{bodyCell:o(({column:i,record:n,text:b})=>[i.dataIndex==="smsCount"?(c(),v($,{key:0},[b>0?(c(),S(X,{key:0,href:"javascript:;",class:"text-sm text-sms-primary-blue-80 underline underline-2 underline-sms-primary-blue-80 font-400",hover:"text-sms-primary-blue-80 underline underline-2 underline-sms-primary-blue-80",to:{name:"CustomMessage",query:{tabActived:"customMessage",categoryId:n.key}}},{default:o(()=>[d(h(b),1)]),_:2},1032,["to"])):(c(),v("span",be,h(b),1))],64)):Y("",!0),i.dataIndex==="name"?(c(),v("div",Ce,[t(r)[n.key]?(c(),v("div",he,[_("div",Te,[s(J,{value:t(r)[n.key].name,"onUpdate:value":C=>t(r)[n.key].name=C,onPressEnter:C=>M(n.key),maxLength:15,status:t(r)[n.key].msg&&!t(L)(t(r)[n.key].msg)?"error":""},null,8,["value","onUpdate:value","onPressEnter","status"]),s(u,{name:"save",onClick:C=>M(n.key),class:"ms-1 text-sms-primary-blue-80 cursor-pointer"},null,8,["onClick"])]),_("span",Re,h(t(r)[n.key].msg),1)])):(c(),v("div",Ye,[d(h(b||" ")+" ",1),s(u,{name:"edit",onClick:C=>P(n.key),class:"ms-1 text-sms-primary-blue-80 cursor-pointer"},null,8,["onClick"])]))])):Y("",!0)]),_:1},8,["dataSource","row-selection","pagination"]),s(ee,{ref_key:"smsCategoryCreateRef",ref:I,"save-callbck":()=>w(1)},null,8,["save-callbck"]),s(te,{open:t(k),"onUpdate:open":e[6]||(e[6]=i=>we(k)?k.value=i:null),title:"是否刪除選取的訊息類別？",centered:"",cancelText:"取消",okText:"確定",onOk:A,width:"440px"},{default:o(()=>[De]),_:1},8,["open"])],64)}}});export{Ne as default};
