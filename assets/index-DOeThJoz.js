import{_ as oe}from"./index.vuevuetypescriptsetuptruelang-CpV2Q3zl.js";import{d as F,W as u,X as _,Y as e,Q as v,u as s,a4 as C,f as w,D as ae,_ as ne,$ as t,k as n,G as k,F as S,a9 as j,a5 as $,a3 as D,y as re}from"./vue-Ckfa8DnP.js";import{j as le,_ as ie}from"./index-CNmZJk7P.js";import{u as ce,F as me}from"./request-DR2_mUfI.js";import{_ as pe}from"./index.vuevuetypescriptsetuptruelang-CEVcljDz.js";import{_ as de}from"./index-C7ceqcuR.js";import{i as ue}from"./isToday-Cu6tVeGL.js";import{E as _e,c as G,G as fe,H as o,q as he,p as ge,I as Ye,J as ye,s as xe,F as De,K as Me,N as ve}from"./antd-DX4Bdc1P.js";import{g as ke,a as z}from"./tools-a0gbWjD6.js";import"./context-ByeIy66j.js";const we="/taiwanmobile-sms-admin-demo/assets/active-message-DLmXlPTI.png",be={class:"flex max-h-530px 2xl:max-h-720px"},Te={class:"w-1/2 bg-sms-grayscale-0 rounded-3 px-4 me-6"},Ce={class:"h-400px 2xl:h-590px overflow-y-auto message-content"},Ee={class:"w-1/2 p-4 bg-sms-grayscale-0 rounded-3 px-4"},Se={key:0,class:"h-full w-full flex items-center justify-center"},$e={class:"text-center"},Re=["src"],Be={class:"font-400 text-base text-sms-grayscale-80"},Le={key:2,id:"message-content",class:"h-400px 2xl:h-590px overflow-y-auto message-content"},He=F({name:"MessageContainer",__name:"index",props:{showRightEmpty:{type:Boolean,default:!1}},setup(i){return(l,g)=>(u(),_("div",be,[e("div",Te,[v(l.$slots,"leftTop"),e("div",Ce,[v(l.$slots,"left")]),v(l.$slots,"leftBottom")]),e("div",Ee,[i.showRightEmpty?(u(),_("div",Se,[e("div",$e,[e("img",{src:s(we),class:"w-80px mb-4"},null,8,Re),e("p",Be,[v(l.$slots,"rightEmptyMessage")])])])):C("",!0),i.showRightEmpty?C("",!0):v(l.$slots,"rightTop",{key:1}),i.showRightEmpty?C("",!0):(u(),_("div",Le,[v(l.$slots,"right")])),i.showRightEmpty?C("",!0):v(l.$slots,"rightBottom",{key:3})])]))}});var O={exports:{}};(function(i,l){(function(g,d){i.exports=d()})(G,function(){return function(g,d){d.prototype.isSameOrBefore=function(Y,y){return this.isSame(Y,y)||this.isBefore(Y,y)}}})})(O);var je=O.exports;const Ne=_e(je);var Ue={exports:{}};(function(i,l){(function(g,d){i.exports=d(fe)})(G,function(g){function d(c){return c&&typeof c=="object"&&"default"in c?c:{default:c}}var Y=d(g),y={name:"zh-tw",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"週日_週一_週二_週三_週四_週五_週六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(c,f){return f==="W"?c+"週":c+"日"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日dddd HH:mm",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s內",past:"%s前",s:"幾秒",m:"1 分鐘",mm:"%d 分鐘",h:"1 小時",hh:"%d 小時",d:"1 天",dd:"%d 天",M:"1 個月",MM:"%d 個月",y:"1 年",yy:"%d 年"},meridiem:function(c,f){var h=100*c+f;return h<600?"凌晨":h<900?"早上":h<1100?"上午":h<1300?"中午":h<1800?"下午":"晚上"}};return Y.default.locale(y,null,!0),y})})(Ue);o.locale("zh-tw");var N=(i=>(i.READ="已讀",i.UNREAD="未讀",i))(N||{});const ze=[{key:"1",phone:"0963-123-123",content:"您好，我想索取試用品DM和序號",unreadCount:0,createTime:o().format("YYYY/MM/DD"),updateTime:o().format("YYYY/MM/DD")},{key:"2",phone:"0928-391-699",content:"請問活動截止日期到什麼時候 ?",unreadCount:2,createTime:o().format("YYYY/MM/DD"),updateTime:o().format("YYYY/MM/DD")},{key:"3",phone:"0938-127-498",content:`請問上個月的抽獎結果什麼時候會公佈？
網路上已經看到外洩的名單，但官方似乎沒有正式公告，希望主辦單位可以即時通知我們網路上已經看到外洩的名單，但官方似乎沒有正式公告，希望主辦單位可以即時通知我們網路上已經看到外洩的名單，但官方似乎沒有正式公告，希望主辦單位可以即時通知我們網路上已經看到外洩的名單，但官方似乎沒有正式公告，希望主辦單位可以即時通知我們網路上已經看到外洩的名單，但官方似乎沒有正式公告，希望主辦單位可以即時通知我們`,unreadCount:5,createTime:o().subtract(2,"d").format("YYYY/MM/DD"),updateTime:o().format("YYYY/MM/DD")},{key:"4",phone:"0958-128-815",content:`黃茵茵
huangyiyi@gmail.com`,unreadCount:0,createTime:o().subtract(3,"d").format("YYYY/MM/DD"),updateTime:o().format("YYYY/MM/DD")},{key:"5",phone:"0963-123-123",content:"您好，我想索取試用品DM和序號",unreadCount:0,createTime:o().subtract(4,"d").format("YYYY/MM/DD"),updateTime:o().format("YYYY/MM/DD")},{key:"6",phone:"0937-129-488",content:"我要參加活動，請通知下一步",unreadCount:0,createTime:o().subtract(5,"d").format("YYYY/MM/DD"),updateTime:o().format("YYYY/MM/DD")},{key:"7",phone:"0937-129-488",content:"我要參加活動，請通知下一步",unreadCount:0,createTime:o().subtract(5,"d").format("YYYY/MM/DD"),updateTime:o().format("YYYY/MM/DD")},{key:"8",phone:"0937-129-488",content:"我要參加活動，請通知下一步",unreadCount:0,createTime:o().subtract(5,"d").format("YYYY/MM/DD"),updateTime:o().format("YYYY/MM/DD")},{key:"9",phone:"0937-129-488",content:"我要參加活動，請通知下一步",unreadCount:0,createTime:o().subtract(5,"d").format("YYYY/MM/DD"),updateTime:o().format("YYYY/MM/DD")},{key:"10",phone:"0937-129-488",content:"我要參加活動，請通知下一步",unreadCount:0,createTime:o().subtract(5,"d").format("YYYY/MM/DD"),updateTime:o().format("YYYY/MM/DD")},{key:"11",phone:"0937-129-488",content:"我要參加活動，請通知下一步",unreadCount:0,createTime:o().subtract(5,"d").format("YYYY/MM/DD"),updateTime:o().format("YYYY/MM/DD")}],Fe={[o().format("YYYY/MM/DD (dd)")]:[{key:"1",phone:"0961-238-888",type:"SENT",message:`親愛的會員您好，邀請您參加活動，若想參加請回覆 12:00pm
親愛的會員您好，邀請您參加活動，若想參加請回覆 12:00pm`},{key:"2",phone:"",type:"GET",message:"是的，我想參加活動"},{key:"3",phone:"",type:"GET",message:`何小偉 
 kkk@gmail.com`},{key:"4",phone:"0961-238-888",type:"SENT",message:"您好，請回覆您的姓名與Email"}],今天:[{key:"1",phone:"0961-238-888",type:"SENT",message:`親愛的會員您好，邀請您參加活動，若想參加請回覆 12:00pm
親愛的會員您好，邀請您參加活動，若想參加請回覆 12:00pm`},{key:"2",phone:"",type:"GET",message:"是的，我想參加活動"},{key:"3",phone:"",type:"GET",message:`何小偉 
 kkk@gmail.com`},{key:"4",phone:"0961-238-888",type:"SENT",message:"您好，請回覆您的姓名與Email"}]};function Ge(){const i=le(),{list:l,pagination:g,setResponseList:d}=ce();return{getChatMessages:async f=>{d({total:11,pages:1,current:1,pageSize:10,records:ze})},chatMessages:l,pagination:g,getChatMessageHistory:async f=>(console.log(f),Fe),updateChatMessageUnRead:async f=>{f.unreadCount>0&&(i.updateUnReadCount(0),l.value=l.value.map(h=>({...h,...h.key===f.key&&{unreadCount:0}})))}}}const Oe=e("span",{"text-24px":"","line-height-28px":"","mr-12px":"","mb-0":"","font-700":"","text-sms-grayscale-100":""},"雙向訊息",-1),Ve=e("span",{"text-sm":"","text-sms-primary-blue-80":"","font-400":""},"※不區分帳號是否使用共用門號，只認發送門號全部顯示",-1),Ae={class:"pt-4 flex items-center pb-3"},Ie=["onClick"],Ke={class:"flex flex-col gap-4"},Pe={class:"flex justify-between items-center mb-2"},qe={class:"font-600 text-sm pe-2"},We={key:0,class:"text-xs bg-sms-green-30 px-2 py-1 rounded-2 text-sms-green-80"},Xe={key:1,class:"text-xs bg-sms-light-red-20 px-2 py-1 rounded-2 text-sms-light-red-70"},Je={class:"text-sms-grayscale-60 font-500 text-xs"},Qe={class:"font-400 text-sm text-sms-grayscale-80 tracking-[0.02em] whitespace-pre-wrap line-clamp-2"},Ze={class:"text-end py-4"},et=e("br",null,null,-1),tt={class:"flex justify-between items-center border-b-solid border-b-1 border-b-sms-light-gray-60 pb-4"},st={class:"flex flex-col"},ot=e("span",{class:"font-400 text-sm tracking-[0.02em] pe-2 text-sms-grayscale-80"},"接收門號",-1),at={href:"javascript:;"},nt=e("span",null,"檢視三個月內，與該門號的所有雙向訊息",-1),rt={class:"font-inter font-400 text-base"},lt={href:"javascript:;"},it=e("span",null,"下載三年內，與該門號的雙向訊息紀錄",-1),ct={key:0,id:"chat-message-content",class:"pt-4"},mt={class:"text-center mb-4"},pt={class:"text-sm tracking-[0.02em] text-sms-grayscale-0 bg-sms-grayscale-40 rounded-38px px-2 py-1.5"},dt={class:"text-sms-grayscale-60 text-sm font-400 font-inter text-sm text-right"},ut=e("span",{class:"text-xs font-500 text-sms-grayscale-40"},"08:00",-1),_t={class:"text-end"},wt=F({__name:"index",setup(i){o.extend(ue),o.extend(Ne);const l=w(),g=w(),d=w(),Y=[{value:"READ",label:N.READ},{value:"UNREAD",label:N.UNREAD}],{getChatMessages:y,pagination:c,chatMessages:f,getChatMessageHistory:h,updateChatMessageUnRead:V}=Ge(),R=w(),m=w({keyword:"",status:void 0,phone:"",sendDate:void 0});ae(()=>{B()});async function B(p=1,r=10){const L={current:p,pageSize:r,...s(m)};await y(L)}function A(p,r){B(p,r??10)}function I(){var p;B(1),(p=d.value)==null||p.hide()}async function K(p){l.value=p,await V(p),R.value=await h(p.key),await re();const r=document.getElementById("message-content");r&&(r.scrollTop=r.scrollHeight)}function P(p){const r=o().subtract(3,"month");return p.isBefore(r)||p>=o()}const q=w(["10","20","30","50"]);return(p,r)=>{const L=he,H=de,E=ge,W=Ye,X=ye,b=pe,J=xe,Q=De,Z=me,T=ie,ee=Me,U=ve,te=He,se=oe;return u(),ne(se,{title:"雙向訊息"},{title:t(()=>[Oe,Ve]),default:t(()=>[n(te,{"show-right-empty":!s(l)},{leftTop:t(()=>[e("div",Ae,[n(Z,{ref_key:"filterKeywordInputRef",ref:d,modelValue:s(m).keyword,"onUpdate:modelValue":r[4]||(r[4]=a=>s(m).keyword=a),height:"40px",class:"flex-1 me-2",placeholder:"搜尋訊息內容",onClearFilter:r[5]||(r[5]=()=>{m.value={...s(m),phone:"",status:void 0,sendDate:void 0,keyword:""}})},{filterForm:t(()=>[n(Q,{ref_key:"formRef",ref:g,layout:"vertical",model:s(m),autocomplete:"off"},{default:t(()=>[n(J,{gutter:[16,12]},{default:t(()=>[n(E,{span:24},{default:t(()=>[n(H,{label:"訊息狀態",valueed:s(ke)(s(m).status,Y)},{default:t(()=>[n(L,{value:s(m).status,"onUpdate:value":r[0]||(r[0]=a=>s(m).status=a),options:Y,"max-tag-count":2,"show-arrow":!0,"show-search":!1,class:"w-full"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),n(E,{span:24},{default:t(()=>[n(H,{label:"接收門號",valueed:s(m).phone},{default:t(()=>[n(W,{value:s(m).phone,"onUpdate:value":r[1]||(r[1]=a=>s(m).phone=a)},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),n(E,{span:24},{default:t(()=>[n(H,{label:"訊息發送日期",valueed:s(m).sendDate},{default:t(()=>[n(X,{value:s(m).sendDate,"onUpdate:value":r[2]||(r[2]=a=>s(m).sendDate=a),class:"w-full",placement:"topLeft",format:"YYYY-MM-DD","value-format":"YYYY/MM/DD","disabled-date":P},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),n(E,{span:24,class:"text-center"},{default:t(()=>[n(b,{status:"small2",class:"me-5",onClick:r[3]||(r[3]=a=>{var M;return(M=s(d))==null?void 0:M.hide()})},{default:t(()=>[k(" 取消 ")]),_:1}),n(b,{status:"small1",onClick:I},{default:t(()=>[k(" 確定 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),n(b,{status:"small1"},{icon:t(()=>[n(T,{name:"plus",width:"16px"})]),default:t(()=>[k(" 新增訊息 ")]),_:1})])]),left:t(()=>[e("ul",null,[(u(!0),_(S,null,j(s(f),a=>{var M;return u(),_("li",{key:a.key,class:$(["p-4 border-b-solid border-b-1 border-b-sms-light-gray-60 last:mb-2 cursor-pointer",{"bg-sms-bg-light-mode-gray":a.key===((M=s(l))==null?void 0:M.key)}]),onClick:x=>K(a)},[e("div",Ke,[e("div",Pe,[e("div",null,[e("span",qe,D(a.phone),1),a.unreadCount===0?(u(),_("span",We,"已讀")):(u(),_("span",Xe,"未讀 "+D(a.unreadCount),1))]),e("span",Je,D(s(o)(a.createTime).isToday()?"今天":s(o)(a.createTime).format("YYYY/MM/DD")),1)]),e("div",Qe,D(a.content),1)])],10,Ie)}),128))])]),leftBottom:t(()=>[e("div",Ze,[n(ee,{current:s(c).current,"onUpdate:current":r[6]||(r[6]=a=>s(c).current=a),total:s(c).total,"show-quick-jumper":"","page-size-options":s(q),"show-size-changer":"","show-less-items":"","show-total":a=>`共 ${a} 筆`,onChange:A},null,8,["current","total","page-size-options","show-total"])])]),rightEmptyMessage:t(()=>[k(" 點擊左側接收門號列表"),et,k("檢視雙向訊息 ")]),rightTop:t(()=>{var a;return[e("div",tt,[e("div",st,[e("div",null,[ot,n(U,{placement:"top","get-popup-container":s(z)},{title:t(()=>[nt]),default:t(()=>[e("a",at,[n(T,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),e("div",rt,D((a=s(l))==null?void 0:a.phone),1)]),e("div",null,[n(b,{status:"small2",class:"me-2"},{icon:t(()=>[n(T,{name:"download",width:"16px"})]),default:t(()=>[k(" 下載CSV ")]),_:1}),n(U,{placement:"topRight","get-popup-container":s(z),"merged-arrow":!0},{title:t(()=>[it]),default:t(()=>[e("a",lt,[n(T,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])])])]}),right:t(()=>[s(R)?(u(),_("div",ct,[(u(!0),_(S,null,j(Object.entries(s(R)),([a,M])=>(u(),_(S,{key:a},[e("div",mt,[e("span",pt,D(a),1)]),(u(!0),_(S,null,j(M,x=>(u(),_("div",{key:x.key,class:$(["flex flex-col mb-4",{"me-20 ":x.type==="GET","ms-20 ":x.type==="SENT"}])},[e("div",dt,D(x.phone),1),e("div",{class:$(["flex w-full items-end justify-end gap-2",{"flex-row-reverse ":x.type==="GET"}])},[ut,e("div",{class:$(["bg-sms-grayscale-20 py-3 px-3 rounded-2 whitespace-pre-wrap text-17px",{"bg-sms-primary-blue-20":x.type==="SENT"}])},D(x.message),3)],2)],2))),128))],64))),128))])):C("",!0)]),rightBottom:t(()=>[e("div",_t,[n(b,{status:"small1"},{icon:t(()=>[n(T,{name:"edit",width:"16px"})]),default:t(()=>[k(" 回覆訊息 ")]),_:1})])]),_:1},8,["show-right-empty"])]),_:1})}}});export{wt as default};
