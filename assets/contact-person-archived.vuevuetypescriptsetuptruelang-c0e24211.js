import{G as ae,_ as oe,a as ne}from"./GenderEnum-f913b5f9.js";import{_ as se}from"./index.vuevuetypescriptsetuptruelang-f9131e6d.js";import{_ as le}from"./index-45b7c432.js";import{u as de,a as re}from"./contact-person-cd61a293.js";import{o as ie,y as ce,I as pe,p as ue,r as me,z as _e,q as fe,F as xe,E as ye,G as he,H as ge}from"./antd-f113dc14.js";import{d as we,f as w,D as ke,o as ve,r as be,u as a,V as f,W as x,X as c,k as o,_ as n,G as d,a2 as i,F as y,a3 as h,Z as Ce,H as U}from"./vue-6193fd76.js";const Ie={class:"flex justify-between px-2 items-center mb-2"},Te={class:"ms-2 ant-select-suffix"},Re={class:"me-1"},Me={href:"javascript:;"},Oe=c("span",null,"全域黑名單功能: 主帳號將特定手機門號加入黑名單，主帳號和子帳號皆無法發送該門號任何訊息",-1),Ue=c("div",{class:"h-78px px-20px py-24px"},[c("p",{class:"text-center text-sms-grayscale-80"},"您選擇的聯絡人將直接永久刪除。")],-1),De=c("div",{class:"h-78px px-20px py-24px"},[c("p",{class:"text-center text-sms-grayscale-80"},"聯絡人列表中，已經存在相同的聯絡人。")],-1),Ke=we({__name:"contact-person-archived",props:{toContactPerson:{type:Function,required:!0}},setup(D){const F=D,{contactPerson:P,pagination:I,getContactPersonArchived:B,deleteContactPerson:L,unArchivedContactPerson:S}=de(),{getGroupLabelOption:V,groupOptions:K}=re(),Y=w(!1);ke(async()=>{C(),await V()}),ve(()=>{Y.value=!0});const E=[{title:"手機門號",dataIndex:"phone",key:"phone",sorter:!0,fixed:"left",width:"130px"},{title:"姓名",dataIndex:"name",key:"name",sorter:!0,fixed:"left",width:"80px"},{title:"群組標籤",dataIndex:"group",key:"group",fixed:"left",width:"250px"},{title:"性別",dataIndex:"gender",key:"gender",sorter:!0,width:"70px"},{title:"黑名單",dataIndex:"isBlackList",key:"isBlackList",sorter:!0,width:"100px"},{title:"聯絡電話",dataIndex:"contact",key:"contact",sorter:!0,width:"110px"},{title:"公司名稱",dataIndex:"company",key:"company",sorter:!0,ellipsis:!0,width:"121px"},{title:"Email",dataIndex:"email",key:"email",sorter:!0,ellipsis:!0,width:"184px"},{title:"生日",dataIndex:"birth",key:"birth",sorter:!0,width:"95px"},{title:"通訊地址",dataIndex:"address",key:"address",sorter:!0,ellipsis:!0,width:"108px"},{title:"備註",dataIndex:"note",key:"note",sorter:!0,width:"108px"},{title:"建立時間",dataIndex:"createTime",key:"createTime",defaultSortOrder:"descend",sorter:!0,width:"140px"},{title:"修改時間",dataIndex:"updateTime",key:"updateTime",sorter:!0,width:"140px"}],p=be({selectedRowKeys:[],selectedRows:[],loading:!1}),G=(r,t)=>{console.log("selectedRowKeys changed: ",r,t),p.selectedRowKeys=r,p.selectedRows=t},s=w({sortField:"createTime",sortOrder:"descend",phone:"",name:"",group:[],company:"",createTime:[void 0,void 0],updateTime:[void 0,void 0],keyword:""}),T=w(),C=async(r=1,t=10)=>{var u,g;let l={current:r,pageSize:t,...a(s),group:((g=(u=s.value)==null?void 0:u.group)==null?void 0:g.map(m=>m.id))??[]};await B(l)},$=async(r,t,l)=>{console.log("pagination:",r,"sorter:",l),s.value=Object.assign({sortField:l.field,sortOrder:l.order}),await C(r.current,r.pageSize)},R=w(!1),A=()=>{R.value=!0},N=()=>{R.value=!1,C(1)},k=w(!1),j=async()=>{var t;((t=(await L(p.selectedRows.map(l=>l.key))).data)==null?void 0:t.status)==="success"&&(k.value=!1)},v=w(!1),z=()=>{v.value=!0},q=async()=>{var t;((t=(await S(p.selectedRowKeys)).data)==null?void 0:t.status)==="success"&&F.toContactPerson()},H=()=>{q()};return(r,t)=>{const l=le,u=se,g=pe,m=ue,W=me,M=_e,X=fe,Z=xe,J=oe,Q=ye,ee=ne,te=he,O=ge;return f(),x(y,null,[c("div",Ie,[c("div",null,[o(u,{status:"small2",class:"me-2",disabled:a(p).selectedRowKeys.length===0,onClick:z},{icon:n(()=>[o(l,{name:"change",width:"16px"})]),default:n(()=>[d("回復聯絡人 ")]),_:1},8,["disabled"]),o(u,{status:"small2",class:"me-2",disabled:a(p).selectedRowKeys.length===0},{icon:n(()=>[o(l,{name:"download",width:"16px"})]),default:n(()=>[d("匯出CSV ")]),_:1},8,["disabled"]),o(u,{status:"small2",class:"me-2",onClick:t[0]||(t[0]=e=>k.value=!0),disabled:a(p).selectedRowKeys.length===0},{icon:n(()=>[o(l,{name:"delete",width:"16px"})]),default:n(()=>[d("永久刪除 ")]),_:1},8,["disabled"])]),o(J,{class:"w-440px h-40px",modelValue:a(s).keyword,"onUpdate:modelValue":t[7]||(t[7]=e=>a(s).keyword=e),onClick:A,placeholder:"搜尋門號、姓名、公司、通訊地址、Email、備註",onClearFilter:t[8]||(t[8]=()=>{var e;a(s).keyword="",(e=a(T))==null||e.resetFields()})},{filterForm:n(()=>[o(Z,{ref_key:"formRef",ref:T,layout:"vertical",model:a(s),wrapperCol:{span:24},autocomplete:"off"},{default:n(()=>[o(m,{name:"phone",label:"手機門號",class:"mb-2"},{default:n(()=>[o(g,{placeholder:"手機門號",value:a(s).phone,"onUpdate:value":t[1]||(t[1]=e=>a(s).phone=e),name:"phone",class:"rounded-2"},null,8,["value"])]),_:1}),o(m,{name:"name",label:"姓名",class:"mb-2"},{default:n(()=>[o(g,{placeholder:"姓名",value:a(s).name,"onUpdate:value":t[2]||(t[2]=e=>a(s).name=e),class:"rounded-2"},null,8,["value"])]),_:1}),o(m,{name:"group",label:"群組標籤",class:"mb-2"},{default:n(()=>[o(W,{placeholder:"群組標籤",options:a(K),maxTagCount:2,showArrow:!0,mode:"tags",value:a(s).group,"onUpdate:value":t[3]||(t[3]=e=>a(s).group=e),class:"w-full ant-select-filter"},{menuItemSelectedIcon:n(()=>[d(i(""))]),suffixIcon:n(()=>{var e,_;return[c("div",Te,[d(i(((e=a(s).group)==null?void 0:e.length)>0?`已選擇(${(_=a(s).group)==null?void 0:_.length})`:"")+" ",1),o(a(ie))])]}),_:1},8,["options","value"])]),_:1}),o(m,{name:"company",label:"公司名稱",class:"mb-2"},{default:n(()=>[o(g,{placeholder:"公司名稱",value:a(s).company,"onUpdate:value":t[4]||(t[4]=e=>a(s).company=e),class:"rounded-2"},null,8,["value"])]),_:1}),o(m,{name:"createTime",label:"建立時間",class:"mb-2"},{default:n(()=>[o(M,{class:"w-full",placeholder:["建立時間","建立時間"],value:a(s).createTime,"onUpdate:value":t[5]||(t[5]=e=>a(s).createTime=e),placement:"topLeft",format:"YYYY-MM-DD"},null,8,["value"])]),_:1}),o(m,{name:"updateTime",label:"修改時間",class:"mb-2"},{default:n(()=>[o(M,{class:"w-full",placeholder:["修改時間","修改時間"],value:a(s).updateTime,"onUpdate:value":t[6]||(t[6]=e=>a(s).updateTime=e),placement:"topLeft",format:"YYYY-MM-DD"},null,8,["value"])]),_:1}),o(X,{class:"text-center"},{default:n(()=>[o(u,{status:"small2",class:"me-5"},{default:n(()=>[d("取消")]),_:1}),o(u,{status:"small1",onClick:N},{default:n(()=>[d("確定")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),o(te,{dataSource:a(P),columns:E,scroll:{x:1500},size:"small",showSorterTooltip:!1,"row-selection":{selectedRowKeys:a(p).selectedRowKeys,onChange:G},onChange:$,pagination:{...a(I),showTotal:e=>`${a(I).countRange}筆 / ${e}筆`}},{headerCell:n(({column:e})=>[e.key==="isBlackList"?(f(),x(y,{key:0},[c("span",Re,i(e.title),1),o(Q,{placement:"top"},{title:n(()=>[Oe]),default:n(()=>[c("a",Me,[o(l,{name:"union"})])]),_:1})],64)):h("",!0)]),bodyCell:n(({column:e,record:_,text:b})=>[e.dataIndex==="group"?(f(),Ce(ee,{key:0,chips:_.group,"max-count":3},null,8,["chips"])):h("",!0),e.dataIndex==="phone"?(f(),x(y,{key:1},[d(i(_.countryCode)+i(_.phone),1)],64)):h("",!0),e.dataIndex==="contact"?(f(),x(y,{key:2},[d(i(_.areaCode)+i(_.contact),1)],64)):h("",!0),e.dataIndex==="gender"?(f(),x(y,{key:3},[d(i(a(ae)[b]),1)],64)):h("",!0),e.dataIndex==="isBlackList"?(f(),x(y,{key:4},[d(i(b?"黑名單":""),1)],64)):h("",!0),e.dataIndex==="note"?(f(),x(y,{key:5},[d(i(a(ce)(b)?"-":b),1)],64)):h("",!0)]),_:1},8,["dataSource","row-selection","pagination"]),o(O,{open:a(k),"onUpdate:open":t[9]||(t[9]=e=>U(k)?k.value=e:null),centered:"",title:"是否永久刪除選取的聯絡人？",cancelText:"取消",okText:"確定",onOk:j},{default:n(()=>[Ue]),_:1},8,["open"]),o(O,{open:a(v),"onUpdate:open":t[10]||(t[10]=e=>U(v)?v.value=e:null),centered:"",title:"是否覆蓋現有的聯絡人？",cancelText:"取消",okText:"確定",onOk:H},{default:n(()=>[De]),_:1},8,["open"])],64)}}});export{Ke as _};
