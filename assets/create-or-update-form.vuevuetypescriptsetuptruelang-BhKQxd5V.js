import{M as Mt,b as Tt,_ as kt,c as wt}from"./MessageTypeEnum-DMSeJ8ko.js";import{u as Ct,_ as Rt,a as Pt,b as It,c as Ot,d as At}from"./route-leave-BM1GkG1j.js";import{_ as Gt}from"./index.vuevuetypescriptsetuptruelang-DSiX2Owk.js";import{j as jt,k as Et,_ as Lt}from"./index-SyJk22Nu.js";import{d as Ae,r as ge,f as y,c as Ce,W as b,_ as te,$ as n,Y as o,k as t,u as e,ah as Ke,X as E,F as X,G as r,a3 as h,a4 as me,H as ve,ac as Ft,ad as Nt,z as qe,o as Bt,w as Ht,m as ue,ab as V,B as Wt,a9 as Pe,A as pe,a7 as Ut,a5 as de,y as ze,ag as Ye,l as qt}from"./vue-BvWPEeCa.js";import{z as Ge,E as ee,U as Ze,V as Qe,K as zt,N as k,O as Yt,P as Ve,Q as De,H as Vt,I as Dt,o as Kt,p as Zt,q as Qt,y as $t,W as Jt,T as Xt,x as es,J as ts,r as ss,s as as,F as ns}from"./antd-x_nIKmzG.js";import{i as os}from"./isToday-b1DZ_jHd.js";import{_ as $e}from"./index.vuevuetypestyleindex0lang-DE_vMFqr.js";import{_ as Je,u as is}from"./request-hqIn3XrK.js";import{u as ls}from"./contact-person-DlOWdw-G.js";import{u as Xe}from"./group-label-6nP2gAMT.js";import{u as rs,r as Ie}from"./custom-message-BhUkYmr2.js";import{b as W}from"./tools-DuR4KSGu.js";const cs={class:"px-24px"},us=Ae({__name:"select-contact",props:{formState:{}},emits:["updateFormState"],setup(S,{expose:A,emit:U}){const D=S,F=U,_=ge({selectedRowKeys:[],selectedRows:[],loading:!1}),{contactPerson:q,getAllContactPerson:T,pagination:d}=ls(),K=[{title:"手機門號",dataIndex:"phone",key:"phone",width:"110px"},{title:"姓名",dataIndex:"name",key:"name",width:"110px"},{title:"黑名單",dataIndex:"isBlackList",key:"isBlackList",width:"110px"},{title:"備註",dataIndex:"note",key:"note",width:"110px"}],g=y({keyword:"",sortField:"createTime",sortOrder:"descend"}),Z=Ce(()=>{const u=(d.value.current-1)*d.value.pageSize;return q.value.slice(u,d.value.current*d.value.pageSize)});async function Q(u,p){d.value={...d.value,current:u,pageSize:p}}async function N(u=1,p=10){const B={current:u,pageSize:p,...e(g)};await T(B,_.selectedRowKeys)}function se(u){console.log("selectedRowKeys changed: ",u),_.selectedRowKeys=u}const w=y(!1);async function ae(u){_.selectedRowKeys=u,N(),w.value=!0}function v(){w.value=!1,F("updateFormState",{recipients:{...D.formState.recipients,contactPerson:_.selectedRowKeys}})}return A({show:ae}),(u,p)=>{const B=Je,j=$e,O=Ge;return b(),te(O,{open:e(w),"onUpdate:open":p[2]||(p[2]=C=>ve(w)?w.value=C:null),title:"選擇聯絡人",centered:"","cancel-text":"取消","ok-text":"確定",width:"600px",onOk:v},{default:n(()=>[o("div",cs,[t(B,{modelValue:e(g).keyword,"onUpdate:modelValue":p[0]||(p[0]=C=>e(g).keyword=C),"show-filter-btn":!1,placeholder:"搜尋聯絡人",class:"mb-2",onKeydown:p[1]||(p[1]=Ke(C=>N(1,e(d).pageSize),["enter"]))},null,8,["modelValue"]),t(j,{class:"modal-table","data-source":e(Z),columns:K,"show-sorter-tooltip":!1,"row-selection":{selectedRowKeys:e(_).selectedRowKeys,onChange:se,preserveSelectedRowKeys:!0},pagination:{...e(d)},onChangePagination:Q},{bodyCell:n(({column:C,text:$})=>[C.dataIndex==="isBlackList"?(b(),E(X,{key:0},[r(h($?"黑名單":""),1)],64)):me("",!0)]),_:1},8,["data-source","row-selection","pagination"])])]),_:1},8,["open"])}}}),ps={class:"px-24px"},ds=Ae({__name:"select-group",props:{formState:{}},emits:["updateFormState"],setup(S,{expose:A,emit:U}){const D=S,F=U,_=ge({selectedRowKeys:[],selectedRows:[],loading:!1}),{groupLabels:q,getAllGroupLabel:T,pagination:d}=Xe(),K=[{title:"群組標籤名稱",dataIndex:"name",key:"name",width:"145px"},{title:"門號數量",dataIndex:"phoneCount",key:"phoneCount",width:"145px"},{title:"黑名單數量",dataIndex:"blackListCount",key:"blackListCount",width:"145px"}],g=y({keyword:"",sortField:"createTime",sortOrder:"descend"}),Z=Ce(()=>{const u=(d.value.current-1)*d.value.pageSize;return q.value.slice(u,d.value.current*d.value.pageSize)});async function Q(u,p){d.value={...d.value,current:u,pageSize:p}}async function N(u=1,p=10){const B={current:u,pageSize:p,...e(g)};await T(B,_.selectedRowKeys)}function se(u,p){console.log("selectedRowKeys changed: ",u),_.selectedRowKeys=u,_.selectedRows=p}const w=y(!1);async function ae(u){_.selectedRowKeys=u.map(p=>p.id),N(),w.value=!0}function v(){w.value=!1,F("updateFormState",{recipients:{...D.formState.recipients,group:_.selectedRows.map(u=>({id:u.key,label:u.name}))}})}return A({show:ae}),(u,p)=>{const B=Je,j=$e,O=Ge;return b(),te(O,{open:e(w),"onUpdate:open":p[2]||(p[2]=C=>ve(w)?w.value=C:null),title:"選擇群組標籤",centered:"","cancel-text":"取消","ok-text":"確定",width:"600px",onOk:v},{default:n(()=>[o("div",ps,[t(B,{modelValue:e(g).keyword,"onUpdate:modelValue":p[0]||(p[0]=C=>e(g).keyword=C),"show-filter-btn":!1,placeholder:"搜尋群組標籤",class:"mb-2",onKeydown:p[1]||(p[1]=Ke(C=>N(1,e(d).pageSize),["enter"]))},null,8,["modelValue"]),t(j,{class:"modal-table","data-source":e(Z),columns:K,"show-sorter-tooltip":!1,"row-selection":{selectedRowKeys:e(_).selectedRowKeys,onChange:se,preserveSelectedRowKeys:!0},pagination:{...e(d)},onChangePagination:Q},null,8,["data-source","row-selection","pagination"])])]),_:1},8,["open"])}}});var fe=(S=>(S.SMS_General="SMS 一般訊息",S.MMS_General="MMS 一般訊息",S.SMS_Parameter="SMS 參數訊息",S.MMS_Parameter="MMS 參數訊息",S))(fe||{});const ms=[{key:"1",name:"季末大促銷",messageType:"MMS",subject:"主旨",phone:"0961-238-888",content:"愛戀情人節，獨家驚喜等您發現！ 情人節將至，愛戀之情將再次升華！我們特別為您準備了一場浪漫的情人節限定活動，帶來一系列獨家驚喜等您發現。無論您是想要為您的另一半挑選一份特別的禮物，還是希望一起度過浪漫的夜晚，我們都有豐富的選擇和活動等待著您。讓我們一同創造美好的回憶，共度這個充滿愛意的情人節！",multimediaFile:[{url:"https://s3-alpha-sig.figma.com/img/58f4/3909/125235a1ee58204239489f870005010a?Expires=1717977600&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=gOnAZsvJJ3b-I8sDdPUZz2M03-LWdip1MAOY8cgGFjWBZhYz1zxMj6qSYX7RM707p1mclCcqgDWufaoNo1qGRjYa19cFiea54hrW0HPeyvEdeBK2rGlqx0niWpRt~IIv6GhZRnIzlORt~SwYevBIgIpvAiWfygrf0oQBycyaB5e8bkhVUmcDqICGOI1OEhGso2Uqo6jRjMHZ0eJtPVljHG9cS3-L1CZb0ixM3n-XA~fPeoMHDiC~MWU8jLLfT6QkT3vIxuInHO-FHYdeO7eO3n1WnJ5-vTchGX--lfMfQE-mm~0bt3Qs2vnogGAE2rcutsZ7h55efUgRpqkCGvX3fg__",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"},{url:"https://s3-alpha-sig.figma.com/img/9d0c/f052/d64cc2f579c81a1b00818f7276fc7b70?Expires=1717977600&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=Dv2V0i8lTHSCdlvQogFN9PU-AbUW2c9iSbPYw1cVYT9u1nKovLLuvSGVoTPBF7KzhiKP5LCO1Jf1d5NyXEVIVdlAfHaSVJnUAJg4I2NFiXBh1u4VqPr2T~BCpNoBIGzjrpSXfPQAPqxAxQgcakZwTfU6zTMYuSNDuxCGXkHr-MLsXzYWU6xO2H-Mxb2KL-w1pjkAdFoH4ZAiYMbYbf4tsV85LAQJ3Wi-0mI8LtW25KZDRH~HuLjCPs6uEzQ87aKP7BD3tvCCL0CMp-qtXqNYwSlKawA~JANedV3H93kfppw3ov5NOjU8gaQRLQuCamZqB3cK-zbNTaQckxLqE0KA~g__",fileName:"invitation_username.jpg",size:86400,key:"2",fileSize:"",file:void 0,type:"image"},{url:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",fileName:"BigBuckBunny.mp4",size:86400,key:"2",fileSize:"",file:void 0,type:"video"}],recipients:{contactPerson:["1","2"],group:[{id:"1",label:"群組A"}],manual:"0912345678,0912345678",file:void 0},sendTimeType:"RESERVATION",reservationTime:"2024/02/14 17:30",effectiveTime:""},{key:"2",name:"9月壽星活動",messageType:"SMS",phone:"0961-238-888",content:"慶祝9月壽星 %field1%，特別優惠等你來享！ 九月生日的朋友們，這個月是您獨特的時刻！為了慶祝您的生日，我們特別準備了一系列令人驚喜的優惠和禮物。無論您是想要一項特別的折扣、額外的積分還是免費的驚喜禮物，我們都會在您的生日月份為您提供。請加入我們，一起慶祝這個特別的時刻，讓我們為您的生日帶來更多的歡樂和驚喜！",multimediaFile:[{url:"https://s3-alpha-sig.figma.com/img/58f4/3909/125235a1ee58204239489f870005010a?Expires=1717977600&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=gOnAZsvJJ3b-I8sDdPUZz2M03-LWdip1MAOY8cgGFjWBZhYz1zxMj6qSYX7RM707p1mclCcqgDWufaoNo1qGRjYa19cFiea54hrW0HPeyvEdeBK2rGlqx0niWpRt~IIv6GhZRnIzlORt~SwYevBIgIpvAiWfygrf0oQBycyaB5e8bkhVUmcDqICGOI1OEhGso2Uqo6jRjMHZ0eJtPVljHG9cS3-L1CZb0ixM3n-XA~fPeoMHDiC~MWU8jLLfT6QkT3vIxuInHO-FHYdeO7eO3n1WnJ5-vTchGX--lfMfQE-mm~0bt3Qs2vnogGAE2rcutsZ7h55efUgRpqkCGvX3fg__",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"}],recipients:{contactPerson:["1","2"],group:[{id:"1",label:"群組A"}],manual:"0912345678,0912345678",file:void 0},subject:"",sendTimeType:"RESERVATION",reservationTime:"2024/02/14 17:30",effectiveTime:""}],Oe=[{key:"1",name:"季末大促銷",account:"taiwan_media_00",sendNumber:"AJ593749G2",sendStatus:"RESERVATION",messageType:"MMS",phone:"0961-238-888",content:"愛戀情人節，獨家驚喜等您發現！ 情人節將至，愛戀之情將再次升華！我們特別為您準備了一場浪漫的情人節限定活動，帶來一系列獨家驚喜等您發現。無論您是想要為您的另一半挑選一份特別的禮物，還是希望一起度過浪漫的夜晚，我們都有豐富的選擇和活動等待著您。讓我們一同創造美好的回憶，共度這個充滿愛意的情人節！",multimediaFile:[{url:"https://s3-alpha-sig.figma.com/img/58f4/3909/125235a1ee58204239489f870005010a?Expires=1717977600&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=gOnAZsvJJ3b-I8sDdPUZz2M03-LWdip1MAOY8cgGFjWBZhYz1zxMj6qSYX7RM707p1mclCcqgDWufaoNo1qGRjYa19cFiea54hrW0HPeyvEdeBK2rGlqx0niWpRt~IIv6GhZRnIzlORt~SwYevBIgIpvAiWfygrf0oQBycyaB5e8bkhVUmcDqICGOI1OEhGso2Uqo6jRjMHZ0eJtPVljHG9cS3-L1CZb0ixM3n-XA~fPeoMHDiC~MWU8jLLfT6QkT3vIxuInHO-FHYdeO7eO3n1WnJ5-vTchGX--lfMfQE-mm~0bt3Qs2vnogGAE2rcutsZ7h55efUgRpqkCGvX3fg__",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"},{url:"https://s3-alpha-sig.figma.com/img/9d0c/f052/d64cc2f579c81a1b00818f7276fc7b70?Expires=1717977600&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=Dv2V0i8lTHSCdlvQogFN9PU-AbUW2c9iSbPYw1cVYT9u1nKovLLuvSGVoTPBF7KzhiKP5LCO1Jf1d5NyXEVIVdlAfHaSVJnUAJg4I2NFiXBh1u4VqPr2T~BCpNoBIGzjrpSXfPQAPqxAxQgcakZwTfU6zTMYuSNDuxCGXkHr-MLsXzYWU6xO2H-Mxb2KL-w1pjkAdFoH4ZAiYMbYbf4tsV85LAQJ3Wi-0mI8LtW25KZDRH~HuLjCPs6uEzQ87aKP7BD3tvCCL0CMp-qtXqNYwSlKawA~JANedV3H93kfppw3ov5NOjU8gaQRLQuCamZqB3cK-zbNTaQckxLqE0KA~g__",fileName:"invitation_username.jpg",size:86400,key:"2",fileSize:"",file:void 0,type:"image"},{url:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",fileName:"BigBuckBunny.mp4",size:86400,key:"2",fileSize:"",file:void 0,type:"video"}],isParameter:!1,statistics:{total:0,sending:0,success:0,fail:0,successRate:0},sendTime:"2024/10/28 17:30",createTime:"2024/10/28 17:30",updateTime:"2024/10/28 17:30"},{key:"2",name:"9月壽星活動",account:"taiwan_media_00",sendNumber:"AJ593749G2",sendStatus:"EXECUTING",messageType:"SMS",phone:"0961-238-888",content:"慶祝9月壽星 %field1%，特別優惠等你來享！ 九月生日的朋友們，這個月是您獨特的時刻！為了慶祝您的生日，我們特別準備了一系列令人驚喜的優惠和禮物。無論您是想要一項特別的折扣、額外的積分還是免費的驚喜禮物，我們都會在您的生日月份為您提供。請加入我們，一起慶祝這個特別的時刻，讓我們為您的生日帶來更多的歡樂和驚喜！",multimediaFile:[{url:"https://s3-alpha-sig.figma.com/img/58f4/3909/125235a1ee58204239489f870005010a?Expires=1717977600&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=gOnAZsvJJ3b-I8sDdPUZz2M03-LWdip1MAOY8cgGFjWBZhYz1zxMj6qSYX7RM707p1mclCcqgDWufaoNo1qGRjYa19cFiea54hrW0HPeyvEdeBK2rGlqx0niWpRt~IIv6GhZRnIzlORt~SwYevBIgIpvAiWfygrf0oQBycyaB5e8bkhVUmcDqICGOI1OEhGso2Uqo6jRjMHZ0eJtPVljHG9cS3-L1CZb0ixM3n-XA~fPeoMHDiC~MWU8jLLfT6QkT3vIxuInHO-FHYdeO7eO3n1WnJ5-vTchGX--lfMfQE-mm~0bt3Qs2vnogGAE2rcutsZ7h55efUgRpqkCGvX3fg__",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"}],isParameter:!1,statistics:{total:0,sending:0,success:0,fail:0,successRate:0},sendTime:ee().format("YYYY/MM/DD HH:mm"),createTime:"2024/10/28 17:30",updateTime:"2024/10/28 17:30"},{key:"3",name:"季末大促銷季末大促銷季末大促銷季末大促銷季末大促銷季末大促銷",account:"taiwan_media_00",sendNumber:"AJ593749G2",sendStatus:"EXECUTING",messageType:"MMS",phone:"0961-238-888",content:"愛戀情人節，獨家驚喜等您發現！ 情人節將至，愛戀之情將再次升華！我們特別為您準備了一場浪漫的情人節限定活動，帶來一系列獨家驚喜等您發現。無論您是想要為您的另一半挑選一份特別的禮物，還是希望一起度過浪漫的夜晚，我們都有豐富的選擇和活動等待著您。讓我們一同創造美好的回憶，共度這個充滿愛意的情人節！",multimediaFile:[{url:"https://s3-alpha-sig.figma.com/img/58f4/3909/125235a1ee58204239489f870005010a?Expires=1717977600&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=gOnAZsvJJ3b-I8sDdPUZz2M03-LWdip1MAOY8cgGFjWBZhYz1zxMj6qSYX7RM707p1mclCcqgDWufaoNo1qGRjYa19cFiea54hrW0HPeyvEdeBK2rGlqx0niWpRt~IIv6GhZRnIzlORt~SwYevBIgIpvAiWfygrf0oQBycyaB5e8bkhVUmcDqICGOI1OEhGso2Uqo6jRjMHZ0eJtPVljHG9cS3-L1CZb0ixM3n-XA~fPeoMHDiC~MWU8jLLfT6QkT3vIxuInHO-FHYdeO7eO3n1WnJ5-vTchGX--lfMfQE-mm~0bt3Qs2vnogGAE2rcutsZ7h55efUgRpqkCGvX3fg__",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"}],isParameter:!0,statistics:{total:0,sending:0,success:0,fail:0,successRate:0},sendTime:"2024/02/14 17:30",createTime:"2024/10/28 17:30",updateTime:"2024/10/28 17:30"},{key:"4",name:"週年慶",account:"taiwan_media_00",sendNumber:"AJ593749G2",sendStatus:"IS_SENT",messageType:"MMS",phone:"0961-238-888",content:`準備好享受驚人的優惠和特別禮遇，因為我們正在慶祝週年紀念！ 不要錯過這場盛會 - 來店內或線上參加，盡情享受您最喜愛的產品的驚人折扣！這些週年慶特惠不會持續太久！立即購物，讓這個慶典變得難忘！
提供您專屬折扣碼：%field1%
有限期限至：%field2%`,multimediaFile:[{url:"https://s3-alpha-sig.figma.com/img/58f4/3909/125235a1ee58204239489f870005010a?Expires=1717977600&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=gOnAZsvJJ3b-I8sDdPUZz2M03-LWdip1MAOY8cgGFjWBZhYz1zxMj6qSYX7RM707p1mclCcqgDWufaoNo1qGRjYa19cFiea54hrW0HPeyvEdeBK2rGlqx0niWpRt~IIv6GhZRnIzlORt~SwYevBIgIpvAiWfygrf0oQBycyaB5e8bkhVUmcDqICGOI1OEhGso2Uqo6jRjMHZ0eJtPVljHG9cS3-L1CZb0ixM3n-XA~fPeoMHDiC~MWU8jLLfT6QkT3vIxuInHO-FHYdeO7eO3n1WnJ5-vTchGX--lfMfQE-mm~0bt3Qs2vnogGAE2rcutsZ7h55efUgRpqkCGvX3fg__",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"}],isParameter:!0,statistics:{total:0,sending:0,success:0,fail:0,successRate:0},sendTime:"2024/02/01 17:30",createTime:"2024/10/28 17:30",updateTime:"2024/10/28 17:30"},{key:"5",name:"聖誕佳節",account:"taiwan_media_00",sendNumber:"AJ593749G2",sendStatus:"RESERVATION_FAILED",messageType:"SMS",phone:"0961-238-888",content:"聖誕節大促銷來啦！快來店裡或線上參加我們的節慶活動，享受驚喜禮遇！找尋最適合送給親朋好友的禮物，一起度過溫馨愉快的節日時光！敬請期待我們的特別優惠，讓您的聖誕更加美好！",multimediaFile:[{url:"https://s3-alpha-sig.figma.com/img/58f4/3909/125235a1ee58204239489f870005010a?Expires=1717977600&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=gOnAZsvJJ3b-I8sDdPUZz2M03-LWdip1MAOY8cgGFjWBZhYz1zxMj6qSYX7RM707p1mclCcqgDWufaoNo1qGRjYa19cFiea54hrW0HPeyvEdeBK2rGlqx0niWpRt~IIv6GhZRnIzlORt~SwYevBIgIpvAiWfygrf0oQBycyaB5e8bkhVUmcDqICGOI1OEhGso2Uqo6jRjMHZ0eJtPVljHG9cS3-L1CZb0ixM3n-XA~fPeoMHDiC~MWU8jLLfT6QkT3vIxuInHO-FHYdeO7eO3n1WnJ5-vTchGX--lfMfQE-mm~0bt3Qs2vnogGAE2rcutsZ7h55efUgRpqkCGvX3fg__",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"}],isParameter:!0,statistics:{total:0,sending:0,success:0,fail:0,successRate:0},sendTime:"2023/12/20 17:30",createTime:"2024/10/28 17:30",updateTime:"2024/10/28 17:30"}];function fs(){const{list:S,pagination:A,setResponseList:U}=is(),D=async v=>{U({total:11,pages:1,current:1,pageSize:10,records:Oe})},F=y(),_=async v=>{const u=Oe.find(p=>p.key===v);return F.value=u,{data:{...u}}},q=async v=>({data:{status:"success",id:"1"}}),T=async(v,u)=>({data:{status:"success",id:"1"}}),d=v=>({data:{fileName:v.name,url:window.URL.createObjectURL(v)}}),K=async v=>({data:{...ms.find(p=>p.key===v)}}),g=async v=>({data:{}}),Z=async v=>({data:{status:"success",id:"1"}}),Q=async(v,u)=>({data:{status:"success",id:"1"}}),N=y([{label:"不設定(預設)",value:""},{label:"1 小時",value:"1 小時"},{label:"2 小時",value:"2 小時"},{label:"3 小時",value:"3 小時"},{label:"4 小時",value:"4 小時"},{label:"5 小時",value:"5 小時"},{label:"6 小時",value:"6 小時"},{label:"7 小時",value:"7 小時"},{label:"8 小時",value:"8 小時"}]);return{getMessageSendings:D,messageSendings:S,pagination:A,createGeneralMessageSending:q,updateGeneralMessageSending:T,messageSending:F,getMessageSending:_,getGeneralMessageSendingById:K,uploadBatchRecipientsExcel:d,effectiveTimeOption:N,getActiveStatusLabel:(v,u)=>v==="MMS"?u?fe.MMS_Parameter:fe.MMS_General:u?fe.SMS_Parameter:fe.SMS_General,checkMessageSendingDetail:async v=>({data:{...v,isParameter:!1,price:5,recipientsCount:6208,isBlackListCount:12,estimatedTotalAmount:31400,estimatedRemainingAmount:-3580,totalLongMessages:3}}),checkMessageSendingNameExist:async(v,u)=>{const p=Ze(Oe,{name:v});return p?!(!Qe(u)&&p.key===u):!1},getParameterMessageSending:g,createParameterMessageSending:Z,updateParameterMessageSending:Q}}var et=(S=>(S.NOW="現在",S.RESERVATION="預約",S))(et||{});const gs=o("span",{class:"pe-.5"},"活動名稱",-1),vs=o("span",{class:"text-red-500 pe-2"},"*",-1),_s={href:"javascript:;"},ys=o("span",{class:"pe-.5"},"接收門號",-1),xs=o("span",{class:"text-red-500 pe-2"},"*",-1),hs={href:"javascript:;"},bs=o("br",null,null,-1),Ss=o("br",null,null,-1),Ms=o("br",null,null,-1),Ts=o("br",null,null,-1),ks=o("br",null,null,-1),ws={class:"text-sm text-sms-secondary-dark-blue-100 font-400"},Cs=o("div",{class:"ant-form-item-extra"}," 若有多筆門號，使用 “ , ” 隔開，例如：0911111222,0922123456,0933987654 ",-1),Rs={href:"javascript:;",class:"underline underline-offset-2 text-sms-primary-blue-80 text-sm line-height-14px py-1"},Ps={href:"javascript:;",class:"underline underline-offset-2 text-sms-primary-blue-80 text-sm line-height-14px py-1"},Is=o("span",{class:"pe-.5"},"訊息類型",-1),Os=o("span",{class:"text-red-500 pe-2"},"*",-1),As={href:"javascript:;"},Gs=o("br",null,null,-1),js={class:"flex gap-2 overflow-y-auto h-95px"},Es={class:"text-sms-grayscale-60 text-xs font-500 font-sans text-center break-words"},Ls=o("span",{class:"pe-.5"},"發送時間",-1),Fs=o("span",{class:"text-red-500 pe-2"},"*",-1),Ns={href:"javascript:;"},Bs=o("span",{class:"pe-.5"},"有效時間",-1),Hs=o("span",{class:"text-red-500 pe-2"},"*",-1),Ws={href:"javascript:;"},Us={key:0,id:"confirmDetail",class:"px-32px"},qs=o("div",{class:"mb-4"},[o("h2",{class:"font-500 text-22px text-sms-secondary-dark-blue-100"}," 內容確認 "),o("p",{class:"text-sm text-sms-grayscale-80"}," 若有使用縮網址功能，請在發送訊息前再次確認短網址有效性，平台不會檢驗短網址有效性 ")],-1),zs={class:"border border-solid border-sms-light-gray-60 p-16px pb-24px rounded-12px mb-2"},Ys=o("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 活動名稱 ",-1),Vs={class:"text-base font-400 text-sms-grayscale-100"},Ds=o("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 發送時間 ",-1),Ks={key:0,class:"text-base font-400 text-sms-grayscale-100"},Zs=o("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 訊息類型 ",-1),Qs={class:"text-base font-400 text-sms-grayscale-100"},$s=o("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 發送門號 ",-1),Js={class:"text-base font-400 text-sms-grayscale-100"},Xs=o("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 訊息總數 (長訊息) ",-1),ea={class:"text-base font-400 text-sms-grayscale-100"},ta=o("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 單價 ",-1),sa={class:"text-base font-400 text-sms-grayscale-100"},aa={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},na={href:"javascript:;"},oa={class:"text-base font-400 text-sms-grayscale-100"},ia=o("span",{class:"text-sms-grayscale-60 text-sm"}," (非最終數量)",-1),la={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},ra={href:"javascript:;"},ca={class:"text-base font-400 text-sms-grayscale-100"},ua=o("span",{class:"text-sms-grayscale-60 text-sm"}," (非最終數量)",-1),pa={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},da={href:"javascript:;"},ma=o("br",null,null,-1),fa={class:"text-base font-400 text-sms-grayscale-100"},ga={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},va={href:"javascript:;"},_a=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"}," 刪除的檔案將無法復原 ",-1),ya=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"},[r(" 您編輯過的內容將全部清空 "),o("br"),o("p",null,[r(" 提醒您，SMS支援的字數較MMS少，"),o("br"),r(" 且不能上傳多媒體附件 ")])],-1),xa=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"},[o("p",{class:"text-base text-center text-sms-gary-80"},[r(" 正確的格式範例 "),o("a",{class:"text-sms-primary-blue-80 ms-1 underline underline-offset-2",href:"",download:""},"點擊此處下載")])],-1),Ga=Ae({__name:"create-or-update-form",props:{isCreate:{type:Boolean,default:!1},id:{},editCallback:{},showPreview:{type:Boolean,default:!0}},setup(S){const A=S;ee.extend(os);const{setHideAlert:U,setShowAlert:D}=Ct(),F=jt(),_=Ft(),q=Nt(),T=qe(A,"isCreate"),d=qe(A,"id"),{replaceFieldToHtml:K}=rs(),g=y(),{updateGeneralMessageSending:Z,getGeneralMessageSendingById:Q,createGeneralMessageSending:N,uploadBatchRecipientsExcel:se,effectiveTimeOption:w,getActiveStatusLabel:ae,checkMessageSendingDetail:v,checkMessageSendingNameExist:u}=fs(),{getGroupLabelOption:p,groupOptions:B}=Xe(),j=y("");let O={name:"",phone:void 0,recipients:{contactPerson:[],group:[],manual:"",file:void 0},messageType:"SMS",subject:"",multimediaFile:[],sendTimeType:"NOW",content:"",effectiveTime:"",reservationTime:""};const C=[{label:"0935-111-111",value:"0935-111-111"},{label:"0947-127-998",value:"0947-127-998"},{label:"0958-892-006",value:"0958-892-006"}],$=y("ContactPerson"),_e=y(!1),a=ge(zt(O)),ye=Ce(()=>a.messageType==="SMS"?335:1e3),tt=ge({name:[{async validator(i,s){return k(s)?Promise.reject("請輸入活動名稱"):await u(s,d.value)?Promise.reject("此活動名稱已存在，請重新命名 "):Promise.resolve()},trigger:"blur"}],phone:[{required:!0,message:"請選擇發送門號",trigger:"blur"}],subject:[{async validator(i,s){return a.messageType==="MMS"&&k(s)?Promise.reject("請輸入訊息主旨"):Promise.resolve()},trigger:"blur"}],recipients:[{async validator(i){if(k(a.recipients.contactPerson)&&k(a.recipients.group)&&k(a.recipients.manual)&&Qe(a.recipients.file))return Promise.reject("至少 1 個接收門號");if(k(a.recipients.manual)){const s=a.recipients.manual.split(",").length,c=a.recipients.contactPerson.length,m=a.recipients.group.length;if(s+c+m>5e4)return Promise.reject("總接收門號數不可超過 5萬筆")}else if(!/^09[0-9]{8}(,09[0-9]{8})*$/.test(a.recipients.manual))return $.value="ManualInput",Promise.reject("格式錯誤");return Promise.resolve()},trigger:"blur"}],content:[{async validator(i,s){var c;return k(s)?Promise.reject("請輸入訊息內容"):!k(s)&&((c=a.content)==null?void 0:c.replace(Ie,"").length)>ye.value?Promise.reject(`限制輸入 ${ye.value} 字以內`):Promise.resolve()},trigger:"blur"}],reservationTime:[{async validator(i,s){if(a.sendTimeType==="RESERVATION"){if(k(s))return Promise.reject("請選擇預約日期或現在發送");if(ee().diff(ee(s),"minute")>0)return Promise.reject("閒置過久，請重新選擇預約時間")}return Promise.resolve()},trigger:"blur"}]}),{validateInfos:z,validate:st,resetFields:at}=Yt(a,tt);Bt(async()=>{var i,s,c,m,Y,R,f,L,P,J,he,be,re,ce,Se,Me,Te,ne,ke,we;if(await p(),j.value=ee().format("YYYY/MM/DD_HH:mm"),!T.value&&d.value){const H=await Q(d.value);H.data&&(g.value=H.data,O={name:((i=g.value)==null?void 0:i.name)??e(j),phone:((s=g.value)==null?void 0:s.phone)??void 0,recipients:{contactPerson:((m=(c=g.value)==null?void 0:c.recipients)==null?void 0:m.contactPerson)??[],group:((R=(Y=g.value)==null?void 0:Y.recipients)==null?void 0:R.group)??[],manual:((L=(f=g.value)==null?void 0:f.recipients)==null?void 0:L.manual)??"",file:((J=(P=g.value)==null?void 0:P.recipients)==null?void 0:J.file)??void 0},messageType:((he=g.value)==null?void 0:he.messageType)??"SMS",subject:((be=g.value)==null?void 0:be.subject)??"",multimediaFile:((re=g.value)==null?void 0:re.multimediaFile)??[],sendTimeType:((ce=g.value)==null?void 0:ce.sendTimeType)??"NOW",content:((Se=g.value)==null?void 0:Se.content)??"",effectiveTime:((Me=g.value)==null?void 0:Me.effectiveTime)??"",reservationTime:((Te=g.value)==null?void 0:Te.reservationTime)??""})}else{if((ne=_.query)!=null&&ne.isRe){j.value=`RE_${j.value}`;const H=(ke=_.query)!=null&&ke.rePhone?_.query.rePhone:void 0,l=(we=_.query)!=null&&we.recipientsPhone?_.query.recipientsPhone:void 0;H&&(O.phone=H),l&&(Ze(C,{value:l})?O.recipients.contactPerson=[l]:($.value="ManualInput",O.recipients.manual=l))}O.name=e(j)}at(O)}),Ht(()=>a,i=>{const s=Ve(i,O);T.value&&!d.value&&(s?U():D())},{deep:!0});const x=y(null);function nt(){st().then(async()=>{const i=await v(a);if(i.data){x.value=i.data,_e.value=!0,await ze();const s=document.getElementById("app");s&&(s.scrollTop=0)}}).catch(i=>{console.log(i)})}async function ot(){var c,m,Y,R;const s=await(e(T)?N:Z)(a,d.value);if(((c=s.data)==null?void 0:c.status)==="success")if(T.value&&!d.value)if(U(),(m=_.query)!=null&&m.isRe&&((Y=_.query)!=null&&Y.rePhone)&&((R=_.query)!=null&&R.recipientsPhone)){const{post:f,close:L}=Ye({name:"in-chat-message-page"});f(s.data.id),L(),window.close()}else F.success({message:"訊息新增成功",placement:"top"}),q.push("/sms-marketing/message-sending").then(()=>{setTimeout(()=>{var P;const{post:f,close:L}=Ye({name:"in-message-sending-page"});f((P=s.data)==null?void 0:P.id),L()},800)});else A.editCallback&&A.editCallback(!0,d.value),F.success({message:"訊息編輯成功",placement:"top"})}const je=y(null);function Ee(i){a.content=K(i)}const it=y(null);function lt(i){for(const s of i)a.content=`${a.content}<span>${s}</span>`}const Le=y(null);function rt(i){a.content=`${a.content}<a href="${i}">${i}</a>`}const Fe=y(null),ct=Ce(()=>{const i=[];if((!k(a.content)||!k(a.subject))&&i.push({phone:a.phone,content:a.content,...a.messageType==="MMS"&&{subject:a.subject},messageType:"SENT",contentType:"text"}),!k(a.multimediaFile))for(const s of a.multimediaFile)i.push({phone:a.phone,content:s.url,messageType:"SENT",contentType:s.type});return i.map((s,c)=>({...s,key:c}))}),Ne=y(null);function ut(i){a.multimediaFile=i}const oe=ge({open:!1});function pt(i){Object.assign(oe,{open:!0,delFile:i})}function dt(){a.multimediaFile=a.multimediaFile.filter(i=>{var s;return i.url!==((s=oe.delFile)==null?void 0:s.url)}),Object.assign(oe,{open:!1,delFile:void 0})}const ie=y(!1);function mt(){a.messageType==="SMS"?!k(a.content)||!k(a.multimediaFile)?ie.value=!0:a.messageType="SMS":a.messageType="MMS"}const Be=y(null),He=y(null);function We(i){Object.assign(a,i)}const le=y(!1),xe=y();async function ft(i){const c=i.target.files;try{if(c.length>0){const m=await se(c[0]);a.recipients.file=m.data,le.value=!0}}catch(m){console.log(m)}finally{xe.value&&(xe.value.value="")}}const gt=Et();function vt(){gt.confirm({title:"是否取消上傳檔案？",icon:t("span"),content:qt("div",{innerHTML:"該檔案將取消上傳",class:"text-center px-30px py-20px w-328px text-base mx-auto"}),width:"400px",centered:!0,closable:!0,async onOk(){a.recipients.file=void 0}})}const Ue=ee();function _t(i){const s=Ue.add(1,"year");return i&&(i<Ue||i>=s)}function yt(i){if(i&&i.isToday()){const s=ee().add(5,"minute"),c=s.hour(),m=s.minute();return{disabledHours:()=>De(0,24).slice(0,c),disabledMinutes:()=>De(0,60).slice(0,m)}}return{}}function xt(){const i=Ve(a,O);A.editCallback&&A.editCallback(i)}function ht(){T.value&&!d.value?q.push("/sms-marketing/message-sending"):xt()}const Re=y("responsive");function bt(i){a.recipients.group=a.recipients.group.filter(s=>s.id!==i)}async function St(i){const m=i.target.value.replace(/[^\d|,]/g,"");await ze(),a.recipients.manual=m}return(i,s)=>{const c=Lt,m=Vt,Y=Dt,R=Kt,f=Zt,L=Qt,P=Gt,J=$t,he=Jt,be=Xt,re=es,ce=ts,Se=kt,Me=At,Te=ss,ne=as,ke=ns,we=wt,H=Ge;return b(),E(X,null,[t(ne,{class:de(["bg-sms-grayscale-0 rounded-4",{"p-10 pl-1":e(T)&&!e(d)}]),wrap:!1},{default:n(()=>[t(f,{flex:"auto"},{default:n(()=>[ue(t(ke,{class:"px-32px",layout:"vertical",autocomplete:"off",onSubmit:nt},{default:n(()=>[t(ne,{gutter:[16,14]},{default:n(()=>[t(f,{span:24},{default:n(()=>[t(R,V(e(z).name,{"html-for":""}),{label:n(()=>[gs,vs,t(m,{placement:"top","get-popup-container":e(W)},{title:n(()=>[r(" 活動名稱可使用系統預設或自行輸入，但不可重複 ")]),default:n(()=>[o("a",_s,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:n(()=>[t(Y,{value:e(a).name,"onUpdate:value":s[0]||(s[0]=l=>e(a).name=l),placeholder:"請輸入文字",maxlength:30,onFocus:s[1]||(s[1]=()=>{e(a).name===e(j)&&(e(a).name="")}),onBlur:s[2]||(s[2]=()=>{e(a).name===""&&(e(a).name=e(j))})},null,8,["value"])]),_:1},16)]),_:1}),t(f,{span:24},{default:n(()=>[t(R,V(e(z).phone,{label:"發送門號",required:""}),{default:n(()=>[t(L,{value:e(a).phone,"onUpdate:value":s[3]||(s[3]=l=>e(a).phone=l),options:C,"allow-clear":"",placeholder:"請選擇發送門號"},null,8,["value"])]),_:1},16)]),_:1}),t(f,{span:24},{default:n(()=>[t(R,V({"html-for":""},e(z).recipients),{label:n(()=>[ys,xs,t(m,{"overlay-inner-style":{width:"315px"},placement:"top","get-popup-container":e(W)},{title:n(()=>[r(" 4 種方式增加接收門號 ，且可混合使用(總上限5萬筆)："),bs,r(" 1. 從名單管理匯入聯絡人"),Ss,r(" 2. 從名單管理匯入群組標籤"),Ms,r(" 3. 直接輸入接收門號"),Ts,r(" 4. Excel 快速上傳門號"),ks]),default:n(()=>[o("a",hs,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:n(()=>[t(be,{activeKey:e($),"onUpdate:activeKey":s[10]||(s[10]=l=>ve($)?$.value=l:null),size:"small",class:"full-border-tab",type:"card","destroy-inactive-tab-pane":!0},{default:n(()=>[t(J,{key:"ContactPerson",tab:"聯絡人"},{default:n(()=>[t(P,{status:"small2",class:"me-2",onClick:s[4]||(s[4]=l=>{var M,I;return(I=e(Be))==null?void 0:I.show(((M=e(a).recipients)==null?void 0:M.contactPerson)??[])})},{icon:n(()=>[t(c,{name:"plus",width:"16px"})]),default:n(()=>[r(" 選擇聯絡人 ")]),_:1}),o("span",ws,"已選擇 "+h(e(a).recipients.contactPerson.length.toLocaleString())+" 筆",1)]),_:1},8,["tab"]),t(J,{key:"GroupLabel",tab:"群組標籤"},{default:n(()=>[e(a).recipients.group.length>0?(b(),te(L,{key:0,class:"mb-2",open:!1,options:e(B),value:e(a).recipients.group.map(l=>l.id),mode:"tags","max-tag-count":e(Re),onDeselect:bt,onBlur:s[6]||(s[6]=l=>Re.value="responsive")},{maxTagPlaceholder:n(l=>[o("span",{href:"javascript:;",onClick:s[5]||(s[5]=Wt(M=>Re.value=void 0,["prevent"]))},[t(c,{name:"plus",width:"12px"}),r(h(l.length)+"...",1)])]),_:1},8,["options","value","max-tag-count"])):me("",!0),t(P,{status:"small2",class:"me-2",onClick:s[7]||(s[7]=l=>{var M;return(M=e(He))==null?void 0:M.show(e(a).recipients.group??[])})},{icon:n(()=>[t(c,{name:"plus",width:"16px"})]),default:n(()=>[r(" 選擇群組標籤 ")]),_:1})]),_:1},8,["tab"]),t(J,{key:"ManualInput",tab:"手動輸入"},{default:n(()=>[t(he,{value:e(a).recipients.manual,"onUpdate:value":s[8]||(s[8]=l=>e(a).recipients.manual=l),placeholder:"請輸入接收門號",rows:6,onInput:St},null,8,["value"]),Cs]),_:1},8,["tab"]),t(J,{key:"FileUpload",tab:"上傳檔案"},{default:n(()=>[e(a).recipients.file?(b(),E(X,{key:1},[o("a",Ps,h(e(a).recipients.file.fileName),1),t(c,{name:"download-circle",width:"16px",class:"mx-2 cursor-pointer"}),t(c,{name:"delete-circle",width:"16px",class:"cursor-pointer",onClick:vt})],64)):(b(),E(X,{key:0},[o("input",{ref_key:"uploadBatchRecipientsFile",ref:xe,type:"file",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",class:"!hidden",onChange:ft},null,544),t(P,{status:"small2",class:"me-2",onClick:s[9]||(s[9]=l=>{var M;return(M=e(xe))==null?void 0:M.click()})},{icon:n(()=>[t(c,{name:"plus",width:"16px"})]),default:n(()=>[r(" 上傳EXCEL ")]),_:1}),o("a",Rs,[t(c,{name:"download",width:"16px"}),r(" 匯出範例 ")])],64))]),_:1},8,["tab"])]),_:1},8,["activeKey"])]),_:1},16)]),_:1}),t(f,{span:24},{default:n(()=>[t(R,V({"html-for":""},e(z).messageType),{label:n(()=>[Is,Os,t(m,{placement:"top","get-popup-container":e(W)},{title:n(()=>[r(" SMS：上限 335 字"),Gs,r(" MMS：上限 1,000 字，可上傳多媒體 ")]),default:n(()=>[o("a",As,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:n(()=>[t(ce,{value:e(a).messageType,"onUpdate:value":s[11]||(s[11]=l=>e(a).messageType=l),onChange:mt},{default:n(()=>[(b(!0),E(X,null,Pe(Object.entries(e(Mt)),([l,M])=>(b(),te(re,{key:l,value:l},{default:n(()=>[r(h(M),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16)]),_:1}),ue(t(f,{span:24},{default:n(()=>[t(R,V({label:"訊息主旨"},e(z).subject,{required:"",extra:"15 字以內"}),{default:n(()=>[t(Y,{value:e(a).subject,"onUpdate:value":s[12]||(s[12]=l=>e(a).subject=l),placeholder:"請輸入訊息主旨",maxlength:15},null,8,["value"])]),_:1},16)]),_:1},512),[[pe,e(a).messageType==="MMS"]]),t(f,{span:24},{default:n(()=>{var l;return[t(R,V({"html-for":"",label:"訊息內容"},e(z).content,{class:"relative",extra:`${e(a).messageType} 上限 ${e(ye).toLocaleString()} 字，目前 ${e(k)(e(a).content)?"--":(l=e(a).content)==null?void 0:l.replace(e(Ie),"").length} 字`}),{default:n(()=>{var M;return[t(Me,{modelValue:e(a).content,"onUpdate:modelValue":s[17]||(s[17]=I=>e(a).content=I),contenteditable:"true",style:{height:"292px"},"content-len":(M=e(a).content)==null?void 0:M.replace(e(Ie),"").length,"max-len":e(ye),placeholder:"請輸入文字"},Ut({default:n(()=>[t(m,null,{title:n(()=>[r(" 載入現有的自訂訊息 ")]),default:n(()=>[t(c,{name:"import",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[13]||(s[13]=I=>{var G;return(G=e(je))==null?void 0:G.show()})})]),_:1}),t(m,null,{title:n(()=>[r(" 增加縮網址 ")]),default:n(()=>[t(c,{name:"link",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[14]||(s[14]=I=>{var G;return(G=e(Le))==null?void 0:G.show()})})]),_:1}),t(m,null,{title:n(()=>[r(" 多媒體附件上傳 ")]),default:n(()=>[ue(t(c,{name:"cloud-upload",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[15]||(s[15]=I=>{var G;return(G=e(Ne))==null?void 0:G.show(e(a).multimediaFile)})},null,512),[[pe,e(a).messageType==="MMS"]])]),_:1}),t(m,null,{title:n(()=>[r(" AI 文字生成訊息 ")]),default:n(()=>[t(c,{name:"AI",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[16]||(s[16]=I=>{var G;return(G=e(Fe))==null?void 0:G.show()})})]),_:1})]),_:2},[e(a).multimediaFile.length>0?{name:"multimediaBlock",fn:n(()=>[o("div",js,[(b(!0),E(X,null,Pe(e(a).multimediaFile,I=>(b(),E("div",{key:I.url,class:"w-90px max-h-60px"},[t(Se,{source:{url:I.url,type:I.type},"show-file-name":!1,"can-play":!1,size:"small","image-class":"object-cover w-full h-full",onDeleteVideo:G=>pt(I)},null,8,["source","onDeleteVideo"]),o("div",Es,h(I.fileName),1)]))),128))])]),key:"0"}:void 0]),1032,["modelValue","content-len","max-len"])]}),_:1},16,["extra"])]}),_:1}),t(f,{span:24,class:"bg-sms-bg-light-mode-gray rounded-md !p-20px"},{default:n(()=>[t(R,V(e(z).reservationTime,{"html-for":"",class:"mb-4"}),{label:n(()=>[Ls,Fs,t(m,{placement:"top","get-popup-container":e(W)},{title:n(()=>[r(" 最快可預約5分鐘之後以及系統當下 1 年內時間，惟實際發送時間以系統排程為主 ")]),default:n(()=>[o("a",Ns,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:n(()=>[t(ce,{value:e(a).sendTimeType,"onUpdate:value":s[18]||(s[18]=l=>e(a).sendTimeType=l)},{default:n(()=>[(b(!0),E(X,null,Pe(Object.entries(e(et)),([l,M])=>(b(),te(re,{key:l,value:l},{default:n(()=>[r(h(M),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),ue(t(Te,{value:e(a).reservationTime,"onUpdate:value":s[19]||(s[19]=l=>e(a).reservationTime=l),format:"YYYY/MM/DD HH:mm","value-format":"YYYY/MM/DD HH:mm","disabled-date":_t,"disabled-time":yt,"show-time":!0,"show-now":!1},null,8,["value"]),[[pe,e(a).sendTimeType==="RESERVATION"]])]),_:1},16),t(R,V(e(z).sendTimeType,{"html-for":""}),{label:n(()=>[Bs,Hs,t(m,{placement:"top","get-popup-container":e(W)},{title:n(()=>[r(" 因接收門號而無法成功送達訊息，會在此設定有效時間內重複嘗試發送 ")]),default:n(()=>[o("a",Ws,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:n(()=>[t(L,{value:e(a).effectiveTime,"onUpdate:value":s[20]||(s[20]=l=>e(a).effectiveTime=l),options:e(w),"list-height":300,placeholder:"請選擇有效時間"},null,8,["value","options"])]),_:1},16)]),_:1}),t(f,{span:24,class:de({"text-end":e(T)&&!e(d),"text-center py-6 ":!e(T)&&e(d)})},{default:n(()=>[t(P,{status:"small2",class:"me-2",onClick:ht},{default:n(()=>[r(" 取消 ")]),_:1}),t(P,{status:"small1","html-type":"submit"},{default:n(()=>[r(" 確定 ")]),_:1})]),_:1},8,["class"])]),_:1})]),_:1},512),[[pe,!e(_e)]]),e(_e)&&e(x)?(b(),E("div",Us,[qs,o("div",zs,[t(ne,{gutter:[16,16]},{default:n(()=>[t(f,{span:24,class:"mb-"},{default:n(()=>[Ys,o("div",Vs,h(e(x).name),1)]),_:1}),t(f,{span:8},{default:n(()=>[Ds,e(x).sendTimeType==="RESERVATION"?(b(),E("div",Ks,h(e(x).reservationTime),1)):(b(),E("div",{key:1,class:de(["text-base font-400 text-sms-grayscale-100",{"text-sms-status-alert-red":Math.sign(e(x).estimatedRemainingAmount)===-1}])}," 現在 ",2))]),_:1}),t(f,{span:8},{default:n(()=>[Zs,o("div",Qs,h(e(ae)(e(x).messageType,e(x).isParameter)),1)]),_:1}),t(f,{span:8},{default:n(()=>[$s,o("div",Js,h(e(x).phone),1)]),_:1}),e(x).messageType==="SMS"?(b(),te(f,{key:0,span:8},{default:n(()=>[Xs,o("div",ea,h(e(x).totalLongMessages),1)]),_:1})):me("",!0),t(f,{span:8},{default:n(()=>[ta,o("div",sa," NT$ "+h(e(x).price),1)]),_:1}),t(f,{span:8},{default:n(()=>[o("div",aa,[r(" 接收門號總數 "),t(m,{placement:"top","get-popup-container":e(W)},{title:n(()=>[r(" 未過濾所有黑名單，發送時會再檢核，最終接收門號數量可能變動 ")]),default:n(()=>[o("a",na,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),o("div",oa,[r(h(e(x).recipientsCount.toLocaleString())+" ",1),ia])]),_:1}),t(f,{span:8},{default:n(()=>[o("div",la,[r(" 黑名單門號總數 "),t(m,{placement:"top","get-popup-container":e(W)},{title:n(()=>[r(" 目前已篩選掉該黑名單數量，發送時會再檢核最新黑名單，最終黑名單門號總數可能變動 ")]),default:n(()=>[o("a",ra,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),o("div",ca,[r(h(e(x).isBlackListCount.toLocaleString())+" ",1),ua])]),_:1}),t(f,{span:8},{default:n(()=>[o("div",pa,[r(" 預估發送總金額 "),t(m,{placement:"top","get-popup-container":e(W),"overlay-inner-style":{width:"397px"}},{title:n(()=>[r(" 發送總金額 = 訊息總數 x ( 接收門號總數 - 黑名單門號總數 ) x 單價"),ma,r(" 參數訊息之訊息總數以一則計算，實際計價以發送字數等於幾則來計價 ")]),default:n(()=>[o("a",da,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),o("div",fa," NT$ "+h(e(x).estimatedTotalAmount.toLocaleString()),1)]),_:1}),t(f,{span:8},{default:n(()=>[o("div",ga,[r(" 預估剩餘金額 "),t(m,{placement:"top","get-popup-container":e(W)},{title:n(()=>[r(" 餘額不足仍可預約，請注意於預約時間前進行儲值才可成功發送訊息 ")]),default:n(()=>[o("a",va,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),o("div",{class:de(["text-base font-400 text-sms-grayscale-100",{"text-sms-status-alert-red":Math.sign(e(x).estimatedRemainingAmount)===-1}])}," NT$ "+h(e(x).estimatedRemainingAmount.toLocaleString()),3)]),_:1})]),_:1})]),o("div",{class:de(["flex items-center justify-end",{"py-4":!e(T)&&e(d)}])},[ue(o("div",{class:"text-sms-status-alert-red text-base me-4"},h(e(x).sendTimeType==="RESERVATION"?"可預約，請於發送時間之前儲值完畢，以免發送失敗":"剩餘金額不足，建議回上一步改成預約發送後再盡快儲值"),513),[[pe,Math.sign(e(x).estimatedRemainingAmount)===-1]]),t(P,{status:"small2",class:"me-2",onClick:s[21]||(s[21]=()=>{_e.value=!1,x.value=null})},{default:n(()=>[r(" 上一步 ")]),_:1}),t(P,{onClick:ot},{default:n(()=>[r(" 確定 ")]),_:1})],2)])):me("",!0)]),_:1}),i.showPreview?(b(),te(f,{key:0,flex:"428px",class:"relative"},{default:n(()=>[t(we,{message:e(ct)},null,8,["message"])]),_:1})):me("",!0)]),_:1},8,["class"]),t(Rt,{ref_key:"importCustomMessageRef",ref:je,content:e(a).content,onUpdateContent:Ee},null,8,["content"]),t(Pt,{ref_key:"addFieldRef",ref:it,onAddFieldToContent:lt},null,512),t(It,{ref_key:"addLinkRef",ref:Le,onAddLinkToContent:rt},null,512),t(Ot,{ref_key:"aiTextGenerationRef",ref:Fe,content:e(a).content,onUpdateContent:Ee},null,8,["content"]),t(Tt,{ref_key:"multimediaUploadRef",ref:Ne,onUpdateMultimediaFile:ut},null,512),t(H,{open:e(oe).open,"onUpdate:open":s[22]||(s[22]=l=>e(oe).open=l),title:"是否刪除已上傳的檔案？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onOk:dt},{default:n(()=>[_a]),_:1},8,["open"]),t(H,{open:e(ie),"onUpdate:open":s[23]||(s[23]=l=>ve(ie)?ie.value=l:null),title:"是否放棄目前編輯的內容？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onCancel:s[24]||(s[24]=l=>e(a).messageType="MMS"),onOk:s[25]||(s[25]=()=>{e(a).content="",e(a).multimediaFile=[],e(a).subject="",ie.value=!1})},{default:n(()=>[ya]),_:1},8,["open"]),t(us,{ref_key:"selectContactRef",ref:Be,"form-state":e(a),onUpdateFormState:We},null,8,["form-state"]),t(ds,{ref_key:"selectGroupRef",ref:He,"form-state":e(a),onUpdateFormState:We},null,8,["form-state"]),t(H,{open:e(le),"onUpdate:open":s[27]||(s[27]=l=>ve(le)?le.value=l:null),title:"資料格式有誤，請重新確認上傳",width:"400px",centered:""},{footer:n(()=>[t(P,{onClick:s[26]||(s[26]=l=>le.value=!1)},{default:n(()=>[r(" 確定 ")]),_:1})]),default:n(()=>[xa]),_:1},8,["open"])],64)}}});export{fe as M,et as S,Ga as _,fs as u};
