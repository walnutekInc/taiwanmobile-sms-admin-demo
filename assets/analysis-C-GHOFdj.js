import{_ as H,b as _e}from"./index-BHFQDeIH.js";import{_ as fe}from"./index.vuevuetypescriptsetuptruelang-btAM1SCl.js";import{_ as xe}from"./index.vuevuetypestyleindex0lang-Bo9-5UcB.js";import{_ as ye}from"./index.vuevuetypescriptsetuptruelang-B72BLR5Z.js";import{d as F,f as p,W as r,_ as L,$ as n,Y as e,k as s,u as t,H as j,y as ge,ae as ve,D as Ce,a0 as he,X as g,G as d,a5 as U,F as $,a9 as be,a3 as u,a4 as x,m as ke,A as Ie,af as Te,ag as Se}from"./vue-7WeWijCE.js";import{n as Ae,I as Ee,o as O,F as Y,p as G,q as we,b as De,e as Ne,D as Le,r as Re,s as Pe,S as Me,t as Ue,u as $e,v as je}from"./antd-D-4v7PI_.js";import{S as Ve}from"./SendStatusEnum-0TbEL80Y.js";import{g as Be}from"./tools-DInPKiE1.js";import"./context-C_dsVytT.js";const He={class:"px-30px py-20px w-376px text-base mx-auto"},Fe=F({name:"TopUpModal",__name:"top-up-modal",setup(v,{expose:S}){const _=p(!1),i=p("");async function f(k){const h=k.target.value.replace(/^\D/g,"").slice(0,6);await ge(),i.value=h}function A(){i.value="",_.value=!0}return S({show:A}),(k,o)=>{const C=Ee,h=O,E=Y,w=G;return r(),L(w,{open:t(_),"onUpdate:open":o[1]||(o[1]=I=>j(_)?_.value=I:null),title:"儲值金額",centered:"","cancel-text":"取消","ok-text":"確定",width:"440px","ok-button-props":{disabled:t(Ae)(t(i))||parseInt(t(i))<1e3},onOk:o[2]||(o[2]=I=>_.value=!1)},{default:n(()=>[e("div",He,[s(E,{layout:"vertical",autocomplete:"off"},{default:n(()=>[s(h,{"html-for":"",extra:"單次最低儲值 NT$1,000"},{default:n(()=>[s(C,{value:t(i),"onUpdate:value":o[0]||(o[0]=I=>j(i)?i.value=I:null),"addon-before":"NT$",type:"number",placeholder:"請輸入金額",onInput:f},null,8,["value"])]),_:1})]),_:1})])]),_:1},8,["open","ok-button-props"])}}});function Oe(){const v=p([{key:"1",content:"1.公告系統優化功能版本 5.6 版本，更新刷卡流程",createTime:"2024/07/12"},{key:"2",content:`1.公告系統優化功能版本 5.5 版本，更新聯絡人資訊
2.週六系統更新，請勿登入使用`,createTime:"2024/07/12"},{key:"3",content:`1.公告系統優化功能版本 5.5 版本，更新聯絡人資訊
2.週六系統更新，請勿登入使用`,createTime:"2024/07/12"}]),S=async()=>{},_=p({remainingDepositAmount:5e3,yearsDepoitAmount:8e3}),i=async()=>{},f=p({totalDepositAmountYear:4e4,list:[{key:"1",sendNumber:"AJ593749G2",name:"秋季週年慶",sendTime:"2024/11/20",depositAmount:3210},{key:"2",sendNumber:"AJ593749H1",name:"聖誕特賣",sendTime:"2024/12/24",depositAmount:18e3},{key:"3",sendNumber:"AJ593749K0",name:"新年快樂！",sendTime:"2025/02/01",depositAmount:20490},{key:"4",sendNumber:"AJ593749K1",name:"新年快樂！",sendTime:"2025/02/01",depositAmount:20490}]}),A=async()=>{},k=p([{phone:"0995827791",replyContent:"還可以參加活動嗎？",sendTime:"2024/07/10"},{phone:"0983771527",replyContent:"是",sendTime:"2024/07/08"},{phone:"0974823793",replyContent:"已回覆訊息，請問何時抽獎呢？",sendTime:"2024/07/05"}]),o=async()=>{},C=p({successCount:2871,sendingCount:75,failCount:122,totalCount:3068,successPercent:93.6,sendingPercent:3}),h=async()=>{},E=p([{key:"1",sendNumber:"AJ593749G2",name:"夏季特賣會",status:"EXECUTING",sendTime:"2024/07/21 12:30",totalCount:2e3,sendingCount:100,successCount:1900,failCount:0,successPercent:95,messageId:"1"},{key:"2",sendNumber:"AJ521668R8",name:"抽獎結果出爐啦！",status:"EXECUTING",sendTime:"2024/07/21 12:30",totalCount:3591,sendingCount:1042,successCount:1900,failCount:649,successPercent:51.5,messageId:"1"},{key:"3",sendNumber:"AJ493992O5",name:"暑假兩個月行程怎麼排？",status:"EXECUTING",sendTime:"2024/07/21 12:30",totalCount:1427,sendingCount:126,successCount:1209,failCount:92,successPercent:84.7,messageId:"1"},{key:"4",sendNumber:"AJ910093Q4",name:"歡慶畢業季",status:"IS_SENT",sendTime:"2024/07/21 12:30",totalCount:901,sendingCount:0,successCount:877,failCount:24,successPercent:97.3,messageId:"1"},{key:"5",sendNumber:"AJ900338T8",name:"六月新娘看這裡",status:"IS_SENT",sendTime:"2024/07/21 12:30",totalCount:452,sendingCount:0,successCount:442,failCount:10,successPercent:97.8,messageId:"1"},{key:"6",sendNumber:"AJ858377H9",name:"端午節慶佳節",status:"RESERVATION_FAILED",sendTime:"2024/07/21 12:30",totalCount:1990,sendingCount:0,successCount:0,failCount:0,successPercent:0,messageId:"1"},{key:"7",sendNumber:"AJ858377H9",name:"端午節慶佳節",status:"RESERVATION_FAILED",sendTime:"2024/07/21 12:30",totalCount:1990,sendingCount:0,successCount:0,failCount:0,successPercent:0,messageId:"1"}]);return{getSysAnnouncement:S,sysAnnouncement:v,getProfitability:i,profitability:_,getDepositActivities:A,depositActivities:f,getUnReadChatMessage:o,unReadChatMessage:k,getDeliveryStatisitcs:h,deliveryStatisitcs:C,getDeliveryResultDetails:async()=>{},deliveryResultDetails:E}}const m=v=>(Te("data-v-0175bda7"),v=v(),Se(),v),Ye={class:"flex gap-x-4 items-center"},Ge={id:"layout",class:"relative"},Je={class:"w-[248px]"},Xe={class:"grid grid-cols-3 gap-4 mb-2xl"},Ke={class:"flex flex-col col-span-2 gap-2"},qe=m(()=>e("div",{class:"text-base font-500 flex justify-between items-center"}," 系統公告 ",-1)),ze={class:"min-h-178px"},Qe=["innerHTML"],We={class:"flex flex-col gap-2"},Ze={class:"text-base font-500 flex justify-between items-center"},et=m(()=>e("span",null,"儲值狀況",-1)),tt={class:"bg-sms-grayscale-0 rounded-3 p-4 min-h-178px"},st={class:"flex flex-col justify-between h-full"},nt={class:"flex justify-between mb-4"},at=m(()=>e("span",{class:"text-sm text-sms-grayscale-60"},"預估剩餘金額",-1)),ot={class:"text-sm text-sms-grayscale-100"},lt={class:"flex justify-between"},it=m(()=>e("span",{class:"text-sm text-sms-grayscale-60"},"近一年預約活動預估發送金額",-1)),ct={class:"flex justify-end gap-2 items-center"},ut={class:"text-sm text-sms-status-alert-red"},dt={class:"grid grid-cols-2 gap-x-4 gap-y-2xl mb-2xl"},rt={class:"flex flex-col gap-2"},mt={class:"text-base font-500 flex justify-between items-center"},pt=m(()=>e("div",null,[d("預約活動 "),e("span",{class:"text-sm text-sms-grayscale-60 font-400 ms-2"},"未來一年內活動")],-1)),_t={class:"bg-sms-primary-blue-30 text-sms-primary-blue-80 text-sm rounded-2 font-400 py-5px px-6"},ft={class:"w-full min-h-211px"},xt={key:0,class:"flex flex-col gap-2"},yt=m(()=>e("div",{class:"text-base font-500"},[d(" 雙向訊息"),e("span",{class:"text-sm text-sms-grayscale-60 font-400 ms-2"},"顯示最新未讀訊息")],-1)),gt={class:"w-full min-h-211px"},vt={key:1,class:"flex flex-col gap-2"},Ct=m(()=>e("div",{class:"text-base font-500"}," 30天內發送結果統計 ",-1)),ht={class:"w-full min-h-211px bg-sms-grayscale-0 rounded-3 p-6 flex items-center gap-10"},bt={class:"flex flex-col justify-center items-center"},kt=m(()=>e("span",{class:"text-sm text-sms-grayscale-60 font-400"},"發送總數",-1)),It={class:"text-base text-sms-grayscale-100 font-500"},Tt={class:"flex justify-between"},St={class:"flex justify-between"},At={class:"flex justify-between"},Et={class:"flex justify-between"},wt=m(()=>e("span",{class:"text-sms-grayscale-60"},"成功率",-1)),Dt={key:0,class:"grid grid-cols-1"},Nt={class:"flex flex-col gap-2"},Lt=m(()=>e("div",{class:"text-base font-500"}," 30天內發送結果明細 ",-1)),Rt={class:"w-full min-h-211px"},Pt={class:"px-30px py-20px w-328px text-base mx-auto"},Mt=m(()=>e("span",{class:"me-2"},"訊息類型",-1)),Ut={href:"javascript:;"},$t=m(()=>e("br",null,null,-1)),jt=F({__name:"analysis",setup(v){const S={RESERVATION:"text-sms-yellow-60 bg-#F7F2E8",EXECUTING:"text-sms-primary-blue-80 bg-sms-primary-blue-30",IS_SENT:"text-sms-green-80 bg-sms-green-30",RESERVATION_FAILED:"text-sms-status-alert-red bg-sms-light-red-40"},_=p(null),i=p({open:!1,isParameter:!1}),f=p(!1);function A(){return document.getElementById("layout")}const k=[{value:"SYS_ANNOUNCEMENT",label:"系統公告",disabled:!0},{value:"PROFITABILITY",label:"儲值狀況",disabled:!0},{value:"DEPOSIT_ACTIVITIES",label:"預約活動",disabled:!0},{value:"CHAT_MESSAGE",label:"雙向訊息",disabled:!1},{value:"30_DELIVERY_STATISITCS",label:"30天內發送結果統計",disabled:!1},{value:"30_DELIVERY_RESULT_DETAILS",label:"30天內發送結果明細",disabled:!1}],o=ve("showLayoutList",["SYS_ANNOUNCEMENT","PROFITABILITY","DEPOSIT_ACTIVITIES","CHAT_MESSAGE","30_DELIVERY_STATISITCS","30_DELIVERY_RESULT_DETAILS"]);function C(b){b.disabled||(o.value.includes(b.value)?o.value=o.value.filter(l=>b.value!==l):o.value.push(b.value))}const h=[{title:"公告內容",dataIndex:"content",key:"content"},{title:"公告時間",width:"155px",dataIndex:"createTime",key:"createTime"}],E=[{title:"發送編號",dataIndex:"sendNumber",key:"sendNumber",width:"108px"},{title:"活動名稱",width:"172px",dataIndex:"name",key:"name"},{title:"發送時間",width:"100px",dataIndex:"sendTime",key:"sendTime"},{title:"預估金額",width:"106px",dataIndex:"depositAmount",key:"depositAmount"}],w=[{title:"回傳門號",dataIndex:"phone",key:"phone",width:"108px"},{title:"回傳訊息內容",width:"270px",dataIndex:"replyContent",key:"replyContent"},{title:"發送時間",width:"100px",dataIndex:"sendTime",key:"sendTime"}],I=[{title:"發送編號",dataIndex:"sendNumber",key:"sendNumber",width:"120px"},{title:"活動名稱",width:"200px",dataIndex:"name",key:"name"},{title:"活動狀態",width:"95px",dataIndex:"status",key:"status"},{title:"發送時間",width:"134px",dataIndex:"sendTime",key:"sendTime"},{title:"發送總數",width:"85px",dataIndex:"totalCount",key:"totalCount",align:"right",customHeaderCell:()=>({class:"[&>*]:!justify-end"})},{title:"發送中",width:"85px",dataIndex:"sendingCount",key:"sendingCount",align:"right",customHeaderCell:()=>({class:"[&>*]:!justify-end"})},{title:"發送成功",width:"85px",dataIndex:"successCount",key:"successCount",align:"right",customHeaderCell:()=>({class:"[&>*]:!justify-end"})},{title:"發送失敗",width:"85px",dataIndex:"failCount",key:"failCount",align:"right",customHeaderCell:()=>({class:"[&>*]:!justify-end"})},{title:"成功率",width:"85px",dataIndex:"successPercent",key:"successPercent",align:"right",customHeaderCell:()=>({class:"[&>*]:!justify-end"})}],{getDeliveryStatisitcs:J,deliveryStatisitcs:y,getDepositActivities:X,depositActivities:V,getProfitability:K,profitability:T,getSysAnnouncement:q,sysAnnouncement:z,getUnReadChatMessage:Q,unReadChatMessage:W,getDeliveryResultDetails:Z,deliveryResultDetails:ee}=Oe();return Ce(()=>{J(),X(),K(),q(),Q(),Z()}),(b,l)=>{const R=H,D=ye,te=we,se=De,ne=Ne,ae=Le,N=xe,P=he("router-link"),oe=Re,M=Pe,le=Me,ie=fe,ce=H,ue=Ue,B=$e,de=je,re=O,me=Y,pe=G;return r(),g($,null,[s(ie,{title:"總覽"},{extraContent:n(()=>[e("div",Ye,[s(D,{onClick:l[0]||(l[0]=()=>{i.value={open:!0,isParameter:!1}})},{icon:n(()=>[s(R,{name:"plus"}),d(" 新增訊息行銷活動 ")]),_:1}),e("div",Ge,[e("div",{class:U(["layout-dropdown-mask",{block:t(f),hidden:!t(f)}]),onClick:l[1]||(l[1]=a=>f.value=!1)},null,2),s(ae,{open:t(f),"onUpdate:open":l[2]||(l[2]=a=>j(f)?f.value=a:null),trigger:"click",placement:"bottomLeft","get-popup-container":A},{overlay:n(()=>[e("div",Je,[s(ne,null,{default:n(()=>[(r(),g($,null,be(k,a=>s(se,{key:a.value,onClick:c=>C(a)},{default:n(()=>[s(te,{checked:t(o).includes(a.value),disabled:a.disabled,value:a.value,onChange:c=>C(a)},{default:n(()=>[e("span",null,u(a.label),1)]),_:2},1032,["checked","disabled","value","onChange"])]),_:2},1032,["onClick"])),64))]),_:1})])]),default:n(()=>[s(D,{status:"small4",class:"!px-0"},{icon:n(()=>[s(R,{name:"layout"})]),_:1})]),_:1},8,["open"])])])]),default:n(()=>[e("div",Xe,[e("div",Ke,[qe,e("div",ze,[s(N,{class:"!mt-0",columns:h,"data-source":t(z),scroll:{y:"135px"}},{bodyCell:n(({record:a,column:c})=>[c.key==="content"?(r(),g("div",{key:0,class:"whitespace-pre-wrap",innerHTML:a.content},null,8,Qe)):x("",!0)]),_:1},8,["data-source"])])]),e("div",We,[e("div",Ze,[et,s(D,{onClick:l[3]||(l[3]=()=>b.$router.push({name:"Accounting"})),status:"small4",class:"!p-0 !text-sms-primary-blue-80 !min-h-auto !h-auto"},{default:n(()=>[d(" 儲值管理 "),s(R,{class:"!text-sms-primary-blue-80",name:"arrow-right"})]),_:1})]),e("div",tt,[e("div",st,[e("div",null,[e("div",nt,[at,e("span",ot,"NT$ "+u(t(T).remainingDepositAmount.toLocaleString()),1)]),e("div",lt,[it,e("span",{class:U(["text-sm text-sms-grayscale-100",{"text-sms-status-alert-red":Math.sign(t(T).remainingDepositAmount-t(T).yearsDepoitAmount)!==1}])},"NT$ "+u(t(T).yearsDepoitAmount.toLocaleString()),3)])]),e("div",ct,[ke(e("span",ut,"餘額不足，需儲值",512),[[Ie,Math.sign(t(T).remainingDepositAmount-t(T).yearsDepoitAmount)!==1]]),s(D,{onClick:l[4]||(l[4]=a=>{var c;return(c=t(_))==null?void 0:c.show()})},{default:n(()=>[d("儲值")]),_:1})])])])])]),e("div",dt,[e("div",rt,[e("div",mt,[pt,e("div",_t," 一年內預估總金額：$"+u(t(V).totalDepositAmountYear.toLocaleString()),1)]),e("div",ft,[s(N,{class:"!mt-0",columns:E,"data-source":t(V).list,scroll:{y:"150px"}},{bodyCell:n(({record:a,column:c})=>[c.key==="depositAmount"?(r(),g($,{key:0},[d(" NT$"+u(a.depositAmount.toLocaleString()),1)],64)):x("",!0),c.key==="name"?(r(),L(P,{key:1,to:{name:"Appointment"},target:"_blank",class:"underline underline-offset-2 text-sms-primary-blue-80"},{default:n(()=>[d(u(a.name),1)]),_:2},1024)):x("",!0)]),_:1},8,["data-source"])])]),t(o).includes("CHAT_MESSAGE")?(r(),g("div",xt,[yt,e("div",gt,[s(N,{class:"!mt-0",columns:w,"data-source":t(W),scroll:{y:"150px"}},{bodyCell:n(({record:a,column:c})=>[c.key==="replyContent"?(r(),L(P,{key:0,to:{name:"ChatMessage"},target:"_blank",class:"underline underline-offset-2 text-sms-primary-blue-80"},{default:n(()=>[d(u(a.replyContent),1)]),_:2},1024)):x("",!0)]),_:1},8,["data-source"])])])):x("",!0),t(o).includes("30_DELIVERY_STATISITCS")?(r(),g("div",vt,[Ct,e("div",ht,[s(oe,{percent:t(y).successPercent+t(y).sendingPercent,success:{percent:t(y).successPercent,strokeColor:"#285BDE"},"stroke-color":"#BAD2F4",type:"circle"},{format:n(()=>[e("div",bt,[kt,e("span",It,u(t(y).totalCount.toLocaleString()),1)])]),_:1},8,["percent","success"]),s(le,{direction:"vertical",class:"w-159px"},{default:n(()=>[e("div",Tt,[s(M,{color:"#285BDE",text:"發送成功"}),e("span",null,u(t(y).successCount.toLocaleString()),1)]),e("div",St,[s(M,{color:"#BAD2F4",text:"發送中"}),e("span",null,u(t(y).sendingCount.toLocaleString()),1)]),e("div",At,[s(M,{color:"#A7ADB7",text:"發送失敗",class:"text-sms-grayscale-60"}),e("span",null,u(t(y).failCount.toLocaleString()),1)]),e("div",Et,[wt,e("span",null,u(t(y).successPercent)+"%",1)])]),_:1})])])):x("",!0)]),t(o).includes("30_DELIVERY_RESULT_DETAILS")?(r(),g("div",Dt,[e("div",Nt,[Lt,e("div",Rt,[s(N,{class:"!mt-0",columns:I,"data-source":t(ee),scroll:{y:"330px"}},{bodyCell:n(({record:a,column:c})=>[c.key==="name"?(r(),L(P,{key:0,to:{name:"MessageSending"},target:"_blank",class:"underline underline-offset-2 text-sms-primary-blue-80"},{default:n(()=>[d(u(a.name),1)]),_:2},1024)):x("",!0),c.key==="status"?(r(),g("span",{key:1,class:U(["rounded-2 text-center py-1 px-2 text-xs font-500",{[S[a.status]]:!0}])},u(t(Ve)[a.status]),3)):x("",!0)]),_:1},8,["data-source"])])])])):x("",!0)]),_:1}),s(pe,{open:t(i).open,"onUpdate:open":l[6]||(l[6]=a=>t(i).open=a),title:"選擇訊息類型",centered:"","cancel-text":"取消","ok-text":"確定",width:"440px",onOk:l[7]||(l[7]=()=>{b.$router.push({name:t(i).isParameter?"MessageSendingParameterCreate":"MessageSendingGeneralCreate"})})},{default:n(()=>[e("div",Pt,[s(me,{layout:"vertical",autocomplete:"off"},{default:n(()=>[s(re,{"html-for":""},{label:n(()=>[Mt,s(ue,{placement:"top","get-popup-container":t(Be)},{title:n(()=>[d(" 一般訊息支援 SMS 和 MMS，"),$t,d(" 若想批次使用參數發送訊息，請選擇參數訊息 ")]),default:n(()=>[e("a",Ut,[s(ce,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:n(()=>[s(de,{value:t(i).isParameter,"onUpdate:value":l[5]||(l[5]=a=>t(i).isParameter=a)},{default:n(()=>[s(B,{value:!1},{default:n(()=>[d(" 一般訊息 ")]),_:1}),s(B,{value:!0},{default:n(()=>[d(" 參數訊息 ")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})])]),_:1},8,["open"]),s(Fe,{ref_key:"topUpModalRef",ref:_},null,512)],64)}}}),Kt=_e(jt,[["__scopeId","data-v-0175bda7"]]);export{Kt as default};
