import{_ as se}from"./index.vuevuetypestyleindex0lang-DRI_kzvm.js";import{_ as de}from"./index.vuevuetypescriptsetuptruelang-9TnnHm4G.js";import{_ as ue,a as re}from"./index.vuevuetypescriptsetuptruelang-DLLV04Yk.js";import{_ as ie}from"./index-CA5s4HlQ.js";import{_ as pe}from"./index.vuevuetypescriptsetuptruelang-DtpB6Cde.js";import{j as ce,_ as me}from"./index-C1AvcV_o.js";import{a as fe,g as _e}from"./tools-DuR4KSGu.js";import{_ as ve}from"./request-Cht3mzI3.js";import{u as xe}from"./contact-person-BWLUWf58.js";import{G as ye}from"./GenderEnum-DlheD0SA.js";import{u as ge}from"./group-label-DY0gFQw3.js";import{Q as we,I as ke,p as he,q as be,G as Ce,s as Ie,F as Re,J as Te,z as Ye}from"./antd-C_UvAipJ.js";import{d as Le,f as v,D as Me,o as De,r as Ue,u as e,W as m,X as x,Y as p,k as a,$ as n,G as i,F as y,a3 as f,a4 as g,_ as Ke,H as V}from"./vue-Cot4Dobd.js";const Pe={class:"flex justify-between px-2 items-center mb-2"},Ve={class:"me-1"},Oe={href:"javascript:;"},Be=p("span",null,"全域黑名單功能: 主帳號將特定手機門號加入黑名單，主帳號和子帳號皆無法發送該門號任何訊息",-1),Fe=p("div",{class:"h-59px px-20px py-24px"},[p("p",{class:"text-center text-sms-grayscale-80"}," 您選擇的聯絡人將直接永久刪除。 ")],-1),Se=p("div",{class:"h-59px px-20px py-24px"},[p("p",{class:"text-center text-sms-grayscale-80"}," 聯絡人列表中，已經存在相同的聯絡人。 ")],-1),Ze=Le({__name:"contact-person-archived",props:{toContactPerson:{type:Function,required:!0}},setup(O){const B=O,Y=v([{value:"true",label:"是"},{value:"false",label:"否"}]),{contactPerson:L,pagination:w,getContactPersonArchived:F,deleteContactPerson:S,unArchivedContactPerson:$}=xe(),{getGroupLabelOption:E,groupOptions:M}=ge(),D=ce(),G=v(!1);Me(async()=>{b(),await E()}),De(()=>{G.value=!0});const N=[{title:"手機門號",dataIndex:"phone",key:"phone",sorter:!0,fixed:"left",width:"130px"},{title:"姓名",dataIndex:"name",key:"name",sorter:!0,fixed:"left",width:"80px"},{title:"群組標籤",dataIndex:"group",key:"group",fixed:"left",width:"250px"},{title:"性別",dataIndex:"gender",key:"gender",sorter:!0,width:"70px"},{title:"黑名單",dataIndex:"isBlackList",key:"isBlackList",sorter:!0,width:"100px"},{title:"聯絡電話",dataIndex:"contact",key:"contact",sorter:!0,width:"110px"},{title:"公司名稱",dataIndex:"company",key:"company",sorter:!0,ellipsis:!0,width:"121px"},{title:"Email",dataIndex:"email",key:"email",sorter:!0,ellipsis:!0,width:"184px"},{title:"生日",dataIndex:"birth",key:"birth",sorter:!0,width:"95px"},{title:"通訊地址",dataIndex:"address",key:"address",sorter:!0,ellipsis:!0,width:"108px"},{title:"備註",dataIndex:"note",key:"note",sorter:!0,width:"108px"},{title:"建立時間",dataIndex:"createTime",key:"createTime",defaultSortOrder:"descend",sorter:!0,width:"140px"},{title:"修改時間",dataIndex:"updateTime",key:"updateTime",sorter:!0,width:"140px"}],r=Ue({selectedRowKeys:[],selectedRows:[],loading:!1});function j(s,t){console.log("selectedRowKeys changed: ",s,t),r.selectedRowKeys=s,r.selectedRows=t}const l=v({sortField:"createTime",sortOrder:"descend",phone:"",name:"",group:[],company:"",createTime:void 0,updateTime:void 0,keyword:"",blackList:void 0}),z=v();async function b(s=1,t=10){const d={current:s,pageSize:t,...e(l)};await F(d)}async function A(s,t,d){console.log("pagination:",s,"sorter:",d),l.value=Object.assign(l.value,{sortField:d.field,sortOrder:d.order}),await b(s.current,s.pageSize)}const R=v(null);function q(){var s;b(1),(s=R.value)==null||s.hide()}const k=v(!1);async function H(){var t;((t=(await S(r.selectedRows.map(d=>d.key))).data)==null?void 0:t.status)==="success"&&(b(w.value.current===1||L.value.length-r.selectedRowKeys.length>1?w.value.current:w.value.current-1,w.value.pageSize),r.selectedRowKeys=[],r.selectedRows=[],k.value=!1,D.success({message:"聯絡人刪除成功",placement:"top"}))}const C=v(!1);function J(){C.value=!0}async function Q(){var t;((t=(await $(r.selectedRowKeys)).data)==null?void 0:t.status)==="success"&&(D.success({message:"聯絡人回復成功",placement:"top"}),B.toContactPerson())}function W(){Q()}function X(){return document.body}return(s,t)=>{const d=me,h=pe,T=ke,_=ie,c=he,Z=ue,ee=re,U=be,K=Ce,te=Ie,ae=Re,oe=Te,ne=de,le=se,P=Ye;return m(),x(y,null,[p("div",Pe,[p("div",null,[a(h,{status:"small2",class:"me-2",disabled:e(r).selectedRowKeys.length===0,onClick:J},{icon:n(()=>[a(d,{name:"change",width:"16px"})]),default:n(()=>[i(" 回復聯絡人 ")]),_:1},8,["disabled"]),a(h,{status:"small2",class:"me-2",disabled:e(r).selectedRowKeys.length===0},{icon:n(()=>[a(d,{name:"download",width:"16px"})]),default:n(()=>[i(" 匯出CSV ")]),_:1},8,["disabled"]),a(h,{status:"small2",class:"me-2",disabled:e(r).selectedRowKeys.length===0,onClick:t[0]||(t[0]=o=>k.value=!0)},{icon:n(()=>[a(d,{name:"delete",width:"16px"})]),default:n(()=>[i(" 永久刪除 ")]),_:1},8,["disabled"])]),a(ve,{ref_key:"filterKeywordInputRef",ref:R,modelValue:e(l).keyword,"onUpdate:modelValue":t[10]||(t[10]=o=>e(l).keyword=o),class:"w-440px h-40px",placeholder:"搜尋門號、姓名、公司、通訊地址、Email、備註",onClearFilter:t[11]||(t[11]=()=>{l.value={...e(l),phone:"",name:"",group:[],company:"",createTime:void 0,updateTime:void 0,keyword:"",blackList:void 0}})},{filterForm:n(()=>[a(ae,{ref_key:"formRef",ref:z,layout:"vertical",model:e(l),autocomplete:"off"},{default:n(()=>[a(te,{gutter:[16,12]},{default:n(()=>[a(c,{span:24},{default:n(()=>[a(_,{label:"手機門號",valueed:e(l).phone},{default:n(()=>[a(T,{value:e(l).phone,"onUpdate:value":t[1]||(t[1]=o=>e(l).phone=o)},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(_,{label:"姓名",valueed:e(l).name},{default:n(()=>[a(T,{value:e(l).name,"onUpdate:value":t[2]||(t[2]=o=>e(l).name=o)},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(_,{id:"group",label:"群組標籤",valueed:e(fe)(e(l).group)},{default:n(()=>[a(U,{value:e(l).group,"onUpdate:value":t[4]||(t[4]=o=>e(l).group=o),options:e(M),"max-tag-count":2,"show-arrow":!0,"show-search":!1,mode:"multiple",class:"w-full"},{dropdownRender:n(({menuNode:o})=>[a(Z,{modelValue:e(l).group,"onUpdate:modelValue":t[3]||(t[3]=u=>e(l).group=u),menu:o,options:e(M)},null,8,["modelValue","menu","options"])]),option:n(({value:o,label:u})=>[a(ee,{values:e(l).group,value:o,label:u},null,8,["values","value","label"])]),_:1},8,["value","options"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(_,{label:"黑名單",valueed:e(_e)(e(l).blackList,e(Y))},{default:n(()=>[a(U,{value:e(l).blackList,"onUpdate:value":t[5]||(t[5]=o=>e(l).blackList=o),options:e(Y),"max-tag-count":2,"show-arrow":!0,"show-search":!1,class:"w-full"},null,8,["value","options"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(_,{label:"公司名稱",valueed:e(l).company},{default:n(()=>[a(T,{value:e(l).company,"onUpdate:value":t[6]||(t[6]=o=>e(l).company=o),name:"company"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(_,{label:"建立時間",valueed:e(l).createTime},{default:n(()=>[a(K,{value:e(l).createTime,"onUpdate:value":t[7]||(t[7]=o=>e(l).createTime=o),class:"w-full",placement:"topLeft",format:"YYYY-MM-DD","value-format":"YYYY/MM/DD"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(_,{label:"修改時間",valueed:e(l).updateTime},{default:n(()=>[a(K,{value:e(l).updateTime,"onUpdate:value":t[8]||(t[8]=o=>e(l).updateTime=o),class:"w-full",placement:"topLeft",format:"YYYY-MM-DD","value-format":"YYYY/MM/DD"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24,class:"text-center"},{default:n(()=>[a(h,{status:"small2",class:"me-5",onClick:t[9]||(t[9]=o=>{var u;return(u=e(R))==null?void 0:u.hide()})},{default:n(()=>[i(" 取消 ")]),_:1}),a(h,{status:"small1",onClick:q},{default:n(()=>[i(" 確定 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),a(le,{"data-source":e(L),columns:N,scroll:{x:1500},size:"small","show-sorter-tooltip":!1,"row-selection":{selectedRowKeys:e(r).selectedRowKeys,onChange:j},pagination:{...e(w)},onChange:A},{headerCell:n(({column:o})=>[o.key==="isBlackList"?(m(),x(y,{key:0},[p("span",Ve,f(o.title),1),a(oe,{placement:"top","get-popup-container":X},{title:n(()=>[Be]),default:n(()=>[p("a",Oe,[a(d,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1})],64)):g("",!0)]),bodyCell:n(({column:o,record:u,text:I})=>[o.dataIndex==="group"?(m(),Ke(ne,{key:0,chips:u.group,"max-count":3},null,8,["chips"])):g("",!0),o.dataIndex==="phone"?(m(),x(y,{key:1},[i(f(u.countryCode)+f(u.phone),1)],64)):g("",!0),o.dataIndex==="contact"?(m(),x(y,{key:2},[i(f(u.areaCode)+f(u.contact),1)],64)):g("",!0),o.dataIndex==="gender"?(m(),x(y,{key:3},[i(f(e(ye)[I]),1)],64)):g("",!0),o.dataIndex==="isBlackList"?(m(),x(y,{key:4},[i(f(I?"黑名單":""),1)],64)):g("",!0),o.dataIndex==="note"?(m(),x(y,{key:5},[i(f(e(we)(I)?"-":I),1)],64)):g("",!0)]),_:1},8,["data-source","row-selection","pagination"]),a(P,{open:e(k),"onUpdate:open":t[12]||(t[12]=o=>V(k)?k.value=o:null),centered:"",title:"是否永久刪除選取的聯絡人？",width:"440px","cancel-text":"取消","ok-text":"確定",onOk:H},{default:n(()=>[Fe]),_:1},8,["open"]),a(P,{open:e(C),"onUpdate:open":t[13]||(t[13]=o=>V(C)?C.value=o:null),centered:"",title:"是否覆蓋現有的聯絡人？",width:"440px","cancel-text":"取消","ok-text":"確定",onOk:W},{default:n(()=>[Se]),_:1},8,["open"])],64)}}});export{Ze as _};
