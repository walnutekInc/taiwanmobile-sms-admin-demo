import{F as te,_ as ae}from"./request-a4d61a0d.js";import{_ as se}from"./index-bb848cfb.js";import{_ as oe}from"./index.vuevuetypescriptsetuptruelang-6de7385f.js";import{k as ne,_ as le}from"./index-65ab6565.js";import{u as re}from"./group-label-cb13cc01.js";import{E as I,H as ie,Q as ue,r as de,u as ce,F as me,I as pe,G as _e}from"./antd-100bd80b.js";import{d as fe,r as L,f as k,D as ye,o as ve,u as t,a0 as K,W as c,X as y,_ as O,k as s,$ as o,G as d,E as ke,a4 as Y,Y as _,F as S,a3 as h,H as ge}from"./vue-b9a22f97.js";const we={class:"flex justify-between px-2 items-center mb-2"},xe={key:1},be={key:1},Ce={key:0},he={class:"editable-cell-wrapper"},Te={class:"text-sms-status-alert-red text-xs"},Re={key:1,class:"editable-cell-wrapper"},Ye=_("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"},[d(" 您選擇的訊息類別將永久刪除。"),_("br"),d(" 原本屬於該訊息類別的自訂訊息，"),_("br"),d(" 將改為未分類狀態。 ")],-1),$e=fe({__name:"group-label",setup(De){const{getGroupLabels:$,groupLabels:g,pagination:N,updateGroupLabel:V,deleteGroupLabel:E}=re(),r=L({}),D=k(!1);ye(async()=>{w()}),ve(()=>{D.value=!0});const G=[{title:"訊息類別",dataIndex:"categoryName",key:"categoryName",sorter:!0,width:"320px"},{title:"訊息數量",dataIndex:"smsCount",key:"smsCount",sorter:!0,width:"160px",align:"right"},{title:"建立時間",dataIndex:"createTime",key:"createTime",defaultSortOrder:"descend",sorter:!0,width:"160px"},{title:"修改時間",dataIndex:"updateTime",key:"updateTime",sorter:!0}],m=L({selectedRowKeys:[],selectedRows:[],loading:!1}),U=(a,e)=>{console.log("selectedRowKeys changed: ",a,e),m.selectedRowKeys=a,m.selectedRows=e},n=k({sortField:"createTime",sortOrder:"descend",createTime:[void 0,void 0],updateTime:[void 0,void 0],keyword:"",keys:[]}),B=k(),w=async(a=1,e=10)=>{let i={current:a,pageSize:e,...t(n)};await $(i)},j=a=>{r[a]={...ie(g.value.filter(e=>a===e.key)[0]),msg:""}},M=async a=>{var p;const e=r[a];if(I(e.name)){r[a].msg="請輸入群組標籤";return}g.value.find(f=>e.name===f.name&&e.key!==f.key)?r[a].msg=`系統中已有「${r[a].name}」，請勿重複新增`:((p=(await V(e.key,e.name)).data)==null?void 0:p.status)==="success"&&(Object.assign(g.value.filter(x=>a===x.key)[0],e),delete r[a],F.success({message:"群組標籤編輯成功",placement:"top"}))},P=async(a,e,i)=>{console.log("pagination:",a,"sorter:",i),n.value=Object.assign(n.value,{sortField:i.field,sortOrder:i.order}),await w(a.current,a.pageSize)},T=k(null),z=()=>{var a;w(1),(a=T.value)==null||a.hide()},F=ne(),v=k(!1),H=()=>{v.value=!0},q=async()=>{var e;((e=(await E(m.selectedRowKeys)).data)==null?void 0:e.status)==="success"&&(F.success({message:"群組標籤刪除成功",placement:"top"}),v.value=!1,m.selectedRowKeys=[],m.selectedRows=[])};return(a,e)=>{const i=le,p=oe,f=ue,x=se,R=de,A=ce,Q=me,W=K("RouterLink"),X=pe,J=ae,Z=K("SmsCategoryCreate"),ee=_e;return c(),y(S,null,[t(D)?(c(),O(ke,{key:0,to:"#extraContent"},[s(p,{status:"small1",onClick:()=>{}},{icon:o(()=>[s(i,{name:"plus",width:"16px"})]),default:o(()=>[d("新增類別訊息 ")]),_:1})])):Y("",!0),_("div",we,[_("div",null,[s(p,{status:"small2",class:"me-2",onClick:H,disabled:t(m).selectedRowKeys.length===0},{icon:o(()=>[s(i,{name:"delete",width:"16px"})]),default:o(()=>[d("刪除 ")]),_:1},8,["disabled"])]),s(te,{ref_key:"filterKeywordInputRef",ref:T,class:"w-440px h-40px",modelValue:t(n).keyword,"onUpdate:modelValue":e[3]||(e[3]=u=>t(n).keyword=u),placeholder:"搜尋訊息類別",onClearFilter:e[4]||(e[4]=()=>{n.value={...t(n),keyword:"",createTime:[void 0,void 0],updateTime:[void 0,void 0]}})},{filterForm:o(()=>[s(Q,{ref_key:"formRef",ref:B,layout:"vertical",model:t(n),autocomplete:"off"},{default:o(()=>[s(A,{gutter:[16,12]},{default:o(()=>[s(R,{span:24},{default:o(()=>[s(x,{label:"建立時間",valueed:t(n).createTime},{default:o(()=>[s(f,{class:"w-full",value:t(n).createTime,"onUpdate:value":e[0]||(e[0]=u=>t(n).createTime=u),placement:"topLeft",format:"YYYY-MM-DD",valueFormat:"YYYY/MM/DD"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),s(R,{span:24},{default:o(()=>[s(x,{label:"修改時間",valueed:t(n).updateTime},{default:o(()=>[s(f,{class:"w-full",value:t(n).updateTime,"onUpdate:value":e[1]||(e[1]=u=>t(n).updateTime=u),placement:"topLeft",format:"YYYY-MM-DD",valueFormat:"YYYY/MM/DD"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),s(R,{span:24,class:"text-center"},{default:o(()=>[s(p,{status:"small2",class:"me-5",onClick:e[2]||(e[2]=u=>{var l;return(l=t(T))==null?void 0:l.hide()})},{default:o(()=>[d("取消")]),_:1}),s(p,{status:"small1",onClick:z},{default:o(()=>[d("確定")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),s(J,{dataSource:t(g),columns:G,size:"small",showSorterTooltip:!1,"row-selection":{selectedRowKeys:t(m).selectedRowKeys,onChange:U},onChange:P,pagination:{...t(N)}},{bodyCell:o(({column:u,record:l,text:b})=>[u.dataIndex==="smsCount"?(c(),y(S,{key:0},[b>0?(c(),O(W,{key:0,href:"javascript:;",class:"text-sm text-sms-primary-blue-80 underline underline-2 underline-sms-primary-blue-80 font-400",hover:"text-sms-primary-blue-80 underline underline-2 underline-sms-primary-blue-80",to:{name:"CustomMessage",query:{tabActived:"customMessage",categoryId:l.key}}},{default:o(()=>[d(h(b),1)]),_:2},1032,["to"])):(c(),y("span",xe,h(b),1))],64)):Y("",!0),u.dataIndex==="name"?(c(),y("div",be,[t(r)[l.key]?(c(),y("div",Ce,[_("div",he,[s(X,{value:t(r)[l.key].name,"onUpdate:value":C=>t(r)[l.key].name=C,onPressEnter:C=>M(l.key),maxLength:15,status:t(r)[l.key].msg&&!t(I)(t(r)[l.key].msg)?"error":""},null,8,["value","onUpdate:value","onPressEnter","status"]),s(i,{name:"save",onClick:C=>M(l.key),class:"ms-1 text-sms-primary-blue-80 cursor-pointer"},null,8,["onClick"])]),_("span",Te,h(t(r)[l.key].msg),1)])):(c(),y("div",Re,[d(h(b||" ")+" ",1),s(i,{name:"edit",onClick:C=>j(l.key),class:"ms-1 text-sms-primary-blue-80 cursor-pointer"},null,8,["onClick"])]))])):Y("",!0)]),_:1},8,["dataSource","row-selection","pagination"]),s(Z,{ref:"smsCategoryCreateRef","save-callbck":()=>w(1)},null,8,["save-callbck"]),s(ee,{open:t(v),"onUpdate:open":e[5]||(e[5]=u=>ge(v)?v.value=u:null),title:"是否刪除選取的訊息類別？",centered:"",cancelText:"取消",okText:"確定",onOk:q,width:"440px"},{default:o(()=>[Ye]),_:1},8,["open"])],64)}}});export{$e as default};
