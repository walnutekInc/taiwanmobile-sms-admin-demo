import{_ as se}from"./request-188e9210.js";import{u as ne,a as le,g as de,b as ie,F as re,G as ue,_ as ce,c as pe}from"./GenderEnum-7a41ead3.js";import{_ as me}from"./index.vuevuetypescriptsetuptruelang-6d8252fd.js";import{k as _e,_ as fe}from"./index-968610ff.js";import{G as ve,I as xe,r as ye,C as ke,s as we,H as ge,u as he,F as be,J as Ce,K as Ie}from"./antd-cd9a43bc.js";import{d as Te,f as x,D as Ye,o as Re,r as Le,u as e,W as v,X as y,Y as p,k as t,$ as o,G as i,a3 as u,F as k,a4 as w,_ as Me,H as D}from"./vue-8aa546f0.js";const Fe={class:"flex justify-between px-2 items-center mb-2"},De={class:"me-1"},Se={href:"javascript:;"},Ke=p("span",null,"全域黑名單功能: 主帳號將特定手機門號加入黑名單，主帳號和子帳號皆無法發送該門號任何訊息",-1),Ue=p("div",{class:"h-59px px-20px py-24px"},[p("p",{class:"text-center text-sms-grayscale-80"},"您選擇的聯絡人將直接永久刪除。")],-1),Oe=p("div",{class:"h-59px px-20px py-24px"},[p("p",{class:"text-center text-sms-grayscale-80"},"聯絡人列表中，已經存在相同的聯絡人。")],-1),Ge=Te({__name:"contact-person-archived",props:{toContactPerson:{type:Function,required:!0}},setup(S){const K=S,Y=x([{value:!0,label:"是"},{value:!1,label:"否"}]),{contactPerson:U,pagination:O,getContactPersonArchived:P,deleteContactPerson:B,unArchivedContactPerson:V}=ne(),{getGroupLabelOption:$,groupOptions:A}=le(),R=_e(),E=x(!1);Ye(async()=>{I(),await $()}),Re(()=>{E.value=!0});const G=[{title:"手機門號",dataIndex:"phone",key:"phone",sorter:!0,fixed:"left",width:"130px"},{title:"姓名",dataIndex:"name",key:"name",sorter:!0,fixed:"left",width:"80px"},{title:"群組標籤",dataIndex:"group",key:"group",fixed:"left",width:"250px"},{title:"性別",dataIndex:"gender",key:"gender",sorter:!0,width:"70px"},{title:"黑名單",dataIndex:"isBlackList",key:"isBlackList",sorter:!0,width:"100px"},{title:"聯絡電話",dataIndex:"contact",key:"contact",sorter:!0,width:"110px"},{title:"公司名稱",dataIndex:"company",key:"company",sorter:!0,ellipsis:!0,width:"121px"},{title:"Email",dataIndex:"email",key:"email",sorter:!0,ellipsis:!0,width:"184px"},{title:"生日",dataIndex:"birth",key:"birth",sorter:!0,width:"95px"},{title:"通訊地址",dataIndex:"address",key:"address",sorter:!0,ellipsis:!0,width:"108px"},{title:"備註",dataIndex:"note",key:"note",sorter:!0,width:"108px"},{title:"建立時間",dataIndex:"createTime",key:"createTime",defaultSortOrder:"descend",sorter:!0,width:"140px"},{title:"修改時間",dataIndex:"updateTime",key:"updateTime",sorter:!0,width:"140px"}],m=Le({selectedRowKeys:[],selectedRows:[],loading:!1}),N=(l,a)=>{console.log("selectedRowKeys changed: ",l,a),m.selectedRowKeys=l,m.selectedRows=a},n=x({sortField:"createTime",sortOrder:"descend",phone:"",name:"",group:[],company:"",createTime:[void 0,void 0],updateTime:[void 0,void 0],keyword:"",blackList:void 0}),j=x(),I=async(l=1,a=10)=>{var _,g;let d={current:l,pageSize:a,...e(n),group:((g=(_=n.value)==null?void 0:_.group)==null?void 0:g.map(c=>c.id))??[]};await P(d)},z=async(l,a,d)=>{console.log("pagination:",l,"sorter:",d),n.value=Object.assign({sortField:d.field,sortOrder:d.order}),await I(l.current,l.pageSize)},T=x(null),H=()=>{var l;I(1),(l=T.value)==null||l.hide()},h=x(!1),q=async()=>{var a;((a=(await B(m.selectedRows.map(d=>d.key))).data)==null?void 0:a.status)==="success"&&(h.value=!1,R.success({message:"聯絡人刪除成功",placement:"top"}))},b=x(!1),J=()=>{b.value=!0},W=async()=>{var a;((a=(await V(m.selectedRowKeys)).data)==null?void 0:a.status)==="success"&&(R.success({message:"聯絡人回復成功",placement:"top"}),K.toContactPerson())},X=()=>{W()};return(l,a)=>{const d=fe,_=me,g=xe,c=ce,f=ye,Q=ke,L=we,M=ge,Z=he,ee=be,te=Ce,ae=pe,oe=se,F=Ie;return v(),y(k,null,[p("div",Fe,[p("div",null,[t(_,{status:"small2",class:"me-2",disabled:e(m).selectedRowKeys.length===0,onClick:J},{icon:o(()=>[t(d,{name:"change",width:"16px"})]),default:o(()=>[i("回復聯絡人 ")]),_:1},8,["disabled"]),t(_,{status:"small2",class:"me-2",disabled:e(m).selectedRowKeys.length===0},{icon:o(()=>[t(d,{name:"download",width:"16px"})]),default:o(()=>[i("匯出CSV ")]),_:1},8,["disabled"]),t(_,{status:"small2",class:"me-2",onClick:a[0]||(a[0]=s=>h.value=!0),disabled:e(m).selectedRowKeys.length===0},{icon:o(()=>[t(d,{name:"delete",width:"16px"})]),default:o(()=>[i("永久刪除 ")]),_:1},8,["disabled"])]),t(re,{ref_key:"filterKeywordInputRef",ref:T,class:"w-440px h-40px",modelValue:e(n).keyword,"onUpdate:modelValue":a[9]||(a[9]=s=>e(n).keyword=s),placeholder:"搜尋門號、姓名、公司、通訊地址、Email、備註",onClearFilter:a[10]||(a[10]=()=>{n.value={sortField:"createTime",sortOrder:"descend",phone:"",name:"",group:[],company:"",createTime:[void 0,void 0],updateTime:[void 0,void 0],keyword:"",blackList:void 0}})},{filterForm:o(()=>[t(ee,{ref_key:"formRef",ref:j,layout:"vertical",model:e(n),autocomplete:"off"},{default:o(()=>[t(Z,{gutter:[16,12]},{default:o(()=>[t(f,{span:24},{default:o(()=>[t(c,{label:"手機門號",valueed:e(n).phone},{default:o(()=>[t(g,{value:e(n).phone,"onUpdate:value":a[1]||(a[1]=s=>e(n).phone=s)},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),t(f,{span:24},{default:o(()=>[t(c,{label:"姓名",valueed:e(n).name},{default:o(()=>[t(g,{value:e(n).name,"onUpdate:value":a[2]||(a[2]=s=>e(n).name=s)},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),t(f,{span:24},{default:o(()=>[t(c,{id:"group",label:"群組標籤",valueed:e(de)(e(n).group)},{default:o(()=>[t(L,{options:e(A),maxTagCount:2,showArrow:!0,showSearch:!1,mode:"multiple",value:e(n).group,"onUpdate:value":a[3]||(a[3]=s=>e(n).group=s),class:"w-full"},{option:o(({value:s,label:r})=>[t(Q,{checked:e(n).group.includes(s)},null,8,["checked"]),i(" "+u(r),1)]),menuItemSelectedIcon:o(()=>[i(u(""))]),_:1},8,["options","value"])]),_:1},8,["valueed"])]),_:1}),t(f,{span:24},{default:o(()=>[t(c,{label:"黑名單",valueed:e(ie)(e(n).blackList,e(Y))},{default:o(()=>[t(L,{options:e(Y),maxTagCount:2,showArrow:!0,showSearch:!1,value:e(n).blackList,"onUpdate:value":a[4]||(a[4]=s=>e(n).blackList=s),class:"w-full"},null,8,["options","value"])]),_:1},8,["valueed"])]),_:1}),t(f,{span:24},{default:o(()=>[t(c,{label:"公司名稱",valueed:e(n).company},{default:o(()=>[t(g,{value:e(n).company,"onUpdate:value":a[5]||(a[5]=s=>e(n).company=s),name:"company"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),t(f,{span:24},{default:o(()=>[t(c,{label:"建立時間",valueed:e(n).createTime},{default:o(()=>[t(M,{class:"w-full",value:e(n).createTime,"onUpdate:value":a[6]||(a[6]=s=>e(n).createTime=s),placement:"topLeft",format:"YYYY-MM-DD",valueFormat:"YYYY/MM/DD"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),t(f,{span:24},{default:o(()=>[t(c,{label:"修改時間",valueed:e(n).updateTime},{default:o(()=>[t(M,{class:"w-full",value:e(n).updateTime,"onUpdate:value":a[7]||(a[7]=s=>e(n).updateTime=s),placement:"topLeft",format:"YYYY-MM-DD",valueFormat:"YYYY/MM/DD"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),t(f,{span:24,class:"text-center"},{default:o(()=>[t(_,{status:"small2",class:"me-5",onClick:a[8]||(a[8]=s=>{var r;return(r=e(T))==null?void 0:r.hide()})},{default:o(()=>[i("取消")]),_:1}),t(_,{status:"small1",onClick:H},{default:o(()=>[i("確定")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),t(oe,{dataSource:e(U),columns:G,scroll:{x:1500},size:"small",showSorterTooltip:!1,"row-selection":{selectedRowKeys:e(m).selectedRowKeys,onChange:N},onChange:z,pagination:{...e(O)}},{headerCell:o(({column:s})=>[s.key==="isBlackList"?(v(),y(k,{key:0},[p("span",De,u(s.title),1),t(te,{placement:"top"},{title:o(()=>[Ke]),default:o(()=>[p("a",Se,[t(d,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1})],64)):w("",!0)]),bodyCell:o(({column:s,record:r,text:C})=>[s.dataIndex==="group"?(v(),Me(ae,{key:0,chips:r.group,"max-count":3},null,8,["chips"])):w("",!0),s.dataIndex==="phone"?(v(),y(k,{key:1},[i(u(r.countryCode)+u(r.phone),1)],64)):w("",!0),s.dataIndex==="contact"?(v(),y(k,{key:2},[i(u(r.areaCode)+u(r.contact),1)],64)):w("",!0),s.dataIndex==="gender"?(v(),y(k,{key:3},[i(u(e(ue)[C]),1)],64)):w("",!0),s.dataIndex==="isBlackList"?(v(),y(k,{key:4},[i(u(C?"黑名單":""),1)],64)):w("",!0),s.dataIndex==="note"?(v(),y(k,{key:5},[i(u(e(ve)(C)?"-":C),1)],64)):w("",!0)]),_:1},8,["dataSource","row-selection","pagination"]),t(F,{open:e(h),"onUpdate:open":a[11]||(a[11]=s=>D(h)?h.value=s:null),centered:"",title:"是否永久刪除選取的聯絡人？",width:"440px",cancelText:"取消",okText:"確定",onOk:q},{default:o(()=>[Ue]),_:1},8,["open"]),t(F,{open:e(b),"onUpdate:open":a[12]||(a[12]=s=>D(b)?b.value=s:null),centered:"",title:"是否覆蓋現有的聯絡人？",width:"440px",cancelText:"取消",okText:"確定",onOk:X},{default:o(()=>[Oe]),_:1},8,["open"])],64)}}});export{Ge as _};
