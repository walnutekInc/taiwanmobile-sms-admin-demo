import{u as se,a as le,F as de,_ as re}from"./contact-person-85f986cf.js";import{G as ie,_ as ce}from"./GenderEnum-805d453b.js";import{_ as pe}from"./index.vuevuetypescriptsetuptruelang-8504f943.js";import{j as ue,_ as me}from"./index-c55c1dea.js";import{p as _e,z as fe,r as xe,u as ye,I as we,q as he,s as ge,E as ke,F as ve,G as be,H as Ce}from"./antd-6c49adb5.js";import{d as Ie,f as h,D as Te,o as Re,r as Fe,u as a,a0 as Ue,W as _,X as f,Y as c,k as o,$ as n,G as d,a3 as i,F as x,a4 as y,_ as Me,H as V}from"./vue-c25d042e.js";const Oe={class:"flex justify-between px-2 items-center mb-2"},Ve={class:"ms-2"},De={class:"me-1"},Pe={href:"javascript:;"},Be=c("span",null,"全域黑名單功能: 主帳號將特定手機門號加入黑名單，主帳號和子帳號皆無法發送該門號任何訊息",-1),Ke=c("div",{class:"h-59px px-20px py-24px"},[c("p",{class:"text-center text-sms-grayscale-80"},"您選擇的聯絡人將直接永久刪除。")],-1),Le=c("div",{class:"h-59px px-20px py-24px"},[c("p",{class:"text-center text-sms-grayscale-80"},"聯絡人列表中，已經存在相同的聯絡人。")],-1),Ne=Ie({__name:"contact-person-archived",props:{toContactPerson:{type:Function,required:!0}},setup(D){const P=D,{contactPerson:B,pagination:K,getContactPersonArchived:L,deleteContactPerson:S,unArchivedContactPerson:Y}=se(),{getGroupLabelOption:E,groupOptions:G}=le(),R=ue(),$=h(!1);Te(async()=>{I(),await E()}),Re(()=>{$.value=!0});const A=[{title:"手機門號",dataIndex:"phone",key:"phone",sorter:!0,fixed:"left",width:"130px"},{title:"姓名",dataIndex:"name",key:"name",sorter:!0,fixed:"left",width:"80px"},{title:"群組標籤",dataIndex:"group",key:"group",fixed:"left",width:"250px"},{title:"性別",dataIndex:"gender",key:"gender",sorter:!0,width:"70px"},{title:"黑名單",dataIndex:"isBlackList",key:"isBlackList",sorter:!0,width:"100px"},{title:"聯絡電話",dataIndex:"contact",key:"contact",sorter:!0,width:"110px"},{title:"公司名稱",dataIndex:"company",key:"company",sorter:!0,ellipsis:!0,width:"121px"},{title:"Email",dataIndex:"email",key:"email",sorter:!0,ellipsis:!0,width:"184px"},{title:"生日",dataIndex:"birth",key:"birth",sorter:!0,width:"95px"},{title:"通訊地址",dataIndex:"address",key:"address",sorter:!0,ellipsis:!0,width:"108px"},{title:"備註",dataIndex:"note",key:"note",sorter:!0,width:"108px"},{title:"建立時間",dataIndex:"createTime",key:"createTime",defaultSortOrder:"descend",sorter:!0,width:"140px"},{title:"修改時間",dataIndex:"updateTime",key:"updateTime",sorter:!0,width:"140px"}],p=Fe({selectedRowKeys:[],selectedRows:[],loading:!1}),N=(r,e)=>{console.log("selectedRowKeys changed: ",r,e),p.selectedRowKeys=r,p.selectedRows=e},s=h({sortField:"createTime",sortOrder:"descend",phone:"",name:"",group:[],company:"",createTime:[void 0,void 0],updateTime:[void 0,void 0],keyword:""}),F=h(),I=async(r=1,e=10)=>{var u,v;let l={current:r,pageSize:e,...a(s),group:((v=(u=s.value)==null?void 0:u.group)==null?void 0:v.map(b=>b.id))??[]};await L(l)},j=async(r,e,l)=>{console.log("pagination:",r,"sorter:",l),s.value=Object.assign({sortField:l.field,sortOrder:l.order}),await I(r.current,r.pageSize)},U=h(!1),z=()=>{U.value=!0},q=()=>{U.value=!1,I(1)},g=h(!1),H=async()=>{var e;((e=(await S(p.selectedRows.map(l=>l.key))).data)==null?void 0:e.status)==="success"&&(g.value=!1,R.success({message:"聯絡人刪除成功",placement:"top"}))},k=h(!1),W=()=>{k.value=!0},X=async()=>{var e;((e=(await Y(p.selectedRowKeys)).data)==null?void 0:e.status)==="success"&&(R.success({message:"聯絡人回復成功",placement:"top"}),P.toContactPerson())},J=()=>{X()};return(r,e)=>{const l=me,u=pe,v=Ue("filter-input"),b=xe,Q=ye,T=we,w=he,Z=ge,M=ke,ee=ve,te=de,ae=be,oe=ce,ne=re,O=Ce;return _(),f(x,null,[c("div",Oe,[c("div",null,[o(u,{status:"small2",class:"me-2",disabled:a(p).selectedRowKeys.length===0,onClick:W},{icon:n(()=>[o(l,{name:"change",width:"16px"})]),default:n(()=>[d("回復聯絡人 ")]),_:1},8,["disabled"]),o(u,{status:"small2",class:"me-2",disabled:a(p).selectedRowKeys.length===0},{icon:n(()=>[o(l,{name:"download",width:"16px"})]),default:n(()=>[d("匯出CSV ")]),_:1},8,["disabled"]),o(u,{status:"small2",class:"me-2",onClick:e[0]||(e[0]=t=>g.value=!0),disabled:a(p).selectedRowKeys.length===0},{icon:n(()=>[o(l,{name:"delete",width:"16px"})]),default:n(()=>[d("永久刪除 ")]),_:1},8,["disabled"])]),o(te,{class:"w-440px h-40px",modelValue:a(s).keyword,"onUpdate:modelValue":e[8]||(e[8]=t=>a(s).keyword=t),onClick:z,placeholder:"搜尋門號、姓名、公司、通訊地址、Email、備註",onClearFilter:e[9]||(e[9]=()=>{var t;a(s).keyword="",(t=a(F))==null||t.resetFields()})},{filterForm:n(()=>[o(ee,{ref_key:"formRef",ref:F,layout:"vertical",model:a(s),wrapperCol:{span:24},autocomplete:"off"},{default:n(()=>[o(Q,null,{default:n(()=>[o(b,{span:25},{default:n(()=>[o(v,{modelValue:a(s).name,"onUpdate:modelValue":e[1]||(e[1]=t=>a(s).name=t)},null,8,["modelValue"])]),_:1})]),_:1}),o(w,{name:"phone",label:"手機門號",class:"mb-2"},{default:n(()=>[o(T,{placeholder:"手機門號",value:a(s).phone,"onUpdate:value":e[2]||(e[2]=t=>a(s).phone=t),name:"phone",class:"rounded-2"},null,8,["value"])]),_:1}),o(w,{name:"name",label:"姓名",class:"mb-2"},{default:n(()=>[o(T,{placeholder:"姓名",value:a(s).name,"onUpdate:value":e[3]||(e[3]=t=>a(s).name=t),class:"rounded-2"},null,8,["value"])]),_:1}),o(w,{name:"group",label:"群組標籤",class:"mb-2"},{default:n(()=>[o(Z,{placeholder:"群組標籤",options:a(G),maxTagCount:2,showArrow:!0,mode:"tags",value:a(s).group,"onUpdate:value":e[4]||(e[4]=t=>a(s).group=t),class:"w-full ant-select-filter"},{menuItemSelectedIcon:n(()=>[d(i(""))]),suffixIcon:n(()=>{var t,m;return[c("div",Ve,[d(i(((t=a(s).group)==null?void 0:t.length)>0?`已選擇(${(m=a(s).group)==null?void 0:m.length})`:"")+" ",1),o(a(_e))])]}),_:1},8,["options","value"])]),_:1}),o(w,{name:"company",label:"公司名稱",class:"mb-2"},{default:n(()=>[o(T,{placeholder:"公司名稱",value:a(s).company,"onUpdate:value":e[5]||(e[5]=t=>a(s).company=t),class:"rounded-2"},null,8,["value"])]),_:1}),o(w,{name:"createTime",label:"建立時間",class:"mb-2"},{default:n(()=>[o(M,{class:"w-full",placeholder:["建立時間","建立時間"],value:a(s).createTime,"onUpdate:value":e[6]||(e[6]=t=>a(s).createTime=t),placement:"topLeft",format:"YYYY-MM-DD"},null,8,["value"])]),_:1}),o(w,{name:"updateTime",label:"修改時間",class:"mb-2"},{default:n(()=>[o(M,{class:"w-full",placeholder:["修改時間","修改時間"],value:a(s).updateTime,"onUpdate:value":e[7]||(e[7]=t=>a(s).updateTime=t),placement:"topLeft",format:"YYYY-MM-DD"},null,8,["value"])]),_:1}),o(b,{class:"text-center"},{default:n(()=>[o(u,{status:"small2",class:"me-5"},{default:n(()=>[d("取消")]),_:1}),o(u,{status:"small1",onClick:q},{default:n(()=>[d("確定")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),o(ne,{dataSource:a(B),columns:A,scroll:{x:1500},size:"small",showSorterTooltip:!1,"row-selection":{selectedRowKeys:a(p).selectedRowKeys,onChange:N},onChange:j,pagination:{...a(K)}},{headerCell:n(({column:t})=>[t.key==="isBlackList"?(_(),f(x,{key:0},[c("span",De,i(t.title),1),o(ae,{placement:"top"},{title:n(()=>[Be]),default:n(()=>[c("a",Pe,[o(l,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1})],64)):y("",!0)]),bodyCell:n(({column:t,record:m,text:C})=>[t.dataIndex==="group"?(_(),Me(oe,{key:0,chips:m.group,"max-count":3},null,8,["chips"])):y("",!0),t.dataIndex==="phone"?(_(),f(x,{key:1},[d(i(m.countryCode)+i(m.phone),1)],64)):y("",!0),t.dataIndex==="contact"?(_(),f(x,{key:2},[d(i(m.areaCode)+i(m.contact),1)],64)):y("",!0),t.dataIndex==="gender"?(_(),f(x,{key:3},[d(i(a(ie)[C]),1)],64)):y("",!0),t.dataIndex==="isBlackList"?(_(),f(x,{key:4},[d(i(C?"黑名單":""),1)],64)):y("",!0),t.dataIndex==="note"?(_(),f(x,{key:5},[d(i(a(fe)(C)?"-":C),1)],64)):y("",!0)]),_:1},8,["dataSource","row-selection","pagination"]),o(O,{open:a(g),"onUpdate:open":e[10]||(e[10]=t=>V(g)?g.value=t:null),centered:"",title:"是否永久刪除選取的聯絡人？",width:"440px",cancelText:"取消",okText:"確定",onOk:H},{default:n(()=>[Ke]),_:1},8,["open"]),o(O,{open:a(k),"onUpdate:open":e[11]||(e[11]=t=>V(k)?k.value=t:null),centered:"",title:"是否覆蓋現有的聯絡人？",width:"440px",cancelText:"取消",okText:"確定",onOk:J},{default:n(()=>[Le]),_:1},8,["open"])],64)}}});export{Ne as _};
