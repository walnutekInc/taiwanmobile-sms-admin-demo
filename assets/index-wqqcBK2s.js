import{_ as ee}from"./index.vuevuetypescriptsetuptruelang-JnDo2bMi.js";import{d as F,W as p,X as u,Y as e,Q as D,u as s,a4 as C,f as T,D as te,_ as se,$ as t,k as n,G as M,F as $,a9 as N,a5 as R,a3 as y,y as oe}from"./vue-Ckfa8DnP.js";import{j as ae,_ as ne}from"./index-CPwuV5tw.js";import{u as le,F as re}from"./request-DTtdgrKt.js";import{_ as ie}from"./index.vuevuetypescriptsetuptruelang-CGx5Uo-M.js";import{_ as ce}from"./index-Dvyv9X6Z.js";import{i as me}from"./isToday-DHzkRyxX.js";import{z as de,c as pe,E as a,p as ue,o as _e,I as fe,G as Ye,r as ge,F as he,H as ye,J as xe}from"./antd-CCbBcq8G.js";import{g as De,a as G}from"./tools-a0gbWjD6.js";import"./context-DnAYe9nW.js";const Me="/taiwanmobile-sms-admin-demo/assets/active-message-DLmXlPTI.png",ve={class:"flex max-h-530px 2xl:max-h-720px"},ke={class:"w-1/2 bg-sms-grayscale-0 rounded-3 px-4 me-6"},be={class:"h-400px 2xl:h-590px overflow-y-auto message-content"},we={class:"w-1/2 p-4 bg-sms-grayscale-0 rounded-3 px-4"},Te={key:0,class:"h-full w-full flex items-center justify-center"},Ce={class:"text-center"},Ee=["src"],$e={class:"font-400 text-base text-sms-grayscale-80"},Re={key:2,id:"message-content",class:"h-400px 2xl:h-590px overflow-y-auto message-content"},Le=F({name:"MessageContainer",__name:"index",props:{showRightEmpty:{type:Boolean,default:!1}},setup(m){return(r,x)=>(p(),u("div",ve,[e("div",ke,[D(r.$slots,"leftTop"),e("div",be,[D(r.$slots,"left")]),D(r.$slots,"leftBottom")]),e("div",we,[m.showRightEmpty?(p(),u("div",Te,[e("div",Ce,[e("img",{src:s(Me),class:"w-80px mb-4"},null,8,Ee),e("p",$e,[D(r.$slots,"rightEmptyMessage")])])])):C("",!0),m.showRightEmpty?C("",!0):D(r.$slots,"rightTop",{key:1}),m.showRightEmpty?C("",!0):(p(),u("div",Re,[D(r.$slots,"right")])),m.showRightEmpty?C("",!0):D(r.$slots,"rightBottom",{key:3})])]))}});var Se={exports:{}};(function(m,r){(function(x,g){m.exports=g(de)})(pe,function(x){function g(i){return i&&typeof i=="object"&&"default"in i?i:{default:i}}var v=g(x),k={name:"zh-tw",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"週日_週一_週二_週三_週四_週五_週六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(i,_){return _==="W"?i+"週":i+"日"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日dddd HH:mm",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s內",past:"%s前",s:"幾秒",m:"1 分鐘",mm:"%d 分鐘",h:"1 小時",hh:"%d 小時",d:"1 天",dd:"%d 天",M:"1 個月",MM:"%d 個月",y:"1 年",yy:"%d 年"},meridiem:function(i,_){var f=100*i+_;return f<600?"凌晨":f<900?"早上":f<1100?"上午":f<1300?"中午":f<1800?"下午":"晚上"}};return v.default.locale(k,null,!0),k})})(Se);a.locale("zh-tw");var j=(m=>(m.READ="已讀",m.UNREAD="未讀",m))(j||{});const He=[{key:"1",phone:"0963-123-123",content:"您好，我想索取試用品DM和序號",unreadCount:0,createTime:a().format("YYYY/MM/DD"),updateTime:a().format("YYYY/MM/DD")},{key:"2",phone:"0928-391-699",content:"請問活動截止日期到什麼時候 ?",unreadCount:2,createTime:a().format("YYYY/MM/DD"),updateTime:a().format("YYYY/MM/DD")},{key:"3",phone:"0938-127-498",content:`請問上個月的抽獎結果什麼時候會公佈？
網路上已經看到外洩的名單，但官方似乎沒有正式公告，希望主辦單位可以即時通知我們網路上已經看到外洩的名單，但官方似乎沒有正式公告，希望主辦單位可以即時通知我們網路上已經看到外洩的名單，但官方似乎沒有正式公告，希望主辦單位可以即時通知我們網路上已經看到外洩的名單，但官方似乎沒有正式公告，希望主辦單位可以即時通知我們網路上已經看到外洩的名單，但官方似乎沒有正式公告，希望主辦單位可以即時通知我們`,unreadCount:5,createTime:a().subtract(2,"d").format("YYYY/MM/DD"),updateTime:a().format("YYYY/MM/DD")},{key:"4",phone:"0958-128-815",content:`黃茵茵
huangyiyi@gmail.com`,unreadCount:0,createTime:a().subtract(3,"d").format("YYYY/MM/DD"),updateTime:a().format("YYYY/MM/DD")},{key:"5",phone:"0963-123-123",content:"您好，我想索取試用品DM和序號",unreadCount:0,createTime:a().subtract(4,"d").format("YYYY/MM/DD"),updateTime:a().format("YYYY/MM/DD")},{key:"6",phone:"0937-129-488",content:"我要參加活動，請通知下一步",unreadCount:0,createTime:a().subtract(5,"d").format("YYYY/MM/DD"),updateTime:a().format("YYYY/MM/DD")},{key:"7",phone:"0937-129-488",content:"我要參加活動，請通知下一步",unreadCount:0,createTime:a().subtract(5,"d").format("YYYY/MM/DD"),updateTime:a().format("YYYY/MM/DD")},{key:"8",phone:"0937-129-488",content:"我要參加活動，請通知下一步",unreadCount:0,createTime:a().subtract(5,"d").format("YYYY/MM/DD"),updateTime:a().format("YYYY/MM/DD")},{key:"9",phone:"0937-129-488",content:"我要參加活動，請通知下一步",unreadCount:0,createTime:a().subtract(5,"d").format("YYYY/MM/DD"),updateTime:a().format("YYYY/MM/DD")},{key:"10",phone:"0937-129-488",content:"我要參加活動，請通知下一步",unreadCount:0,createTime:a().subtract(5,"d").format("YYYY/MM/DD"),updateTime:a().format("YYYY/MM/DD")},{key:"11",phone:"0937-129-488",content:"我要參加活動，請通知下一步",unreadCount:0,createTime:a().subtract(5,"d").format("YYYY/MM/DD"),updateTime:a().format("YYYY/MM/DD")}],Be={[a().format("YYYY/MM/DD (dd)")]:[{key:"1",phone:"0961-238-888",type:"SENT",message:`親愛的會員您好，邀請您參加活動，若想參加請回覆 12:00pm
親愛的會員您好，邀請您參加活動，若想參加請回覆 12:00pm`},{key:"2",phone:"",type:"GET",message:"是的，我想參加活動"},{key:"3",phone:"",type:"GET",message:`何小偉 
 kkk@gmail.com`},{key:"4",phone:"0961-238-888",type:"SENT",message:"您好，請回覆您的姓名與Email"}],今天:[{key:"1",phone:"0961-238-888",type:"SENT",message:`親愛的會員您好，邀請您參加活動，若想參加請回覆 12:00pm
親愛的會員您好，邀請您參加活動，若想參加請回覆 12:00pm`},{key:"2",phone:"",type:"GET",message:"是的，我想參加活動"},{key:"3",phone:"",type:"GET",message:`何小偉 
 kkk@gmail.com`},{key:"4",phone:"0961-238-888",type:"SENT",message:"您好，請回覆您的姓名與Email"}]};function Ne(){const m=ae(),{list:r,pagination:x,setResponseList:g}=le();return{getChatMessages:async _=>{g({total:11,pages:1,current:1,pageSize:10,records:He})},chatMessages:r,pagination:x,getChatMessageHistory:async _=>(console.log(_),Be),updateChatMessageUnRead:async _=>{_.unreadCount>0&&(m.updateUnReadCount(0),r.value=r.value.map(f=>({...f,...f.key===_.key&&{unreadCount:0}})))}}}const je=e("span",{"text-24px":"","line-height-28px":"","mr-12px":"","mb-0":"","font-700":"","text-sms-grayscale-100":""},"雙向訊息",-1),Ue=e("span",{"text-sm":"","text-sms-primary-blue-80":"","font-400":""},"※不區分帳號是否使用共用門號，只認發送門號全部顯示",-1),Ge={class:"pt-4 flex items-center pb-3"},Fe=["onClick"],Ve={class:"flex flex-col gap-4"},Ae={class:"flex justify-between items-center mb-2"},Ie={class:"font-600 text-sm pe-2"},ze={key:0,class:"text-xs bg-sms-green-30 px-2 py-1 rounded-2 text-sms-green-80"},Pe={key:1,class:"text-xs bg-sms-light-red-20 px-2 py-1 rounded-2 text-sms-light-red-70"},Ke={class:"text-sms-grayscale-60 font-500 text-xs"},Oe={class:"font-400 text-sm text-sms-grayscale-80 tracking-[0.02em] whitespace-pre-wrap line-clamp-2"},We={class:"text-end pb-6"},Xe=e("br",null,null,-1),Je={class:"flex justify-between items-center border-b-solid border-b-1 border-b-sms-light-gray-60 pb-4"},Qe={class:"flex flex-col"},qe=e("span",{class:"font-400 text-sm tracking-[0.02em] pe-2 text-sms-grayscale-80"},"接收門號",-1),Ze={href:"javascript:;"},et=e("span",null,"檢視三個月內，與該門號的所有雙向訊息",-1),tt={class:"font-inter font-400 text-base"},st={href:"javascript:;"},ot=e("span",null,"下載三年內，與該門號的雙向訊息紀錄",-1),at={key:0,id:"chat-message-content",class:"pt-4"},nt={class:"text-center mb-4"},lt={class:"text-sm tracking-[0.02em] text-sms-grayscale-0 bg-sms-grayscale-40 rounded-38px px-2 py-1.5"},rt={class:"text-sms-grayscale-60 text-sm font-400 font-inter text-sm text-right"},it=e("span",{class:"text-xs font-500 text-sms-grayscale-40"},"08:00",-1),ct={class:"text-end"},xt=F({__name:"index",setup(m){a.extend(me);const r=T(),x=T(),g=T(),v=[{value:"READ",label:j.READ},{value:"UNREAD",label:j.UNREAD}],{getChatMessages:k,pagination:i,chatMessages:_,getChatMessageHistory:f,updateChatMessageUnRead:V}=Ne(),L=T(),c=T({keyword:"",status:void 0,phone:"",sendDate:void 0});te(()=>{S()});async function S(d=1,l=10){const H={current:d,pageSize:l,...s(c)};await k(H)}function A(d,l){S(d,l)}function I(){var d;S(1),(d=g.value)==null||d.hide()}async function z(d){r.value=d,await V(d),L.value=await f(d.key),await oe();const l=document.getElementById("message-content");l&&(l.scrollTop=l.scrollHeight)}function P(d){const l=a().subtract(3,"month");return d<=l}return(d,l)=>{const H=ue,B=ce,E=_e,K=fe,O=Ye,b=ie,W=ge,X=he,J=re,w=ne,Q=ye,U=xe,q=Le,Z=ee;return p(),se(Z,{title:"雙向訊息"},{title:t(()=>[je,Ue]),default:t(()=>[n(q,{"show-right-empty":!s(r)},{leftTop:t(()=>[e("div",Ge,[n(J,{ref_key:"filterKeywordInputRef",ref:g,modelValue:s(c).keyword,"onUpdate:modelValue":l[4]||(l[4]=o=>s(c).keyword=o),height:"40px",class:"flex-1 me-2",placeholder:"搜尋訊息內容",onClearFilter:l[5]||(l[5]=()=>{c.value={...s(c),phone:"",status:void 0,sendDate:void 0,keyword:""}})},{filterForm:t(()=>[n(X,{ref_key:"formRef",ref:x,layout:"vertical",model:s(c),autocomplete:"off"},{default:t(()=>[n(W,{gutter:[16,12]},{default:t(()=>[n(E,{span:24},{default:t(()=>[n(B,{label:"訊息狀態",valueed:s(De)(s(c).status,v)},{default:t(()=>[n(H,{value:s(c).status,"onUpdate:value":l[0]||(l[0]=o=>s(c).status=o),options:v,"max-tag-count":2,"show-arrow":!0,"show-search":!1,class:"w-full"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),n(E,{span:24},{default:t(()=>[n(B,{label:"接收門號",valueed:s(c).phone},{default:t(()=>[n(K,{value:s(c).phone,"onUpdate:value":l[1]||(l[1]=o=>s(c).phone=o)},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),n(E,{span:24},{default:t(()=>[n(B,{label:"訊息發送日期",valueed:s(c).sendDate},{default:t(()=>[n(O,{value:s(c).sendDate,"onUpdate:value":l[2]||(l[2]=o=>s(c).sendDate=o),class:"w-full",placement:"topLeft",format:"YYYY-MM-DD","value-format":"YYYY/MM/DD","disabled-date":P},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),n(E,{span:24,class:"text-center"},{default:t(()=>[n(b,{status:"small2",class:"me-5",onClick:l[3]||(l[3]=o=>{var Y;return(Y=s(g))==null?void 0:Y.hide()})},{default:t(()=>[M(" 取消 ")]),_:1}),n(b,{status:"small1",onClick:I},{default:t(()=>[M(" 確定 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),n(b,{status:"small1"},{icon:t(()=>[n(w,{name:"plus",width:"16px"})]),default:t(()=>[M(" 新增訊息 ")]),_:1})])]),left:t(()=>[e("ul",null,[(p(!0),u($,null,N(s(_),o=>{var Y;return p(),u("li",{key:o.key,class:R(["p-4 border-b-solid border-b-1 border-b-sms-light-gray-60 last:mb-2 cursor-pointer",{"bg-sms-bg-light-mode-gray":o.key===((Y=s(r))==null?void 0:Y.key)}]),onClick:h=>z(o)},[e("div",Ve,[e("div",Ae,[e("div",null,[e("span",Ie,y(o.phone),1),o.unreadCount===0?(p(),u("span",ze,"已讀")):(p(),u("span",Pe,"未讀 "+y(o.unreadCount),1))]),e("span",Ke,y(s(a)(o.createTime).isToday()?"今天":s(a)(o.createTime).format("YYYY/MM/DD")),1)]),e("div",Oe,y(o.content),1)])],10,Fe)}),128))])]),leftBottom:t(()=>[e("div",We,[n(Q,{current:s(i).current,"onUpdate:current":l[6]||(l[6]=o=>s(i).current=o),total:s(i).total,"show-total":o=>{var Y;return`${(Y=s(i))==null?void 0:Y.countRange}筆 / ${o}筆`},onChange:A},null,8,["current","total","show-total"])])]),rightEmptyMessage:t(()=>[M(" 點擊左側接收門號列表"),Xe,M("檢視雙向訊息 ")]),rightTop:t(()=>{var o;return[e("div",Je,[e("div",Qe,[e("div",null,[qe,n(U,{placement:"top","get-popup-container":s(G)},{title:t(()=>[et]),default:t(()=>[e("a",Ze,[n(w,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),e("div",tt,y((o=s(r))==null?void 0:o.phone),1)]),e("div",null,[n(b,{status:"small2",class:"me-2"},{icon:t(()=>[n(w,{name:"download",width:"16px"})]),default:t(()=>[M(" 下載CSV ")]),_:1}),n(U,{placement:"topRight","get-popup-container":s(G),"merged-arrow":!0},{title:t(()=>[ot]),default:t(()=>[e("a",st,[n(w,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])])])]}),right:t(()=>[s(L)?(p(),u("div",at,[(p(!0),u($,null,N(Object.entries(s(L)),([o,Y])=>(p(),u($,{key:o},[e("div",nt,[e("span",lt,y(o),1)]),(p(!0),u($,null,N(Y,h=>(p(),u("div",{key:h.key,class:R(["flex flex-col mb-4",{"me-20 ":h.type==="GET","ms-20 ":h.type==="SENT"}])},[e("div",rt,y(h.phone),1),e("div",{class:R(["flex w-full items-end justify-end gap-2",{"flex-row-reverse ":h.type==="GET"}])},[it,e("div",{class:R(["bg-sms-grayscale-20 py-3 px-3 rounded-2 whitespace-pre-wrap text-17px",{"bg-sms-primary-blue-20":h.type==="SENT"}])},y(h.message),3)],2)],2))),128))],64))),128))])):C("",!0)]),rightBottom:t(()=>[e("div",ct,[n(b,{status:"small1"},{icon:t(()=>[n(w,{name:"edit",width:"16px"})]),default:t(()=>[M(" 回覆訊息 ")]),_:1})])]),_:1},8,["show-right-empty"])]),_:1})}}});export{xt as default};
