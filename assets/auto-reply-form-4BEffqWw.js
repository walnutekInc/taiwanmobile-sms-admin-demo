import{_ as Ye}from"./index.vuevuetypescriptsetuptruelang-JnDo2bMi.js";import{_ as ye,h as qe,k as He}from"./index-CPwuV5tw.js";import{d as ae,f as F,W as c,X as k,F as V,Y as o,u as e,a3 as E,a4 as M,m as ne,A as se,k as n,a5 as ge,_ as K,a9 as ve,K as We,c as J,a7 as De,$ as a,Q as Qe,ag as Je,ah as Xe,ab as q,G as u,r as X,H as $e,ad as Ze,ac as et,D as tt,w as nt,B as st}from"./vue-Ckfa8DnP.js";import{u as at,_ as ot,a as lt,b as it,c as rt,d as ut}from"./route-leave-CXybySMb.js";import{_ as Te}from"./index.vuevuetypescriptsetuptruelang-CGx5Uo-M.js";import{O as je,P as pt,x as ct,T as dt,N as Re,E as be,Q as mt,K as P,U as ft,y as _t,V as gt,p as vt,n as yt,o as xt,J as ht,I as bt,B as wt,G as kt,w as $t,W as Tt,r as Ct,F as St}from"./antd-CCbBcq8G.js";import{i as Ft}from"./isToday-DHzkRyxX.js";import{u as Mt,r as we}from"./custom-message-xqVvFHok.js";import{u as jt,M as Dt}from"./auto-reply-cRG_hSaW.js";import{a as ke}from"./tools-a0gbWjD6.js";import{u as Rt}from"./group-label-CM8fRz7z.js";import"./context-DnAYe9nW.js";import"./index.esm-D-mEzxO1.js";import"./index.vuevuetypestyleindex0lang-B6Nhna9q.js";import"./request-DTtdgrKt.js";const Pt={class:"relative w-full h-full"},It=["controls","src"],At={key:0,class:"text-sms-grayscale-60 font-500 text-base text-center pt-2"},Nt={key:0,class:"text-sms-grayscale-60 font-500 text-base text-center pb-2"},Ut=["src"],Ce=ae({name:"MultimediaPreview",__name:"index",props:{videoSource:{},showDelBtn:{type:Boolean,default:!0},showFileName:{type:Boolean,default:!0},canPlay:{type:Boolean,default:!0},imageClass:{default:"w-full"},size:{default:"large"}},emits:["deleteVideo"],setup(x,{emit:$}){const g=x,b=$,h=F(!1),r=F();function m(p){h.value=!p.target.paused}function f(){var p;g.canPlay&&((p=r.value)==null||p.play())}function v(){b("deleteVideo")}return(p,w)=>{const H=ye;return c(),k("div",Pt,[p.videoSource.type==="video"?(c(),k(V,{key:0},[o("video",{id:"video",ref_key:"videoRef",ref:r,class:"w-full h-full bg-sms-grayscale-100",controls:e(h),src:p.videoSource.url,onPlaying:m,onPause:m},null,40,It),p.showFileName?(c(),k("div",At,E(p.videoSource.fileName)+" ("+E(p.videoSource.fileSize)+") ",1)):M("",!0),ne(n(H,{name:"play-circle",width:p.size==="large"?"80px":"35px",class:"absolute top-50% left-50% translate-x-[-50%] translate-y-[-50%] cursor-pointer",onClick:f},null,8,["width"]),[[se,!e(h)]])],64)):p.videoSource.url?(c(),k(V,{key:1},[p.showFileName?(c(),k("div",Nt,E(p.videoSource.fileName)+" ("+E(p.videoSource.fileSize)+") ",1)):M("",!0),o("img",{src:p.videoSource.url,class:ge(p.imageClass)},null,10,Ut)],64)):M("",!0),p.showDelBtn?(c(),K(H,{key:2,name:"close-circle",width:p.size==="large"?"32px":"16px",status:"small3",class:"absolute top-1 right-1 text-sms-grayscale-60 cursor-pointer",onClick:v},null,8,["width"])):M("",!0)])}}}),zt="/taiwanmobile-sms-admin-demo/assets/full-phone-rT6RnVLp.png",Ot=["src"],Bt={class:"max-h-706px overflow-auto absolute top-[150px] left-[30px] w-[calc(100%-50px)]"},Kt={class:"text-sms-grayscale-60 text-sm font-400 font-inter text-sm text-right"},Et=["innerHTML"],Lt=ae({name:"FullPhonePreview",__name:"index",props:{message:{type:Array,default:()=>[]}},setup(x){function $(g="",b){return b?`<div class="font-700 text-17px font-sans">${b}</div>${g}`:g}return(g,b)=>{const h=Ce;return c(),k(V,null,[o("img",{src:e(zt),class:"w-428px"},null,8,Ot),o("div",Bt,[(c(!0),k(V,null,ve(x.message,r=>(c(),k("div",{key:r.key,class:ge(["flex flex-col mb-4",{"me-48px ms-5px":r.messageType==="GET","ms-48px me-20px":r.messageType==="SENT"}])},[o("div",Kt,E(r.phone),1),o("div",{class:ge(["flex w-full items-end justify-end gap-4",{"flex-row-reverse ":r.messageType==="GET"}])},[r.contentType==="text"?(c(),k("div",{key:0,class:ge(["bg-sms-grayscale-20 w-214px py-3 px-3 rounded-2 text-17px break-words",{"bg-sms-primary-blue-20":r.messageType==="SENT"}]),innerHTML:$(r.content,r.subject)},null,10,Et)):r.content?(c(),K(h,{key:1,"video-source":{url:r.content,type:r.contentType},"show-file-name":!1,"show-del-btn":!1,"can-play":!1,"image-class":"w-50% block ms-auto"},null,8,["video-source"])):M("",!0)],2)],2))),128))])],64)}}}),Vt=ae({name:"TLiteTable",extends:je,inheritAttrs:!1,__name:"index",setup(x){const $=We(),g=J(()=>({...e($)}));return(b,h)=>(c(),K(e(je),q({class:"t-lite-table"},{...b.$props,...e(g),pagination:!1}),De({_:2},[ve(Object.keys(b.$slots),r=>({name:r,fn:a(m=>[Qe(b.$slots,r,Je(Xe(m||{})))])}))]),1040))}}),Gt=o("span",{class:"text-red-500"},"*",-1),Yt=["accept"],qt={for:"fileInput",class:"flex flex-col items-center justify-center h-full text-sms-grayscale-80 text-sm"},Ht=o("p",{class:""}," 拖曳圖片至此 ",-1),Wt=o("p",{class:""}," 拖曳影音至此 ",-1),Qt=ae({name:"DropFile",__name:"index",props:{uploadType:{type:String,default:"image"}},emits:["changeFile"],setup(x,{emit:$}){const g=x,b=$,h=[".jpg",".jpeg",".png",".gif"],r=[".mp4",".mp3"],m=F(),f=F(!1);function v(j){const U=j.target.files;U&&U.length>0&&m.value&&(b("changeFile",U),m.value.value="")}function p(j){j.preventDefault(),f.value=!0}function w(){f.value=!1}function H(j){var I,U;if(j.preventDefault(),m.value&&((I=j==null?void 0:j.dataTransfer)!=null&&I.files)){const D=[];for(const y of j.dataTransfer.files){const t=(U=y.name)==null?void 0:U.split(".").pop();g.uploadType==="image"?h.includes(`.${t}`)&&D.push(y):r.includes(`.${t}`)&&D.push(y)}D.length>0&&b("changeFile",D)}f.value=!1}return(j,I)=>{const U=ye,D=Te;return c(),k(V,null,[o("label",null,[u(E(x.uploadType==="image"?"上傳檔案":"上傳影音")+" ",1),Gt]),o("div",{class:"dropzone-container",onDragover:p,onDragleave:w,onDrop:H},[o("input",{id:"fileInput",ref_key:"file",ref:m,type:"file",name:"file",class:"hidden",accept:x.uploadType==="image"?h.join(","):r.join(","),onChange:v},null,40,Yt),o("div",qt,[n(U,{name:"upload-circle",width:"40px",class:"block mb-4",color:"var(--grayscale-40)"}),x.uploadType==="image"?(c(),k(V,{key:0},[Ht,o("p",null,[u(" 或點擊"),n(D,{class:"mx-2",onClick:I[0]||(I[0]=y=>{var t;return(t=e(m))==null?void 0:t.click()})},{default:a(()=>[u(" 開啟資料夾 ")]),_:1}),u("選擇圖片 ")])],64)):M("",!0),x.uploadType==="video"?(c(),k(V,{key:1},[Wt,o("p",null,[u(" 或點擊"),n(D,{class:"mx-2",onClick:I[1]||(I[1]=y=>{var t;return(t=e(m))==null?void 0:t.click()})},{default:a(()=>[u(" 開啟資料夾 ")]),_:1}),u("選擇影音 ")])],64)):M("",!0)])],32)],64)}}});function Jt(x){let $,g;return h=>({draggable:!0,ondrag(){$=h},ondrop(){g=h},ondragend(){if($&&g&&$!==g){const r=x.indexOf($),m=x.indexOf(g);[x[r],x[m]]=[x[m],x[r]],$=void 0,g=void 0}},ondragover(){return!1}})}const Xt={class:"px-20px pb-24px"},Zt={class:"text-sms-grayscale-80 font-400 text-base text-center"},en=o("br",null,null,-1),tn={class:"text-sms-primary-blue-80 font-700"},nn={class:"text-sms-primary-blue-80 font-700"},sn={class:"text-sms-primary-blue-80 font-700"},an={class:"text-sms-status-alert-red text-sm font-400 text-center mt-4"},on=o("p",{class:"text-sms-grayscale-80 font-400 text-base"}," 可上傳 2 張圖片，格式為 jpg、png、gif ",-1),ln=o("p",{class:"text-sms-grayscale-80 font-400 text-base"}," 可上傳 1 個影音，格式為 mp4、mp3 ",-1),rn={key:1,class:"h-auto"},un=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"}," 刪除的檔案將無法復原 ",-1),pn={key:0,class:"text-center py-40px w-523px h-auto text-base mx-auto"},cn=ae({__name:"multimedia-upload-modal",emits:["updateMultimediaFile"],setup(x,{expose:$,emit:g}){const b=g;function h(_){return _===0?"0KB":`${Number.parseFloat((_/1024**1).toFixed(0))}KB`}const r=F("image"),m=F(!1),f=X([]),v=X([]),p=F(!1),w=J(()=>{let _=v.reduce((i,T)=>i+(T==null?void 0:T.size),0);return _=f.reduce((i,T)=>i+(T==null?void 0:T.size),_),_});function H(_){for(const i of _)v.push({key:v.length+1,fileName:i.name,size:i.size,fileSize:h(i.size),file:i,type:"image",url:URL.createObjectURL(i)})}function j(_){if(_.length>0){const i=_[0];f.push({key:f.length+1,fileName:i.name,size:i.size,fileSize:h(i.size),file:i,type:"video",url:URL.createObjectURL(i)})}}function I(_){v.length=0;const i=Object.assign([],_.filter(G=>G.type==="image"));v.push(...i),f.length=0;const T=Object.assign([],_.filter(G=>G.type==="video"));f.push(...T),m.value=!0}const D=[{title:"拖曳順序",dataIndex:"drop",key:"drop",width:"80px",customCell:Jt(v)},{title:"檔案名稱",dataIndex:"fileName",key:"fileName",width:"200px",ellipsis:!0},{title:"檔案大小",dataIndex:"fileSize",key:"fileSize",width:"80px"},{title:"預覽",dataIndex:"preview",key:"preview",width:"60px"},{title:"刪除",dataIndex:"del",key:"del",width:"60px"}],y=X({open:!1,type:"image",index:0,delAll:!1});function t(_,i,T){Object.assign(y,{open:!0,type:i,delAll:_,index:T})}function Z(){y.delAll?(v.length=0,f.length=0,z()):y.type==="image"?v.splice(y.index,1):f.splice(y.index,1),y.open=!1}function xe(_){_.stopImmediatePropagation(),v.length>0||f.length>0?t(!0):m.value=!1}function z(){if(p.value=!1,Number.parseInt(h(w.value).replace("KB",""))>300){p.value=!0;return}b("updateMultimediaFile",e(v).concat(e(f))),m.value=!1}const W=X({open:!1,file:void 0});return $({show:I}),(_,i)=>{const T=Qt,G=ye,Y=Te,ue=Vt,pe=ct,oe=Ce,ce=dt,le=Re;return c(),k(V,null,[n(le,{open:e(m),"onUpdate:open":i[2]||(i[2]=C=>$e(m)?m.value=C:null),title:"多媒體附件上傳",centered:"",width:"600px","cancel-text":"取消","ok-text":"確定",onOk:z,onCancel:i[3]||(i[3]=C=>p.value=!1)},{closeIcon:a(()=>[n(e(pt),{class:"ant-modal-close-icon text-black",onClick:xe})]),default:a(()=>[o("div",Xt,[o("div",Zt,[u(" 請注意，MMS 多媒體附件 (圖片檔/影音檔)，總大小不可超過 300KB "),en,u(" 目前已上傳 "),o("span",tn,E(e(v).length),1),u(" 個圖片檔、"),o("span",nn,E(e(f).length),1),u(" 個影音檔，共 "),o("span",sn,E(h(e(w))),1)]),ne(o("div",an," 超過 300KB 上限，請修正 ",512),[[se,e(p)]])]),n(ce,{activeKey:e(r),"onUpdate:activeKey":i[1]||(i[1]=C=>$e(r)?r.value=C:null),type:"card","destroy-inactive-tab-pane":!0,class:"full-border-tab last-child-rounded"},{default:a(()=>[n(pe,{key:"image",tab:"圖片"},{default:a(()=>[on,e(v).length<2?(c(),K(T,{key:0,"upload-type":"image",onChangeFile:H})):M("",!0),ne(n(ue,{columns:D,"data-source":e(v)},{bodyCell:a(({column:C,index:de,record:he})=>[C.dataIndex==="drop"?(c(),K(Y,{key:0,status:"small3"},{icon:a(()=>[n(G,{name:"menu",class:"text-sms-grayscale-100",width:"16px"})]),_:1})):M("",!0),C.dataIndex==="preview"?(c(),K(Y,{key:1,status:"small3",onClick:me=>{e(W).file=he,e(W).open=!0}},{icon:a(()=>[n(G,{name:"preview-blue",class:"text-sms-primary-blue-80"})]),_:2},1032,["onClick"])):M("",!0),C.dataIndex==="del"?(c(),K(Y,{key:2,status:"small3",onClick:me=>t(!1,"image",de)},{icon:a(()=>[n(G,{name:"del-blue",class:"text-sms-primary-blue-80"})]),_:2},1032,["onClick"])):M("",!0)]),_:1},8,["data-source"]),[[se,e(v).length>0]])]),_:1},8,["tab"]),n(pe,{key:"video",tab:"影音"},{default:a(()=>[ln,e(f).length<1?(c(),K(T,{key:0,"upload-type":"video",onChangeFile:j})):M("",!0),e(f).length>0?(c(),k("div",rn,[n(oe,{"video-source":e(f)[0],onDeleteVideo:i[0]||(i[0]=C=>t(!1,"video",0))},null,8,["video-source"])])):M("",!0)]),_:1},8,["tab"])]),_:1},8,["activeKey"])]),_:1},8,["open"]),n(le,{open:e(y).open,"onUpdate:open":i[4]||(i[4]=C=>e(y).open=C),title:e(y).delAll?"是否刪除所有已上傳的檔案？":"是否刪除已上傳的檔案？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onOk:Z},{default:a(()=>[un]),_:1},8,["open","title"]),n(le,{open:e(W).open,"onUpdate:open":i[5]||(i[5]=C=>e(W).open=C),title:" ",centered:"",footer:null,width:"960px"},{default:a(()=>[e(W).file?(c(),k("div",pn,[n(oe,{"video-source":e(W).file,"show-del-btn":!1,"image-class":"h-auto w-auto max-w-full"},null,8,["video-source"])])):M("",!0)]),_:1},8,["open"])],64)}}}),dn=o("span",{class:"pe-.5"},"接收關鍵字",-1),mn=o("span",{class:"text-red-500 pe-2"},"*",-1),fn={href:"javascript:;"},_n=o("br",null,null,-1),gn=o("br",null,null,-1),vn=o("br",null,null,-1),yn={class:"flex justify-between w-full items-center"},xn=o("span",{class:"pe-1"},"群組標籤設定",-1),hn={href:"javascript:;"},bn=o("span",null,"新增群組標籤",-1),wn=o("span",{class:"pe-.5"},"自動回覆訊息內容",-1),kn=o("span",{class:"text-red-500 pe-2"},"*",-1),$n={href:"javascript:;"},Tn=o("br",null,null,-1),Cn=o("br",null,null,-1),Sn={class:"flex gap-2 overflow-y-auto h-95px"},Fn={class:"text-sms-grayscale-60 text-xs font-500 font-sans text-center break-words"},Mn=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"}," 刪除的檔案將無法復原 ",-1),jn=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"},[u(" 您編輯過的內容將全部清空 "),o("br"),o("p",null,[u(" 提醒您，SMS支援的字數較MMS少，"),o("br"),u(" 且不能上傳多媒體附件 ")])],-1),Yn=ae({__name:"auto-reply-form",setup(x){be.extend(Ft);const{getGroupLabelOption:$,groupOptions:g}=Rt(),{setHideAlert:b,setShowAlert:h}=at(),r=Ze(),m=qe(),f=et(),v=He(),{replaceFieldToHtml:p}=Mt(),{autoReply:w,getAutoReply:H,updateAutoReply:j,createAutoReply:I,checkAcceptKeywordExist:U}=jt(),D=J(()=>f.name==="AutoReplyCreate");let y={phone:void 0,acceptKeyword:"",subject:"",messageType:"SMS",multimediaFile:[],group:void 0,newGroupName:"",takeEffectDates:void 0,content:""};const t=X(mt(y)),Z=J(()=>t.messageType==="SMS"?335:1e3),xe=X({phone:[{required:!0,message:"請選擇發送門號",trigger:"blur"}],acceptKeyword:[{async validator(l,s){return P(s)?Promise.reject("請輸入接收關鍵字"):!P(s)&&await U(s)?Promise.reject(`生效開始與結束日期已存在接收關鍵字「 ${s} 」的設定，請勿重複新增`):Promise.resolve()},trigger:"blur"}],takeEffectDates:[{required:!0,message:"請選擇生效起迄日",trigger:"blur"}],subject:[{async validator(l,s){return t.messageType==="MMS"&&P(s)?Promise.reject("請輸入訊息主旨"):Promise.resolve()},trigger:"blur"}],content:[{async validator(l,s){var S;return P(s)?Promise.reject("請輸入自動回覆訊息內容"):!P(s)&&((S=t.content)==null?void 0:S.replace(we,"").length)>Z.value?Promise.reject(`限制輸入 ${Z.value} 字以內`):Promise.resolve()},trigger:"blur"}]}),{validateInfos:z,validate:W,clearValidate:_,resetFields:i}=ft(t,xe);tt(async()=>{var l,s,S,O,R,A,L,ee,fe,te,_e;D.value||(await H(f.params.id),y={phone:(l=w.value)==null?void 0:l.phone,acceptKeyword:((s=w.value)==null?void 0:s.acceptKeyword)??"",subject:((S=w.value)==null?void 0:S.subject)??"",messageType:((O=w.value)==null?void 0:O.messageType)??"SMS",multimediaFile:((R=w.value)==null?void 0:R.multimediaFile)??[],group:(L=(A=w.value)==null?void 0:A.group)!=null&&L.id?[(ee=w.value)==null?void 0:ee.group.id]:void 0,newGroupName:"",takeEffectDates:(fe=w.value)!=null&&fe.startDate&&((te=w.value)!=null&&te.endDate)?[w.value.startDate,w.value.endDate]:void 0,content:p((_e=w.value)==null?void 0:_e.content)},i(y)),m.handleSelectedKeys(["/sms-marketing/auto-reploy"]),$()});const T=F(),G=J(()=>_t(t.group)||P(t.group)?g.value:g.value.map(l=>({...l,class:"pointer-events-none"}))),Y=F(!0),ue=J(()=>D.value?"新增自動回覆":"編輯自動回覆");nt(()=>t,l=>{gt(l,y)?b():h()},{deep:!0});function pe(){W().then(async()=>{var S;((S=(await(e(D)?I:j)(t,f.params.id)).data)==null?void 0:S.status)==="success"&&(v.success({message:e(D)?"自動回覆新增成功":"自動回覆編輯成功",placement:"top"}),b(),r.push("/sms-marketing/auto-reply"))}).catch(l=>{console.log(l)})}const oe=F(null);function ce(l){t.content=p(l)}const le=F(null);function C(l){for(const s of l)t.content=`${t.content}<span>${s}</span>`}const de=F(null);function he(l){t.content=`${t.content}<a href="${l}">${l}</a>`}const me=F(null);function Pe(l){const s=be().add(1,"year"),S=be().subtract(1,"d");return l<S||l>=s}const Ie=J(()=>{const l=[];if(P(t.acceptKeyword)||l.push({content:t.acceptKeyword,messageType:"GET",contentType:"text"}),(!P(t.content)||!P(t.subject))&&l.push({phone:t.phone,content:t.content,...t.messageType==="MMS"&&{subject:t.subject},messageType:"SENT",contentType:"text"}),!P(t.multimediaFile))for(const s of t.multimediaFile)l.push({phone:t.phone,content:s.url,messageType:"SENT",contentType:s.type});return l.map((s,S)=>({...s,key:S}))}),Se=F(null);function Ae(l){t.multimediaFile=l}const ie=X({open:!1});function Ne(l){Object.assign(ie,{open:!0,delFile:l})}function Ue(){t.multimediaFile=t.multimediaFile.filter(l=>{var s;return l.url!==((s=ie.delFile)==null?void 0:s.url)}),Object.assign(ie,{open:!1,delFile:void 0})}const re=F(!1);function ze(){t.messageType==="SMS"?!P(t.content)||!P(t.multimediaFile)?re.value=!0:t.messageType="SMS":t.messageType="MMS"}return(l,s)=>{const S=vt,O=yt,R=xt,A=ye,L=ht,ee=bt,fe=wt,te=Te,_e=kt,Oe=$t,Be=Tt,Ke=Ce,Ee=ut,Fe=Ct,Le=St,Ve=Lt,Me=Re,Ge=Ye;return c(),K(Ge,{title:e(ue),"custom-breadcrumb":[{title:"訊息行銷活動"},{path:"/sms-marketing/auto-reply",title:"自動回覆"},{title:e(ue)}]},{default:a(()=>[n(Fe,{class:"bg-sms-grayscale-0 rounded-4 p-10 pl-1",wrap:!1},{default:a(()=>[n(R,{flex:"auto"},{default:a(()=>[n(Le,{class:"px-32px",layout:"vertical",autocomplete:"off",onSubmit:pe},{default:a(()=>[n(Fe,{gutter:[16,14]},{default:a(()=>[n(R,{span:24},{default:a(()=>[n(O,q(e(z).phone,{label:"發送門號",required:""}),{default:a(()=>[n(S,{value:e(t).phone,"onUpdate:value":s[0]||(s[0]=d=>e(t).phone=d),options:[{label:"0935-111-111",value:"0935-111-111"},{label:"0947-127-998",value:"0947-127-998"},{label:"0958-892-006",value:"0958-892-006"}],"allow-clear":"",placeholder:"請選擇發送門號"},null,8,["value"])]),_:1},16)]),_:1}),n(R,{span:24},{default:a(()=>[n(O,q(e(z).acceptKeyword,{extra:"最少 1 個字"}),{label:a(()=>[dn,mn,n(L,{placement:"top","get-popup-container":e(ke)},{title:a(()=>[u(" 假設情境："),_n,u(" Step1. 於此處設定接收關鍵字為「1」"),gn,u(" Step2. 傳送訊息，請客戶回覆「1」"),vn,u(" Step3. 若客戶回覆「1」，立即觸發自動回覆功能 ")]),default:a(()=>[o("a",fn,[n(A,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:a(()=>[n(ee,{value:e(t).acceptKeyword,"onUpdate:value":s[1]||(s[1]=d=>e(t).acceptKeyword=d),placeholder:"請輸入接收關鍵字"},null,8,["value"])]),_:1},16)]),_:1}),n(R,{span:24},{default:a(()=>[n(O,q(e(z).group,{"html-for":"","label-col":{style:{width:"100%"}},extra:"可選擇或新增 1 個標籤"}),{label:a(()=>[o("div",yn,[o("div",null,[xn,n(L,{placement:"top","get-popup-container":e(ke)},{title:a(()=>[u(" 將回傳該「接收關鍵字」的多筆門號打包至單一群組標籤，後續可進行再行銷 ")]),default:a(()=>[o("a",hn,[n(A,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),e(Y)?(c(),K(fe,{key:0,type:"link",class:"m-0 p-0",onClickCapture:s[2]||(s[2]=()=>Y.value=!1)},{icon:a(()=>[n(A,{name:"plus"})]),default:a(()=>[u(" 新增群組標籤 ")]),_:1})):M("",!0)])]),default:a(()=>[n(S,{ref_key:"groupRef",ref:T,value:e(t).group,"onUpdate:value":s[3]||(s[3]=d=>e(t).group=d),options:e(G),"allow-clear":"","show-arrow":"",disabled:!e(Y),placeholder:"請輸入",mode:"multiple",class:"w-full","option-filter-prop":"label","menu-item-selected-icon":" ",onSelect:s[4]||(s[4]=d=>{var Q;return(Q=e(T))==null?void 0:Q.blur()})},null,8,["value","options","disabled"])]),_:1},16)]),_:1}),ne(n(R,{span:24,class:"bg-sms-bg-light-mode-gray rounded-md !p-2 !px-3"},{default:a(()=>[n(O,q({"html-for":"",extra:"只能新增 1 個群組標籤，15 字以內。"},e(z).newSmsCategory,{"label-col":{style:{width:"100%"}}}),{label:a(()=>[bn,n(te,{status:"small3",class:"m-0 p-0 ms-auto",onClick:s[5]||(s[5]=st(()=>{e(_)("newSmsCategory"),Y.value=!0},["prevent"]))},{icon:a(()=>[n(A,{name:"close"})]),_:1})]),default:a(()=>[n(ee,{value:e(t).newGroupName,"onUpdate:value":s[6]||(s[6]=d=>e(t).newGroupName=d),placeholder:"請輸入新群組標籤",maxlength:15},null,8,["value"])]),_:1},16)]),_:1},512),[[se,!e(Y)]]),n(R,{span:24},{default:a(()=>[n(O,q(e(z).takeEffectDates,{label:"生效開始與結束日期",extra:"最多可設定 1 年"}),{default:a(()=>[n(_e,{value:e(t).takeEffectDates,"onUpdate:value":s[7]||(s[7]=d=>e(t).takeEffectDates=d),format:"YYYY/MM/DD","value-format":"YYYY/MM/DD",placeholder:["請選擇生效開始結束日期",""],class:"w-full",separator:"～","disabled-date":Pe},null,8,["value"])]),_:1},16)]),_:1}),n(R,{span:24},{default:a(()=>[n(O,q({label:"訊息類型"},e(z).messageType,{required:""}),{default:a(()=>[n(Be,{value:e(t).messageType,"onUpdate:value":s[8]||(s[8]=d=>e(t).messageType=d),onChange:ze},{default:a(()=>[(c(!0),k(V,null,ve(Object.entries(e(Dt)),([d,Q])=>(c(),K(Oe,{key:d,value:d},{default:a(()=>[u(E(Q),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16)]),_:1}),ne(n(R,{span:24},{default:a(()=>[n(O,q({label:"訊息主旨"},e(z).subject,{required:"",extra:"15 字以內"}),{default:a(()=>[n(ee,{value:e(t).subject,"onUpdate:value":s[9]||(s[9]=d=>e(t).subject=d),placeholder:"請輸入訊息主旨",maxlength:15},null,8,["value"])]),_:1},16)]),_:1},512),[[se,e(t).messageType==="MMS"]]),n(R,{span:24},{default:a(()=>{var d;return[n(O,q({"html-for":""},e(z).content,{class:"relative",extra:`${e(t).messageType} 上限 ${e(Z).toLocaleString()} 字，目前 ${e(P)(e(t).content)?"--":(d=e(t).content)==null?void 0:d.replace(e(we),"").length} 字`}),{label:a(()=>[wn,kn,n(L,{placement:"top","get-popup-container":e(ke)},{title:a(()=>[u(" 假設情境："),Tn,u(" Step1. 客戶回覆包含「接收關鍵字」的訊息"),Cn,u(" Step2. 系統自動回覆此欄位內的內容 ")]),default:a(()=>[o("a",$n,[n(A,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:a(()=>{var Q;return[n(Ee,{modelValue:e(t).content,"onUpdate:modelValue":s[14]||(s[14]=B=>e(t).content=B),contenteditable:"true",style:{height:"292px"},"content-len":(Q=e(t).content)==null?void 0:Q.replace(e(we),"").length,"max-len":e(Z),placeholder:"請輸入文字"},De({default:a(()=>[n(L,null,{title:a(()=>[u(" 載入現有的自訂訊息 ")]),default:a(()=>[n(A,{name:"import",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[10]||(s[10]=B=>{var N;return(N=e(oe))==null?void 0:N.show()})})]),_:1}),n(L,null,{title:a(()=>[u(" 增加縮網址 ")]),default:a(()=>[n(A,{name:"link",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[11]||(s[11]=B=>{var N;return(N=e(de))==null?void 0:N.show()})})]),_:1}),n(L,null,{title:a(()=>[u(" 多媒體附件上傳 ")]),default:a(()=>[ne(n(A,{name:"cloud-upload",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[12]||(s[12]=B=>{var N;return(N=e(Se))==null?void 0:N.show(e(t).multimediaFile)})},null,512),[[se,e(t).messageType==="MMS"]])]),_:1}),n(L,null,{title:a(()=>[u(" AI 文字生成訊息 ")]),default:a(()=>[n(A,{name:"AI",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[13]||(s[13]=B=>{var N;return(N=e(me))==null?void 0:N.show()})})]),_:1})]),_:2},[e(t).multimediaFile.length>0?{name:"multimediaBlock",fn:a(()=>[o("div",Sn,[(c(!0),k(V,null,ve(e(t).multimediaFile,B=>(c(),k("div",{key:B.url,class:"w-90px max-h-60px"},[n(Ke,{"video-source":{url:B.url,type:B.type},"show-file-name":!1,"can-play":!1,size:"small","image-class":"object-cover w-full h-full",onDeleteVideo:N=>Ne(B)},null,8,["video-source","onDeleteVideo"]),o("div",Fn,E(B.fileName),1)]))),128))])]),key:"0"}:void 0]),1032,["modelValue","content-len","max-len"])]}),_:1},16,["extra"])]}),_:1}),n(R,{span:24,class:"text-end"},{default:a(()=>[n(te,{status:"small2",class:"me-2",onClick:s[15]||(s[15]=d=>l.$router.push("/sms-marketing/custom-message?tabActived=customMessage"))},{default:a(()=>[u(" 取消 ")]),_:1}),n(te,{status:"small1","html-type":"submit"},{default:a(()=>[u(" 確定 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n(R,{flex:"428px",class:"relative"},{default:a(()=>[n(Ve,{message:e(Ie)},null,8,["message"])]),_:1})]),_:1}),n(ot,{ref_key:"importCustomMessageRef",ref:oe,content:e(t).content,onUpdateContent:ce},null,8,["content"]),n(lt,{ref_key:"addFieldRef",ref:le,onAddFieldToContent:C},null,512),n(it,{ref_key:"addLinkRef",ref:de,onAddLinkToContent:he},null,512),n(rt,{ref_key:"aiTextGenerationRef",ref:me,content:e(t).content,onUpdateContent:ce},null,8,["content"]),n(cn,{ref_key:"multimediaUploadRef",ref:Se,onUpdateMultimediaFile:Ae},null,512),n(Me,{open:e(ie).open,"onUpdate:open":s[16]||(s[16]=d=>e(ie).open=d),title:"是否刪除已上傳的檔案？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onOk:Ue},{default:a(()=>[Mn]),_:1},8,["open"]),n(Me,{open:e(re),"onUpdate:open":s[17]||(s[17]=d=>$e(re)?re.value=d:null),title:"是否放棄目前編輯的內容？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onCancel:s[18]||(s[18]=d=>e(t).messageType="MMS"),onOk:s[19]||(s[19]=()=>{e(t).content="",e(t).multimediaFile=[],e(t).subject="",re.value=!1})},{default:a(()=>[jn]),_:1},8,["open"])]),_:1},8,["title","custom-breadcrumb"])}}});export{Yn as default};
