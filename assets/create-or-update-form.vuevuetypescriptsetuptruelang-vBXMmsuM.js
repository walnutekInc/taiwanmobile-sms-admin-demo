import{M as mt,b as ft,_ as gt,c as _t}from"./MessageTypeEnum-RWv6o7p7.js";import{u as vt,_ as xt,a as yt,b as ht,c as bt,d as St}from"./route-leave-Bp8zUU3v.js";import{_ as Tt}from"./index.vuevuetypescriptsetuptruelang-9TnnHm4G.js";import{_ as Mt}from"./index.vuevuetypescriptsetuptruelang-DtpB6Cde.js";import{j as kt,k as wt,_ as Rt}from"./index-DPDfwRPd.js";import{d as Ce,r as me,f as y,W as T,_ as ae,$ as n,Y as o,k as t,u as e,X as G,F as J,G as l,a3 as k,a4 as de,H as fe,ac as Ct,ad as Pt,z as Ne,c as Ue,o as Ot,w as It,m as Z,ab as V,A as Q,a9 as ke,a7 as jt,a5 as ue,y as At,ag as Be,l as Ft}from"./vue-Cot4Dobd.js";import{z as Pe,E as X,N as Gt,O as qe,P as Et,Q as I,U as Lt,V as He,W as We,J as Nt,I as Ut,o as Bt,p as Ht,q as Wt,y as qt,X as Yt,T as Dt,x as Vt,K as zt,r as Kt,s as $t,F as Zt}from"./antd-C_UvAipJ.js";import{i as Qt}from"./isToday-C81MXPQm.js";import{_ as Ye}from"./index.vuevuetypestyleindex0lang-DRI_kzvm.js";import{_ as De,u as Jt}from"./request-v8LTZy6R.js";import{u as Xt}from"./contact-person--qAOYoMH.js";import{u as es}from"./group-label-CGWvlM3m.js";import{u as ts,r as we}from"./custom-message-QRXnLG1T.js";import{b as U}from"./tools-DuR4KSGu.js";const ss={class:"px-24px"},as=Ce({__name:"select-contact",props:{formState:{}},emits:["updateFormState"],setup(M,{expose:j,emit:B}){const z=M,H=B,f=me({selectedRowKeys:[],selectedRows:[],loading:!1}),{contactPerson:N,getContactPerson:w,pagination:S}=Xt(),K=[{title:"手機門號",dataIndex:"phone",key:"phone",width:"110px"},{title:"姓名",dataIndex:"name",key:"name",width:"110px"},{title:"黑名單",dataIndex:"isBlackList",key:"isBlackList",width:"110px"},{title:"備註",dataIndex:"note",key:"note",width:"110px"}],C=y({keyword:"",sortField:"createTime",sortOrder:"descend"});async function ee(d,_,v){C.value=Object.assign(C.value,{sortField:v.field,sortOrder:v.order}),await g(d.current,d.pageSize)}async function g(d=1,_=10){const v={current:d,pageSize:_,...e(C)};await w(v)}function h(d){console.log("selectedRowKeys changed: ",d),f.selectedRowKeys=d}const m=y(!1);async function L(d){f.selectedRowKeys=d,g(),m.value=!0}function ne(){m.value=!1,H("updateFormState",{recipients:{...z.formState.recipients,contactPerson:f.selectedRowKeys}})}return j({show:L}),(d,_)=>{const v=De,A=Ye,W=Pe;return T(),ae(W,{open:e(m),"onUpdate:open":_[1]||(_[1]=P=>fe(m)?m.value=P:null),title:"選擇聯絡人",centered:"","cancel-text":"取消","ok-text":"確定",width:"600px","ok-button-props":{disabled:e(f).selectedRowKeys.length===0},onOk:ne},{default:n(()=>[o("div",ss,[t(v,{modelValue:e(C).keyword,"onUpdate:modelValue":_[0]||(_[0]=P=>e(C).keyword=P),"show-filter-btn":!1,placeholder:"搜尋聯絡人",class:"mb-2"},null,8,["modelValue"]),t(A,{class:"modal-table","data-source":e(N),columns:K,"show-sorter-tooltip":!1,"row-selection":{selectedRowKeys:e(f).selectedRowKeys,onChange:h},pagination:{...e(S)},onChange:ee},{bodyCell:n(({column:P,text:s})=>[P.dataIndex==="isBlackList"?(T(),G(J,{key:0},[l(k(s?"黑名單":""),1)],64)):de("",!0)]),_:1},8,["data-source","row-selection","pagination"])])]),_:1},8,["open","ok-button-props"])}}}),ns={class:"px-24px"},os=Ce({__name:"select-group",props:{formState:{}},emits:["updateFormState"],setup(M,{expose:j,emit:B}){const z=M,H=B,f=me({selectedRowKeys:[],selectedRows:[],loading:!1}),{groupLabels:N,getGroupLabels:w,pagination:S}=es(),K=[{title:"群組標籤名稱",dataIndex:"name",key:"name",width:"145px"},{title:"門號數量",dataIndex:"phoneCount",key:"phoneCount",width:"145px"},{title:"黑名單數量",dataIndex:"blackListCount",key:"blackListCount",width:"145px"}],C=y({keyword:"",sortField:"createTime",sortOrder:"descend"});async function ee(d,_,v){C.value=Object.assign(C.value,{sortField:v.field,sortOrder:v.order}),await g(d.current,d.pageSize)}async function g(d=1,_=10){const v={current:d,pageSize:_,...e(C)};await w(v)}function h(d,_){console.log("selectedRowKeys changed: ",d),f.selectedRowKeys=d,f.selectedRows=_}const m=y(!1);async function L(d){f.selectedRowKeys=d.map(_=>_.id),g(),m.value=!0}function ne(){m.value=!1,H("updateFormState",{recipients:{...z.formState.recipients,group:f.selectedRows.map(d=>({id:d.key,label:d.name}))}})}return j({show:L}),(d,_)=>{const v=De,A=Ye,W=Pe;return T(),ae(W,{open:e(m),"onUpdate:open":_[1]||(_[1]=P=>fe(m)?m.value=P:null),title:"選擇群組標籤",centered:"","cancel-text":"取消","ok-text":"確定",width:"600px","ok-button-props":{disabled:e(f).selectedRowKeys.length===0},onOk:ne},{default:n(()=>[o("div",ns,[t(v,{modelValue:e(C).keyword,"onUpdate:modelValue":_[0]||(_[0]=P=>e(C).keyword=P),"show-filter-btn":!1,placeholder:"搜尋群組標籤",class:"mb-2"},null,8,["modelValue"]),t(A,{class:"modal-table","data-source":e(N),columns:K,"show-sorter-tooltip":!1,"row-selection":{selectedRowKeys:e(f).selectedRowKeys,onChange:h},pagination:{...e(S)},onChange:ee},null,8,["data-source","row-selection","pagination"])])]),_:1},8,["open","ok-button-props"])}}});var pe=(M=>(M.SMS_General="SMS 一般訊息",M.MMS_General="MMS 一般訊息",M.SMS_Parameter="SMS 參數訊息",M.MMS_Parameter="MMS 參數訊息",M))(pe||{});const Re=[{key:"1",name:"季末大促銷",account:"taiwan_media_00",sendNumber:"AJ593749G2",sendStatus:"RESERVATION",messageType:"MMS",phone:"0961-238-888",content:"愛戀情人節，獨家驚喜等您發現！ 情人節將至，愛戀之情將再次升華！我們特別為您準備了一場浪漫的情人節限定活動，帶來一系列獨家驚喜等您發現。無論您是想要為您的另一半挑選一份特別的禮物，還是希望一起度過浪漫的夜晚，我們都有豐富的選擇和活動等待著您。讓我們一同創造美好的回憶，共度這個充滿愛意的情人節！",multimediaFile:[{url:"https://s3-alpha-sig.figma.com/img/58f4/3909/125235a1ee58204239489f870005010a?Expires=1717977600&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=gOnAZsvJJ3b-I8sDdPUZz2M03-LWdip1MAOY8cgGFjWBZhYz1zxMj6qSYX7RM707p1mclCcqgDWufaoNo1qGRjYa19cFiea54hrW0HPeyvEdeBK2rGlqx0niWpRt~IIv6GhZRnIzlORt~SwYevBIgIpvAiWfygrf0oQBycyaB5e8bkhVUmcDqICGOI1OEhGso2Uqo6jRjMHZ0eJtPVljHG9cS3-L1CZb0ixM3n-XA~fPeoMHDiC~MWU8jLLfT6QkT3vIxuInHO-FHYdeO7eO3n1WnJ5-vTchGX--lfMfQE-mm~0bt3Qs2vnogGAE2rcutsZ7h55efUgRpqkCGvX3fg__",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"},{url:"https://s3-alpha-sig.figma.com/img/9d0c/f052/d64cc2f579c81a1b00818f7276fc7b70?Expires=1717977600&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=Dv2V0i8lTHSCdlvQogFN9PU-AbUW2c9iSbPYw1cVYT9u1nKovLLuvSGVoTPBF7KzhiKP5LCO1Jf1d5NyXEVIVdlAfHaSVJnUAJg4I2NFiXBh1u4VqPr2T~BCpNoBIGzjrpSXfPQAPqxAxQgcakZwTfU6zTMYuSNDuxCGXkHr-MLsXzYWU6xO2H-Mxb2KL-w1pjkAdFoH4ZAiYMbYbf4tsV85LAQJ3Wi-0mI8LtW25KZDRH~HuLjCPs6uEzQ87aKP7BD3tvCCL0CMp-qtXqNYwSlKawA~JANedV3H93kfppw3ov5NOjU8gaQRLQuCamZqB3cK-zbNTaQckxLqE0KA~g__",fileName:"invitation_username.jpg",size:86400,key:"2",fileSize:"",file:void 0,type:"image"},{url:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",fileName:"BigBuckBunny.mp4",size:86400,key:"2",fileSize:"",file:void 0,type:"video"}],recipients:{contactPerson:["1","2"],group:[{id:"1",label:"群組A"}],manual:"09123456789,09123456789",file:void 0},isParameter:!1,subject:"",sendTimeType:"RESERVATION",reservationTime:"2024/02/14 17:30",effectiveTime:"",statistics:{total:0,sending:0,success:0,fail:0,successRate:0},sendTime:"2024/10/28 17:30",createTime:"2024/10/28 17:30",updateTime:"2024/10/28 17:30"},{key:"2",name:"9月壽星活動",account:"taiwan_media_00",sendNumber:"AJ593749G2",sendStatus:"EXECUTING",messageType:"SMS",phone:"0961-238-888",content:"慶祝9月壽星 %field1%，特別優惠等你來享！ 九月生日的朋友們，這個月是您獨特的時刻！為了慶祝您的生日，我們特別準備了一系列令人驚喜的優惠和禮物。無論您是想要一項特別的折扣、額外的積分還是免費的驚喜禮物，我們都會在您的生日月份為您提供。請加入我們，一起慶祝這個特別的時刻，讓我們為您的生日帶來更多的歡樂和驚喜！",multimediaFile:[{url:"https://s3-alpha-sig.figma.com/img/58f4/3909/125235a1ee58204239489f870005010a?Expires=1717977600&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=gOnAZsvJJ3b-I8sDdPUZz2M03-LWdip1MAOY8cgGFjWBZhYz1zxMj6qSYX7RM707p1mclCcqgDWufaoNo1qGRjYa19cFiea54hrW0HPeyvEdeBK2rGlqx0niWpRt~IIv6GhZRnIzlORt~SwYevBIgIpvAiWfygrf0oQBycyaB5e8bkhVUmcDqICGOI1OEhGso2Uqo6jRjMHZ0eJtPVljHG9cS3-L1CZb0ixM3n-XA~fPeoMHDiC~MWU8jLLfT6QkT3vIxuInHO-FHYdeO7eO3n1WnJ5-vTchGX--lfMfQE-mm~0bt3Qs2vnogGAE2rcutsZ7h55efUgRpqkCGvX3fg__",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"}],recipients:{contactPerson:["1","2"],group:[{id:"1",label:"群組A"}],manual:"09123456789,09123456789",file:void 0},isParameter:!1,subject:"",sendTimeType:"RESERVATION",reservationTime:"2024/02/14 17:30",effectiveTime:"",statistics:{total:0,sending:0,success:0,fail:0,successRate:0},sendTime:X().format("YYYY/MM/DD HH:mm"),createTime:"2024/10/28 17:30",updateTime:"2024/10/28 17:30"},{key:"3",name:"季末大促銷季末大促銷季末大促銷季末大促銷季末大促銷季末大促銷",account:"taiwan_media_00",sendNumber:"AJ593749G2",sendStatus:"EXECUTING",messageType:"MMS",phone:"0961-238-888",content:"愛戀情人節，獨家驚喜等您發現！ 情人節將至，愛戀之情將再次升華！我們特別為您準備了一場浪漫的情人節限定活動，帶來一系列獨家驚喜等您發現。無論您是想要為您的另一半挑選一份特別的禮物，還是希望一起度過浪漫的夜晚，我們都有豐富的選擇和活動等待著您。讓我們一同創造美好的回憶，共度這個充滿愛意的情人節！",multimediaFile:[{url:"https://s3-alpha-sig.figma.com/img/58f4/3909/125235a1ee58204239489f870005010a?Expires=1717977600&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=gOnAZsvJJ3b-I8sDdPUZz2M03-LWdip1MAOY8cgGFjWBZhYz1zxMj6qSYX7RM707p1mclCcqgDWufaoNo1qGRjYa19cFiea54hrW0HPeyvEdeBK2rGlqx0niWpRt~IIv6GhZRnIzlORt~SwYevBIgIpvAiWfygrf0oQBycyaB5e8bkhVUmcDqICGOI1OEhGso2Uqo6jRjMHZ0eJtPVljHG9cS3-L1CZb0ixM3n-XA~fPeoMHDiC~MWU8jLLfT6QkT3vIxuInHO-FHYdeO7eO3n1WnJ5-vTchGX--lfMfQE-mm~0bt3Qs2vnogGAE2rcutsZ7h55efUgRpqkCGvX3fg__",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"}],recipients:{contactPerson:["1","2"],group:[{id:"1",label:"群組A"}],manual:"09123456789,09123456789",file:void 0},isParameter:!0,subject:"",sendTimeType:"RESERVATION",reservationTime:"2024/02/14 17:30",effectiveTime:"",statistics:{total:0,sending:0,success:0,fail:0,successRate:0},sendTime:"2024/02/14 17:30",createTime:"2024/10/28 17:30",updateTime:"2024/10/28 17:30"},{key:"4",name:"週年慶",account:"taiwan_media_00",sendNumber:"AJ593749G2",sendStatus:"IS_SENT",messageType:"MMS",phone:"0961-238-888",content:"準備好享受驚人的優惠和特別禮遇，因為我們正在慶祝週年紀念！ 不要錯過這場盛會 - 來店內或線上參加，盡情享受您最喜愛的產品的驚人折扣！這些週年慶特惠不會持續太久！立即購物，讓這個慶典變得難忘！",multimediaFile:[{url:"https://s3-alpha-sig.figma.com/img/58f4/3909/125235a1ee58204239489f870005010a?Expires=1717977600&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=gOnAZsvJJ3b-I8sDdPUZz2M03-LWdip1MAOY8cgGFjWBZhYz1zxMj6qSYX7RM707p1mclCcqgDWufaoNo1qGRjYa19cFiea54hrW0HPeyvEdeBK2rGlqx0niWpRt~IIv6GhZRnIzlORt~SwYevBIgIpvAiWfygrf0oQBycyaB5e8bkhVUmcDqICGOI1OEhGso2Uqo6jRjMHZ0eJtPVljHG9cS3-L1CZb0ixM3n-XA~fPeoMHDiC~MWU8jLLfT6QkT3vIxuInHO-FHYdeO7eO3n1WnJ5-vTchGX--lfMfQE-mm~0bt3Qs2vnogGAE2rcutsZ7h55efUgRpqkCGvX3fg__",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"}],recipients:{contactPerson:["1","2"],group:[{id:"1",label:"群組A"}],manual:"09123456789,09123456789",file:void 0},isParameter:!0,subject:"",sendTimeType:"RESERVATION",reservationTime:"2024/02/14 17:30",effectiveTime:"",statistics:{total:0,sending:0,success:0,fail:0,successRate:0},sendTime:"2024/02/01 17:30",createTime:"2024/10/28 17:30",updateTime:"2024/10/28 17:30"},{key:"5",name:"聖誕佳節",account:"taiwan_media_00",sendNumber:"AJ593749G2",sendStatus:"RESERVATION_FAILED",messageType:"SMS",phone:"0961-238-888",content:"聖誕節大促銷來啦！快來店裡或線上參加我們的節慶活動，享受驚喜禮遇！找尋最適合送給親朋好友的禮物，一起度過溫馨愉快的節日時光！敬請期待我們的特別優惠，讓您的聖誕更加美好！",multimediaFile:[{url:"https://s3-alpha-sig.figma.com/img/58f4/3909/125235a1ee58204239489f870005010a?Expires=1717977600&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=gOnAZsvJJ3b-I8sDdPUZz2M03-LWdip1MAOY8cgGFjWBZhYz1zxMj6qSYX7RM707p1mclCcqgDWufaoNo1qGRjYa19cFiea54hrW0HPeyvEdeBK2rGlqx0niWpRt~IIv6GhZRnIzlORt~SwYevBIgIpvAiWfygrf0oQBycyaB5e8bkhVUmcDqICGOI1OEhGso2Uqo6jRjMHZ0eJtPVljHG9cS3-L1CZb0ixM3n-XA~fPeoMHDiC~MWU8jLLfT6QkT3vIxuInHO-FHYdeO7eO3n1WnJ5-vTchGX--lfMfQE-mm~0bt3Qs2vnogGAE2rcutsZ7h55efUgRpqkCGvX3fg__",fileName:"rose_celebrate.png",size:86400,key:"1",fileSize:"",file:void 0,type:"image"}],recipients:{contactPerson:["1","2"],group:[{id:"1",label:"群組A"}],manual:"09123456789,09123456789",file:void 0},isParameter:!0,subject:"",sendTimeType:"RESERVATION",reservationTime:"2024/02/14 17:30",effectiveTime:"",statistics:{total:0,sending:0,success:0,fail:0,successRate:0},sendTime:"2023/12/20 17:30",createTime:"2024/10/28 17:30",updateTime:"2024/10/28 17:30"}];function is(){const{list:M,pagination:j,setResponseList:B}=Jt(),z=async h=>{B({total:11,pages:1,current:1,pageSize:10,records:Re})},H=async h=>({data:{status:"success",id:"1"}}),f=async(h,m)=>({data:{status:"success",id:"1"}}),N=y(),w=async h=>{const m=Re.find(L=>L.key===h);return N.value=m,{data:{...m}}},S=h=>({data:{fileName:h.name,url:window.URL.createObjectURL(h)}}),K=y([{label:"不設定(預設)",value:""},{label:"1 小時",value:"1 小時"},{label:"2 小時",value:"2 小時"},{label:"3 小時",value:"3 小時"},{label:"4 小時",value:"4 小時"},{label:"5 小時",value:"5 小時"},{label:"6 小時",value:"6 小時"},{label:"7 小時",value:"7 小時"},{label:"8 小時",value:"8 小時"}]);return{getMessageSendings:z,messageSendings:M,pagination:j,createMessageSending:H,updateMessageSending:f,messageSending:N,getMessageSending:w,uploadBatchRecipientsExcel:S,effectiveTimeOption:K,getActiveStatusLabel:(h,m)=>h==="MMS"?m?pe.MMS_Parameter:pe.MMS_General:m?pe.SMS_Parameter:pe.SMS_General,checkMessageSendingDetail:async h=>({data:{...h,price:5,recipientsCount:6208,isBlackListCount:12,estimatedTotalAmount:31400,estimatedRemainingAmount:-3580,totalLongMessages:3}}),checkMessageSendingNameExist:async(h,m)=>{const L=Gt(Re,{name:h});return L?!(!qe(m)&&L.key===m):!1}}}var Ve=(M=>(M.NOW="現在",M.RESERVATION="預約",M))(Ve||{});const ls=o("span",{class:"pe-.5"},"活動名稱",-1),cs=o("span",{class:"text-red-500 pe-2"},"*",-1),rs={href:"javascript:;"},us=o("span",{class:"pe-.5"},"接收門號",-1),ds=o("span",{class:"text-red-500 pe-2"},"*",-1),ps={href:"javascript:;"},ms=o("br",null,null,-1),fs=o("br",null,null,-1),gs=o("br",null,null,-1),_s=o("br",null,null,-1),vs=o("br",null,null,-1),xs={class:"text-sm text-sms-secondary-dark-blue-100 font-400"},ys={key:0,class:"border-solid border border-sms-grayscale-40 rounded-12px px-12px mb-2 min-h-44px py-2"},hs=o("div",{class:"ant-form-item-extra"}," 若有多筆門號，使用 “ , ” 隔開，例如：0911111222,0922123456,0933987654 ",-1),bs={href:"javascript:;",class:"underline underline-offset-2 text-sms-primary-blue-80 text-sm line-height-14px py-1"},Ss={href:"javascript:;",class:"underline underline-offset-2 text-sms-primary-blue-80 text-sm line-height-14px py-1"},Ts=o("span",{class:"pe-.5"},"訊息類型",-1),Ms=o("span",{class:"text-red-500 pe-2"},"*",-1),ks={href:"javascript:;"},ws=o("br",null,null,-1),Rs={class:"flex gap-2 overflow-y-auto h-95px"},Cs={class:"text-sms-grayscale-60 text-xs font-500 font-sans text-center break-words"},Ps=o("span",{class:"pe-.5"},"發送時間",-1),Os=o("span",{class:"text-red-500 pe-2"},"*",-1),Is={href:"javascript:;"},js=o("span",{class:"pe-.5"},"有效時間",-1),As=o("span",{class:"text-red-500 pe-2"},"*",-1),Fs={href:"javascript:;"},Gs={key:0,id:"confirmDetail",class:"px-32px"},Es=o("div",{class:"mb-4"},[o("h2",{class:"font-500 text-22px text-sms-secondary-dark-blue-100"}," 內容確認 "),o("p",{class:"text-sm text-sms-grayscale-80"}," 若有使用縮網址功能，請在發送訊息前再次確認短網址有效性，平台不會檢驗短網址有效性 ")],-1),Ls={class:"border border-solid border-sms-light-gray-60 p-16px pb-24px rounded-12px mb-2"},Ns=o("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 活動名稱 ",-1),Us={class:"text-base font-400 text-sms-grayscale-100"},Bs=o("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 發送時間 ",-1),Hs={key:0,class:"text-base font-400 text-sms-grayscale-100"},Ws=o("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 訊息類型 ",-1),qs={class:"text-base font-400 text-sms-grayscale-100"},Ys=o("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 發送門號 ",-1),Ds={class:"text-base font-400 text-sms-grayscale-100"},Vs=o("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 訊息總數 (長訊息) ",-1),zs={class:"text-base font-400 text-sms-grayscale-100"},Ks=o("div",{class:"text-sm font-400 text-sms-grayscale-80 mb-1"}," 單價 ",-1),$s={class:"text-base font-400 text-sms-grayscale-100"},Zs={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},Qs={href:"javascript:;"},Js={class:"text-base font-400 text-sms-grayscale-100"},Xs=o("span",{class:"text-sms-grayscale-60 text-sm"}," (非最終數量)",-1),ea={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},ta={href:"javascript:;"},sa={class:"text-base font-400 text-sms-grayscale-100"},aa=o("span",{class:"text-sms-grayscale-60 text-sm"}," (非最終數量)",-1),na={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},oa={href:"javascript:;"},ia={class:"text-base font-400 text-sms-grayscale-100"},la={class:"text-sm font-400 text-sms-grayscale-80 mb-1"},ca={href:"javascript:;"},ra=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"}," 刪除的檔案將無法復原 ",-1),ua=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"},[l(" 您編輯過的內容將全部清空 "),o("br"),o("p",null,[l(" 提醒您，SMS支援的字數較MMS少，"),o("br"),l(" 且不能上傳多媒體附件 ")])],-1),da=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"},[o("p",{class:"text-base text-center text-sms-gary-80"},[l(" 正確的格式範例 "),o("a",{class:"text-sms-primary-blue-80 ms-1 underline underline-offset-2",href:"",download:""},"點擊此處下載")])],-1),wa=Ce({__name:"create-or-update-form",props:{isCreate:{type:Boolean,default:!1},id:{},editCallback:{}},setup(M){const j=M;X.extend(Qt);const{setHideAlert:B,setShowAlert:z}=vt(),H=kt(),f=Ct(),N=Pt(),w=Ne(j,"isCreate"),S=Ne(j,"id"),{replaceFieldToHtml:K}=ts(),{updateMessageSending:C,getMessageSending:ee,messageSending:g,createMessageSending:h,uploadBatchRecipientsExcel:m,effectiveTimeOption:L,getActiveStatusLabel:ne,checkMessageSendingDetail:d,checkMessageSendingNameExist:_}=is(),v=y("");let A={name:"",phone:void 0,recipients:{contactPerson:[],group:[],manual:"",file:void 0},messageType:"SMS",subject:"",multimediaFile:[],sendTimeType:"NOW",content:"",effectiveTime:"",reservationTime:"",isParameter:!1};const W=y("ContactPerson"),P=y(!1),s=me(Et(A)),ge=Ue(()=>s.messageType==="SMS"?335:1e3),ze=me({name:[{async validator(i,a){return I(a)?Promise.reject("請輸入活動名稱"):await _(a,S.value)?Promise.reject("此活動名稱已存在，請重新命名 "):Promise.resolve()},trigger:"blur"}],phone:[{required:!0,message:"請選擇發送門號",trigger:"blur"}],subject:[{async validator(i,a){return s.messageType==="MMS"&&I(a)?Promise.reject("請輸入訊息主旨"):Promise.resolve()},trigger:"blur"}],recipients:[{async validator(i){if(I(s.recipients.contactPerson)&&I(s.recipients.group)&&I(s.recipients.manual)&&qe(s.recipients.file))return Promise.reject("至少 1 個接收門號");if(I(s.recipients.manual)){const a=s.recipients.manual.split(",").length,c=s.recipients.contactPerson.length,p=s.recipients.group.length;if(a+c+p>5e4)return Promise.reject("總接收門號數不可超過 5萬筆")}else if(!/^09[0-9]{8}(,09[0-9]{8})*$/.test(s.recipients.manual))return W.value="ManualInput",Promise.reject("格式錯誤");return Promise.resolve()},trigger:"blur"}],content:[{async validator(i,a){var c;return I(a)?Promise.reject("請輸入訊息內容"):!I(a)&&((c=s.content)==null?void 0:c.replace(we,"").length)>ge.value?Promise.reject(`限制輸入 ${ge.value} 字以內`):Promise.resolve()},trigger:"blur"}]}),{validateInfos:q,validate:Ke,resetFields:$e}=Lt(s,ze);Ot(async()=>{var i,a,c,p,Y,R,u,D,E,$,ve,xe,ye,ce,re,he,be,Se,te,Te,Me,se;v.value=X().format("YYYY/MM/DD_HH:mm"),!w.value&&S.value?(await ee(S.value),A={name:((i=g.value)==null?void 0:i.name)??e(v),phone:((a=g.value)==null?void 0:a.phone)??void 0,recipients:{contactPerson:((p=(c=g.value)==null?void 0:c.recipients)==null?void 0:p.contactPerson)??[],group:((R=(Y=g.value)==null?void 0:Y.recipients)==null?void 0:R.group)??[],manual:((D=(u=g.value)==null?void 0:u.recipients)==null?void 0:D.manual)??"",file:(($=(E=g.value)==null?void 0:E.recipients)==null?void 0:$.file)??void 0},messageType:((ve=g.value)==null?void 0:ve.messageType)??"SMS",subject:((xe=g.value)==null?void 0:xe.subject)??"",multimediaFile:((ye=g.value)==null?void 0:ye.multimediaFile)??[],sendTimeType:((ce=g.value)==null?void 0:ce.sendTimeType)??"NOW",content:((re=g.value)==null?void 0:re.content)??"",effectiveTime:((he=g.value)==null?void 0:he.effectiveTime)??"",reservationTime:((be=g.value)==null?void 0:be.reservationTime)??"",isParameter:((Se=g.value)==null?void 0:Se.isParameter)??!1}):((te=f.query)!=null&&te.isRe&&(v.value=`RE_${v.value}`),(Te=f.query)!=null&&Te.isRe&&((Me=f.query)!=null&&Me.rePhone)&&(A.phone=f.query.rePhone),A.name=e(v),A.isParameter=((se=f.name)==null?void 0:se.toString())==="MessageSendingParameterCreate"),$e(A)}),It(()=>s,i=>{const a=He(i,A);w.value&&!S.value&&(a?B():z())},{deep:!0});const x=y(null);function Ze(){Ke().then(async()=>{const i=await d(s);if(i.data){x.value=i.data,P.value=!0,await At();const a=document.getElementById("app");a&&(a.scrollTop=0)}}).catch(i=>{console.log(i)})}async function Qe(){var c,p,Y;const a=await(e(w)?h:C)(s,S.value);if(((c=a.data)==null?void 0:c.status)==="success")if(w.value&&!S.value)if(B(),(p=f.query)!=null&&p.isRe&&((Y=f.query)!=null&&Y.rePhone)){const{post:R,close:u}=Be({name:"in-chat-message-page"});R(a.data.id),u(),window.close()}else H.success({message:"訊息新增成功",placement:"top"}),N.push("/sms-marketing/message-sending").then(()=>{setTimeout(()=>{var D;const{post:R,close:u}=Be({name:"in-message-sending-page"});R((D=a.data)==null?void 0:D.id),u()},800)});else j.editCallback&&j.editCallback(!0,S.value),H.success({message:"訊息編輯成功",placement:"top"})}const Oe=y(null);function Ie(i){s.content=K(i)}const Je=y(null);function Xe(i){for(const a of i)s.content=`${s.content}<span>${a}</span>`}const je=y(null);function et(i){s.content=`${s.content}<a href="${i}">${i}</a>`}const Ae=y(null),tt=Ue(()=>{const i=[];if((!I(s.content)||!I(s.subject))&&i.push({phone:s.phone,content:s.content,...s.messageType==="MMS"&&{subject:s.subject},messageType:"SENT",contentType:"text"}),!I(s.multimediaFile))for(const a of s.multimediaFile)i.push({phone:s.phone,content:a.url,messageType:"SENT",contentType:a.type});return i.map((a,c)=>({...a,key:c}))}),Fe=y(null);function st(i){s.multimediaFile=i}const oe=me({open:!1});function at(i){Object.assign(oe,{open:!0,delFile:i})}function nt(){s.multimediaFile=s.multimediaFile.filter(i=>{var a;return i.url!==((a=oe.delFile)==null?void 0:a.url)}),Object.assign(oe,{open:!1,delFile:void 0})}const ie=y(!1);function ot(){s.messageType==="SMS"?!I(s.content)||!I(s.multimediaFile)?ie.value=!0:s.messageType="SMS":s.messageType="MMS"}const Ge=y(null),Ee=y(null);function Le(i){Object.assign(s,i)}const le=y(!1),_e=y();async function it(i){const c=i.target.files;try{if(c.length>0){const p=await m(c[0]);s.recipients.file=p.data,le.value=!0}}catch(p){console.log(p)}finally{_e.value&&(_e.value.value="")}}const lt=wt();function ct(){lt.confirm({title:"是否取消上傳檔案？",icon:t("span"),content:Ft("div",{innerHTML:"該檔案將取消上傳",class:"text-center px-30px py-20px w-328px text-base mx-auto"}),width:"400px",centered:!0,closable:!0,async onOk(){s.recipients.file=void 0}})}function rt(i){const a=X().add(1,"year"),c=X().subtract(1,"d");return i<c||i>=a}function ut(i){if(i&&i.isToday()){const a=X().hour(),c=X().add(5,"minute").minute();return{disabledHours:()=>We(0,24).slice(0,a),disabledMinutes:()=>We(0,60).slice(0,c)}}return{}}function dt(){const i=He(s,A);j.editCallback&&j.editCallback(i)}function pt(){w.value&&!S.value?N.push("/sms-marketing/message-sending"):dt()}return(i,a)=>{const c=Rt,p=Nt,Y=Ut,R=Bt,u=Ht,D=Wt,E=Mt,$=qt,ve=Tt,xe=Yt,ye=Dt,ce=Vt,re=zt,he=gt,be=St,Se=Kt,te=$t,Te=Zt,Me=_t,se=Pe;return T(),G(J,null,[t(te,{class:ue(["bg-sms-grayscale-0 rounded-4",{"p-10 pl-1":e(w)&&!e(S)}]),wrap:!1},{default:n(()=>[t(u,{flex:"auto"},{default:n(()=>[Z(t(Te,{class:"px-32px",layout:"vertical",autocomplete:"off",onSubmit:Ze},{default:n(()=>[t(te,{gutter:[16,14]},{default:n(()=>[t(u,{span:24},{default:n(()=>[t(R,V(e(q).name,{label:"活動名稱",required:"","html-for":""}),{label:n(()=>[ls,cs,t(p,{placement:"top","get-popup-container":e(U)},{title:n(()=>[l(" 活動名稱可使用系統預設或自行輸入，但不可重複 ")]),default:n(()=>[o("a",rs,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:n(()=>[t(Y,{value:e(s).name,"onUpdate:value":a[0]||(a[0]=r=>e(s).name=r),placeholder:"請輸入文字",maxlength:30,onFocus:a[1]||(a[1]=()=>{e(s).name===e(v)&&(e(s).name="")}),onBlur:a[2]||(a[2]=()=>{e(s).name===""&&(e(s).name=e(v))})},null,8,["value"])]),_:1},16)]),_:1}),t(u,{span:24},{default:n(()=>[t(R,V(e(q).phone,{label:"發送門號",required:""}),{default:n(()=>[t(D,{value:e(s).phone,"onUpdate:value":a[3]||(a[3]=r=>e(s).phone=r),options:[{label:"0935-111-111",value:"0935-111-111"},{label:"0947-127-998",value:"0947-127-998"},{label:"0958-892-006",value:"0958-892-006"}],"allow-clear":"",placeholder:"請選擇發送門號"},null,8,["value"])]),_:1},16)]),_:1}),Z(t(u,{span:24},{default:n(()=>[t(R,V({"html-for":""},e(q).recipients),{label:n(()=>[us,ds,t(p,{"overlay-inner-style":{width:"315px"},placement:"top","get-popup-container":e(U)},{title:n(()=>[l(" 4 種方式增加接收門號 ，且可混合使用(總上限5萬筆)："),ms,l(" 1. 從名單管理匯入聯絡人"),fs,l(" 2. 從名單管理匯入群組標籤"),gs,l(" 3. 直接輸入接收門號"),_s,l(" 4. Excel 快速上傳門號"),vs]),default:n(()=>[o("a",ps,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:n(()=>[t(ye,{activeKey:e(W),"onUpdate:activeKey":a[9]||(a[9]=r=>fe(W)?W.value=r:null),size:"small",class:"full-border-tab",type:"card","destroy-inactive-tab-pane":!0},{default:n(()=>[t($,{key:"ContactPerson",tab:"聯絡人"},{default:n(()=>[t(E,{status:"small2",class:"me-2",onClick:a[4]||(a[4]=r=>{var b,O;return(O=e(Ge))==null?void 0:O.show(((b=e(s).recipients)==null?void 0:b.contactPerson)??[])})},{icon:n(()=>[t(c,{name:"plus",width:"16px"})]),default:n(()=>[l(" 選擇聯絡人 ")]),_:1}),o("span",xs,"已選擇 "+k(e(s).recipients.contactPerson.length.toLocaleString())+" 筆",1)]),_:1},8,["tab"]),t($,{key:"GroupLabel",tab:"群組標籤"},{default:n(()=>[e(s).recipients.group.length>0?(T(),G("div",ys,[t(ve,{chips:e(s).recipients.group,"max-count":3,"show-del":!0,"chips-class":"h-30px py-7px px-8px",onDelChips:a[5]||(a[5]=r=>{e(s).recipients.group=e(s).recipients.group.filter(b=>(b==null?void 0:b.id)!==r)})},null,8,["chips"])])):de("",!0),t(E,{status:"small2",class:"me-2",onClick:a[6]||(a[6]=r=>{var b;return(b=e(Ee))==null?void 0:b.show(e(s).recipients.group??[])})},{icon:n(()=>[t(c,{name:"plus",width:"16px"})]),default:n(()=>[l(" 選擇群組標籤 ")]),_:1})]),_:1},8,["tab"]),t($,{key:"ManualInput",tab:"手動輸入"},{default:n(()=>[t(xe,{value:e(s).recipients.manual,"onUpdate:value":a[7]||(a[7]=r=>e(s).recipients.manual=r),placeholder:"請輸入接收門號",rows:6},null,8,["value"]),hs]),_:1},8,["tab"]),t($,{key:"FileUpload",tab:"上傳檔案"},{default:n(()=>[e(s).recipients.file?(T(),G(J,{key:1},[o("a",Ss,k(e(s).recipients.file.fileName),1),t(c,{name:"download-circle",width:"16px",class:"mx-2 cursor-pointer"}),t(c,{name:"delete-circle",width:"16px",class:"cursor-pointer",onClick:ct})],64)):(T(),G(J,{key:0},[o("input",{ref_key:"uploadBatchRecipientsFile",ref:_e,type:"file",accept:"application/vnd.ms-excel",class:"!hidden",onChange:it},null,544),t(E,{status:"small2",class:"me-2",onClick:a[8]||(a[8]=r=>{var b;return(b=e(_e))==null?void 0:b.click()})},{icon:n(()=>[t(c,{name:"plus",width:"16px"})]),default:n(()=>[l(" 上傳EXCEL ")]),_:1}),o("a",bs,[t(c,{name:"download",width:"16px"}),l(" 匯出範例 ")])],64))]),_:1},8,["tab"])]),_:1},8,["activeKey"])]),_:1},16)]),_:1},512),[[Q,!e(s).isParameter]]),t(u,{span:24},{default:n(()=>[t(R,V({"html-for":""},e(q).messageType),{label:n(()=>[Ts,Ms,t(p,{placement:"top","get-popup-container":e(U)},{title:n(()=>[l(" SMS：上限 335 字"),ws,l(" MMS：上限 1,000 字，可上傳多媒體 ")]),default:n(()=>[o("a",ks,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:n(()=>[t(re,{value:e(s).messageType,"onUpdate:value":a[10]||(a[10]=r=>e(s).messageType=r),onChange:ot},{default:n(()=>[(T(!0),G(J,null,ke(Object.entries(e(mt)),([r,b])=>(T(),ae(ce,{key:r,value:r},{default:n(()=>[l(k(b),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16)]),_:1}),Z(t(u,{span:24},{default:n(()=>[t(R,V({label:"訊息主旨"},e(q).subject,{required:"",extra:"15 字以內"}),{default:n(()=>[t(Y,{value:e(s).subject,"onUpdate:value":a[11]||(a[11]=r=>e(s).subject=r),placeholder:"請輸入訊息主旨",maxlength:15},null,8,["value"])]),_:1},16)]),_:1},512),[[Q,e(s).messageType==="MMS"]]),t(u,{span:24},{default:n(()=>{var r;return[t(R,V({"html-for":"",label:"訊息內容"},e(q).content,{class:"relative",extra:`${e(s).messageType} 上限 ${e(ge).toLocaleString()} 字，目前 ${e(I)(e(s).content)?"--":(r=e(s).content)==null?void 0:r.replace(e(we),"").length} 字`}),{default:n(()=>{var b;return[t(be,{modelValue:e(s).content,"onUpdate:modelValue":a[16]||(a[16]=O=>e(s).content=O),contenteditable:"true",style:{height:"292px"},"content-len":(b=e(s).content)==null?void 0:b.replace(e(we),"").length,"max-len":e(ge),placeholder:"請輸入文字"},jt({default:n(()=>[t(p,null,{title:n(()=>[l(" 載入現有的自訂訊息 ")]),default:n(()=>[t(c,{name:"import",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:a[12]||(a[12]=O=>{var F;return(F=e(Oe))==null?void 0:F.show()})})]),_:1}),t(p,null,{title:n(()=>[l(" 增加縮網址 ")]),default:n(()=>[t(c,{name:"link",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:a[13]||(a[13]=O=>{var F;return(F=e(je))==null?void 0:F.show()})})]),_:1}),t(p,null,{title:n(()=>[l(" 多媒體附件上傳 ")]),default:n(()=>[Z(t(c,{name:"cloud-upload",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:a[14]||(a[14]=O=>{var F;return(F=e(Fe))==null?void 0:F.show(e(s).multimediaFile)})},null,512),[[Q,e(s).messageType==="MMS"]])]),_:1}),t(p,null,{title:n(()=>[l(" AI 文字生成訊息 ")]),default:n(()=>[t(c,{name:"AI",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:a[15]||(a[15]=O=>{var F;return(F=e(Ae))==null?void 0:F.show()})})]),_:1})]),_:2},[e(s).multimediaFile.length>0?{name:"multimediaBlock",fn:n(()=>[o("div",Rs,[(T(!0),G(J,null,ke(e(s).multimediaFile,O=>(T(),G("div",{key:O.url,class:"w-90px max-h-60px"},[t(he,{source:{url:O.url,type:O.type},"show-file-name":!1,"can-play":!1,size:"small","image-class":"object-cover w-full h-full",onDeleteVideo:F=>at(O)},null,8,["source","onDeleteVideo"]),o("div",Cs,k(O.fileName),1)]))),128))])]),key:"0"}:void 0]),1032,["modelValue","content-len","max-len"])]}),_:1},16,["extra"])]}),_:1}),t(u,{span:24,class:"bg-sms-bg-light-mode-gray rounded-md !p-20px"},{default:n(()=>[t(R,V(e(q).sendTimeType,{"html-for":"",class:"mb-4"}),{label:n(()=>[Ps,Os,t(p,{placement:"top","get-popup-container":e(U)},{title:n(()=>[l(" 最快可預約5分鐘之後以及系統當下 1 年內時間，惟實際發送時間以系統排程為主 ")]),default:n(()=>[o("a",Is,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:n(()=>[t(re,{value:e(s).sendTimeType,"onUpdate:value":a[17]||(a[17]=r=>e(s).sendTimeType=r)},{default:n(()=>[(T(!0),G(J,null,ke(Object.entries(e(Ve)),([r,b])=>(T(),ae(ce,{key:r,value:r},{default:n(()=>[l(k(b),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),Z(t(Se,{value:e(s).reservationTime,"onUpdate:value":a[18]||(a[18]=r=>e(s).reservationTime=r),format:"YYYY/MM/DD HH:mm","value-format":"YYYY/MM/DD HH:mm","disabled-date":rt,"disabled-time":ut,"show-time":!0,"show-now":!1},null,8,["value"]),[[Q,e(s).sendTimeType==="RESERVATION"]])]),_:1},16),Z(t(R,V(e(q).sendTimeType,{"html-for":""}),{label:n(()=>[js,As,t(p,{placement:"top","get-popup-container":e(U)},{title:n(()=>[l(" 因接收門號而無法成功送達訊息，會在此設定有效時間內重複嘗試發送 ")]),default:n(()=>[o("a",Fs,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:n(()=>[t(D,{value:e(s).effectiveTime,"onUpdate:value":a[19]||(a[19]=r=>e(s).effectiveTime=r),options:e(L),placeholder:"請選擇有效時間"},null,8,["value","options"])]),_:1},16),[[Q,e(s).sendTimeType==="NOW"]])]),_:1}),t(u,{span:24,class:ue({"text-end":e(w)&&!e(S),"text-center py-6 ":!e(w)&&e(S)})},{default:n(()=>[t(E,{status:"small2",class:"me-2",onClick:pt},{default:n(()=>[l(" 取消 ")]),_:1}),t(E,{status:"small1","html-type":"submit"},{default:n(()=>[l(" 確定 ")]),_:1})]),_:1},8,["class"])]),_:1})]),_:1},512),[[Q,!e(P)]]),e(P)&&e(x)?(T(),G("div",Gs,[Es,o("div",Ls,[t(te,{gutter:[16,16]},{default:n(()=>[t(u,{span:24,class:"mb-"},{default:n(()=>[Ns,o("div",Us,k(e(x).name),1)]),_:1}),t(u,{span:8},{default:n(()=>[Bs,e(x).messageType==="MMS"?(T(),G("div",Hs,k(e(x).reservationTime),1)):(T(),G("div",{key:1,class:ue(["text-base font-400 text-sms-grayscale-100",{"text-sms-status-alert-red":Math.sign(e(x).estimatedRemainingAmount)===-1}])}," 現在 ",2))]),_:1}),t(u,{span:8},{default:n(()=>[Ws,o("div",qs,k(e(ne)(e(x).messageType,e(x).isParameter)),1)]),_:1}),t(u,{span:8},{default:n(()=>[Ys,o("div",Ds,k(e(x).phone),1)]),_:1}),e(x).messageType==="SMS"?(T(),ae(u,{key:0,span:8},{default:n(()=>[Vs,o("div",zs,k(e(x).totalLongMessages),1)]),_:1})):de("",!0),t(u,{span:8},{default:n(()=>[Ks,o("div",$s," NT$ "+k(e(x).price),1)]),_:1}),t(u,{span:8},{default:n(()=>[o("div",Zs,[l(" 接收門號總數 "),t(p,{placement:"top","get-popup-container":e(U)},{title:n(()=>[l(" 未過濾所有黑名單，發送時會再檢核，最終接收門號數量可能變動 ")]),default:n(()=>[o("a",Qs,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),o("div",Js,[l(k(e(x).recipientsCount.toLocaleString())+" ",1),Xs])]),_:1}),t(u,{span:8},{default:n(()=>[o("div",ea,[l(" 黑名單門號總數 "),t(p,{placement:"top","get-popup-container":e(U)},{title:n(()=>[l(" 目前已篩選掉該黑名單數量，發送時會再檢核最新黑名單，最終黑名單門號總數可能變動 ")]),default:n(()=>[o("a",ta,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),o("div",sa,[l(k(e(x).isBlackListCount.toLocaleString())+" ",1),aa])]),_:1}),t(u,{span:8},{default:n(()=>[o("div",na,[l(" 預估發送總金額 "),t(p,{placement:"top","get-popup-container":e(U),"overlay-inner-style":{width:"397px"}},{title:n(()=>[l(" 發送總金額 = 訊息總數 x ( 接收門號總數 - 黑名單門號總數 ) x 單價 參數訊息之訊息總數以一則計算，實際計價以發送字數等於幾則來計價 ")]),default:n(()=>[o("a",oa,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),o("div",ia," NT$ "+k(e(x).estimatedTotalAmount.toLocaleString()),1)]),_:1}),t(u,{span:8},{default:n(()=>[o("div",la,[l(" 預估剩餘金額 "),t(p,{placement:"top","get-popup-container":e(U)},{title:n(()=>[l(" 餘額不足仍可預約，請注意於預約時間前進行儲值才可成功發送訊息 ")]),default:n(()=>[o("a",ca,[t(c,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),o("div",{class:ue(["text-base font-400 text-sms-grayscale-100",{"text-sms-status-alert-red":Math.sign(e(x).estimatedRemainingAmount)===-1}])}," NT$ "+k(e(x).estimatedRemainingAmount.toLocaleString()),3)]),_:1})]),_:1})]),o("div",{class:ue(["flex items-center justify-end",{"py-4":!e(w)&&e(S)}])},[Z(o("div",{class:"text-sms-status-alert-red text-base me-4"},k(e(x).messageType==="MMS"?"可預約，請於發送時間之前儲值完畢，以免發送失敗":"剩餘金額不足，建議回上一步改成預約發送後再盡快儲值"),513),[[Q,Math.sign(e(x).estimatedRemainingAmount)===-1]]),t(E,{status:"small2",class:"me-2",onClick:a[20]||(a[20]=()=>{P.value=!1,x.value=null})},{default:n(()=>[l(" 上一步 ")]),_:1}),t(E,{onClick:Qe},{default:n(()=>[l(" 確定 ")]),_:1})],2)])):de("",!0)]),_:1}),e(w)?(T(),ae(u,{key:0,flex:"428px",class:"relative"},{default:n(()=>[t(Me,{message:e(tt)},null,8,["message"])]),_:1})):de("",!0)]),_:1},8,["class"]),t(xt,{ref_key:"importCustomMessageRef",ref:Oe,content:e(s).content,onUpdateContent:Ie},null,8,["content"]),t(yt,{ref_key:"addFieldRef",ref:Je,onAddFieldToContent:Xe},null,512),t(ht,{ref_key:"addLinkRef",ref:je,onAddLinkToContent:et},null,512),t(bt,{ref_key:"aiTextGenerationRef",ref:Ae,content:e(s).content,onUpdateContent:Ie},null,8,["content"]),t(ft,{ref_key:"multimediaUploadRef",ref:Fe,onUpdateMultimediaFile:st},null,512),t(se,{open:e(oe).open,"onUpdate:open":a[21]||(a[21]=r=>e(oe).open=r),title:"是否刪除已上傳的檔案？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onOk:nt},{default:n(()=>[ra]),_:1},8,["open"]),t(se,{open:e(ie),"onUpdate:open":a[22]||(a[22]=r=>fe(ie)?ie.value=r:null),title:"是否放棄目前編輯的內容？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onCancel:a[23]||(a[23]=r=>e(s).messageType="MMS"),onOk:a[24]||(a[24]=()=>{e(s).content="",e(s).multimediaFile=[],e(s).subject="",ie.value=!1})},{default:n(()=>[ua]),_:1},8,["open"]),t(as,{ref_key:"selectContactRef",ref:Ge,"form-state":e(s),onUpdateFormState:Le},null,8,["form-state"]),t(os,{ref_key:"selectGroupRef",ref:Ee,"form-state":e(s),onUpdateFormState:Le},null,8,["form-state"]),t(se,{open:e(le),"onUpdate:open":a[26]||(a[26]=r=>fe(le)?le.value=r:null),title:"資料格式有誤，請重新確認上傳",width:"400px",centered:""},{footer:n(()=>[t(E,{onClick:a[25]||(a[25]=r=>le.value=!1)},{default:n(()=>[l(" 確定 ")]),_:1})]),default:n(()=>[da]),_:1},8,["open"])],64)}}});export{pe as M,wa as _,is as u};
