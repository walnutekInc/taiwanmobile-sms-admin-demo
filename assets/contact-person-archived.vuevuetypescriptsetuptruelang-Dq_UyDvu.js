import{F as se,_ as de}from"./request-Ccg86ijI.js";import{u as ue,G as re,_ as ie}from"./GenderEnum-B1uoBsRi.js";import{g as pe,a as ce,_ as me,b as fe}from"./index.vuevuetypescriptsetuptruelang-TSSGp73i.js";import{_ as _e}from"./index-BywKgoJ7.js";import{_ as ve}from"./index.vuevuetypescriptsetuptruelang-a-_FUEHv.js";import{k as xe,_ as ye}from"./index-_Xl6GzYg.js";import{u as we}from"./group-label-EUOkBKmm.js";import{z as ge,I as ke,o as he,p as be,U as Ce,r as Ie,F as Re,O as Te,E as Ye}from"./antd-nVhrCAb3.js";import{d as Le,f as v,D as Me,o as Ue,r as De,u as e,W as m,X as x,Y as p,k as a,$ as n,G as i,F as y,a3 as f,a4 as w,_ as Ke,H as O}from"./vue-B4jB9Tcu.js";const Fe={class:"flex justify-between px-2 items-center mb-2"},Oe={class:"me-1"},Pe={href:"javascript:;"},Ve=p("span",null,"全域黑名單功能: 主帳號將特定手機門號加入黑名單，主帳號和子帳號皆無法發送該門號任何訊息",-1),Be=p("div",{class:"h-59px px-20px py-24px"},[p("p",{class:"text-center text-sms-grayscale-80"}," 您選擇的聯絡人將直接永久刪除。 ")],-1),Se=p("div",{class:"h-59px px-20px py-24px"},[p("p",{class:"text-center text-sms-grayscale-80"}," 聯絡人列表中，已經存在相同的聯絡人。 ")],-1),We=Le({__name:"contact-person-archived",props:{toContactPerson:{type:Function,required:!0}},setup(P){const V=P,Y=v([{value:"true",label:"是"},{value:"false",label:"否"}]),{contactPerson:L,pagination:g,getContactPersonArchived:B,deleteContactPerson:S,unArchivedContactPerson:$}=ue(),{getGroupLabelOption:E,groupOptions:M}=we(),U=xe(),N=v(!1);Me(async()=>{b(),await E()}),Ue(()=>{N.value=!0});const G=[{title:"手機門號",dataIndex:"phone",key:"phone",sorter:!0,fixed:"left",width:"130px"},{title:"姓名",dataIndex:"name",key:"name",sorter:!0,fixed:"left",width:"80px"},{title:"群組標籤",dataIndex:"group",key:"group",fixed:"left",width:"250px"},{title:"性別",dataIndex:"gender",key:"gender",sorter:!0,width:"70px"},{title:"黑名單",dataIndex:"isBlackList",key:"isBlackList",sorter:!0,width:"100px"},{title:"聯絡電話",dataIndex:"contact",key:"contact",sorter:!0,width:"110px"},{title:"公司名稱",dataIndex:"company",key:"company",sorter:!0,ellipsis:!0,width:"121px"},{title:"Email",dataIndex:"email",key:"email",sorter:!0,ellipsis:!0,width:"184px"},{title:"生日",dataIndex:"birth",key:"birth",sorter:!0,width:"95px"},{title:"通訊地址",dataIndex:"address",key:"address",sorter:!0,ellipsis:!0,width:"108px"},{title:"備註",dataIndex:"note",key:"note",sorter:!0,width:"108px"},{title:"建立時間",dataIndex:"createTime",key:"createTime",defaultSortOrder:"descend",sorter:!0,width:"140px"},{title:"修改時間",dataIndex:"updateTime",key:"updateTime",sorter:!0,width:"140px"}],r=De({selectedRowKeys:[],selectedRows:[],loading:!1});function z(s,t){console.log("selectedRowKeys changed: ",s,t),r.selectedRowKeys=s,r.selectedRows=t}const l=v({sortField:"createTime",sortOrder:"descend",phone:"",name:"",group:[],company:"",createTime:void 0,updateTime:void 0,keyword:"",blackList:void 0}),A=v();async function b(s=1,t=10){const d={current:s,pageSize:t,...e(l)};await B(d)}async function j(s,t,d){console.log("pagination:",s,"sorter:",d),l.value=Object.assign(l.value,{sortField:d.field,sortOrder:d.order}),await b(s.current,s.pageSize)}const R=v(null);function q(){var s;b(1),(s=R.value)==null||s.hide()}const k=v(!1);async function H(){var t;((t=(await S(r.selectedRows.map(d=>d.key))).data)==null?void 0:t.status)==="success"&&(b(g.value.current===1||L.value.length-r.selectedRowKeys.length>1?g.value.current:g.value.current-1,g.value.pageSize),r.selectedRowKeys=[],r.selectedRows=[],k.value=!1,U.success({message:"聯絡人刪除成功",placement:"top"}))}const C=v(!1);function W(){C.value=!0}async function X(){var t;((t=(await $(r.selectedRowKeys)).data)==null?void 0:t.status)==="success"&&(U.success({message:"聯絡人回復成功",placement:"top"}),V.toContactPerson())}function J(){X()}function Q(){return document.body}return(s,t)=>{const d=ye,h=ve,T=ke,_=_e,c=he,Z=me,ee=fe,D=be,K=Ce,te=Ie,ae=Re,oe=Te,ne=ie,le=de,F=Ye;return m(),x(y,null,[p("div",Fe,[p("div",null,[a(h,{status:"small2",class:"me-2",disabled:e(r).selectedRowKeys.length===0,onClick:W},{icon:n(()=>[a(d,{name:"change",width:"16px"})]),default:n(()=>[i(" 回復聯絡人 ")]),_:1},8,["disabled"]),a(h,{status:"small2",class:"me-2",disabled:e(r).selectedRowKeys.length===0},{icon:n(()=>[a(d,{name:"download",width:"16px"})]),default:n(()=>[i(" 匯出CSV ")]),_:1},8,["disabled"]),a(h,{status:"small2",class:"me-2",disabled:e(r).selectedRowKeys.length===0,onClick:t[0]||(t[0]=o=>k.value=!0)},{icon:n(()=>[a(d,{name:"delete",width:"16px"})]),default:n(()=>[i(" 永久刪除 ")]),_:1},8,["disabled"])]),a(se,{ref_key:"filterKeywordInputRef",ref:R,modelValue:e(l).keyword,"onUpdate:modelValue":t[10]||(t[10]=o=>e(l).keyword=o),class:"w-440px h-40px",placeholder:"搜尋門號、姓名、公司、通訊地址、Email、備註",onClearFilter:t[11]||(t[11]=()=>{l.value={...e(l),phone:"",name:"",group:[],company:"",createTime:void 0,updateTime:void 0,keyword:"",blackList:void 0}})},{filterForm:n(()=>[a(ae,{ref_key:"formRef",ref:A,layout:"vertical",model:e(l),autocomplete:"off"},{default:n(()=>[a(te,{gutter:[16,12]},{default:n(()=>[a(c,{span:24},{default:n(()=>[a(_,{label:"手機門號",valueed:e(l).phone},{default:n(()=>[a(T,{value:e(l).phone,"onUpdate:value":t[1]||(t[1]=o=>e(l).phone=o)},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(_,{label:"姓名",valueed:e(l).name},{default:n(()=>[a(T,{value:e(l).name,"onUpdate:value":t[2]||(t[2]=o=>e(l).name=o)},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(_,{id:"group",label:"群組標籤",valueed:e(pe)(e(l).group)},{default:n(()=>[a(D,{value:e(l).group,"onUpdate:value":t[4]||(t[4]=o=>e(l).group=o),options:e(M),"max-tag-count":2,"show-arrow":!0,"show-search":!1,mode:"multiple",class:"w-full"},{dropdownRender:n(({menuNode:o})=>[a(Z,{modelValue:e(l).group,"onUpdate:modelValue":t[3]||(t[3]=u=>e(l).group=u),menu:o,options:e(M)},null,8,["modelValue","menu","options"])]),option:n(({value:o,label:u})=>[a(ee,{values:e(l).group,value:o,label:u},null,8,["values","value","label"])]),_:1},8,["value","options"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(_,{label:"黑名單",valueed:e(ce)(e(l).blackList,e(Y))},{default:n(()=>[a(D,{value:e(l).blackList,"onUpdate:value":t[5]||(t[5]=o=>e(l).blackList=o),options:e(Y),"max-tag-count":2,"show-arrow":!0,"show-search":!1,class:"w-full"},null,8,["value","options"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(_,{label:"公司名稱",valueed:e(l).company},{default:n(()=>[a(T,{value:e(l).company,"onUpdate:value":t[6]||(t[6]=o=>e(l).company=o),name:"company"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(_,{label:"建立時間",valueed:e(l).createTime},{default:n(()=>[a(K,{value:e(l).createTime,"onUpdate:value":t[7]||(t[7]=o=>e(l).createTime=o),class:"w-full",placement:"topLeft",format:"YYYY-MM-DD","value-format":"YYYY/MM/DD"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24},{default:n(()=>[a(_,{label:"修改時間",valueed:e(l).updateTime},{default:n(()=>[a(K,{value:e(l).updateTime,"onUpdate:value":t[8]||(t[8]=o=>e(l).updateTime=o),class:"w-full",placement:"topLeft",format:"YYYY-MM-DD","value-format":"YYYY/MM/DD"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),a(c,{span:24,class:"text-center"},{default:n(()=>[a(h,{status:"small2",class:"me-5",onClick:t[9]||(t[9]=o=>{var u;return(u=e(R))==null?void 0:u.hide()})},{default:n(()=>[i(" 取消 ")]),_:1}),a(h,{status:"small1",onClick:q},{default:n(()=>[i(" 確定 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),a(le,{"data-source":e(L),columns:G,scroll:{x:1500},size:"small","show-sorter-tooltip":!1,"row-selection":{selectedRowKeys:e(r).selectedRowKeys,onChange:z},pagination:{...e(g)},onChange:j},{headerCell:n(({column:o})=>[o.key==="isBlackList"?(m(),x(y,{key:0},[p("span",Oe,f(o.title),1),a(oe,{placement:"top","get-popup-container":Q},{title:n(()=>[Ve]),default:n(()=>[p("a",Pe,[a(d,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1})],64)):w("",!0)]),bodyCell:n(({column:o,record:u,text:I})=>[o.dataIndex==="group"?(m(),Ke(ne,{key:0,chips:u.group,"max-count":3},null,8,["chips"])):w("",!0),o.dataIndex==="phone"?(m(),x(y,{key:1},[i(f(u.countryCode)+f(u.phone),1)],64)):w("",!0),o.dataIndex==="contact"?(m(),x(y,{key:2},[i(f(u.areaCode)+f(u.contact),1)],64)):w("",!0),o.dataIndex==="gender"?(m(),x(y,{key:3},[i(f(e(re)[I]),1)],64)):w("",!0),o.dataIndex==="isBlackList"?(m(),x(y,{key:4},[i(f(I?"黑名單":""),1)],64)):w("",!0),o.dataIndex==="note"?(m(),x(y,{key:5},[i(f(e(ge)(I)?"-":I),1)],64)):w("",!0)]),_:1},8,["data-source","row-selection","pagination"]),a(F,{open:e(k),"onUpdate:open":t[12]||(t[12]=o=>O(k)?k.value=o:null),centered:"",title:"是否永久刪除選取的聯絡人？",width:"440px","cancel-text":"取消","ok-text":"確定",onOk:H},{default:n(()=>[Be]),_:1},8,["open"]),a(F,{open:e(C),"onUpdate:open":t[13]||(t[13]=o=>O(C)?C.value=o:null),centered:"",title:"是否覆蓋現有的聯絡人？",width:"440px","cancel-text":"取消","ok-text":"確定",onOk:J},{default:n(()=>[Se]),_:1},8,["open"])],64)}}});export{We as _};
