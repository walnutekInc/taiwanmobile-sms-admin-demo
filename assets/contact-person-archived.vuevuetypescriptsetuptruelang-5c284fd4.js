import{_ as se}from"./request-cdb76966.js";import{u as le,a as de,g as re,b as ie,F as ue,G as pe,_ as ce,c as me}from"./GenderEnum-fc837ac0.js";import{_ as _e}from"./index.vuevuetypescriptsetuptruelang-6d8252fd.js";import{k as fe,_ as ve}from"./index-0d92b428.js";import{G as xe,I as ye,r as ke,C as ge,s as we,H as he,u as be,F as Ce,J as Ie,K as Te}from"./antd-cd9a43bc.js";import{d as Ye,f as x,D as Re,o as Le,r as Me,u as e,W as v,X as y,Y as c,k as t,$ as o,G as r,a3 as u,F as k,a4 as g,_ as Fe,H as D}from"./vue-8aa546f0.js";const De={class:"flex justify-between px-2 items-center mb-2"},Se={class:"me-1"},Ke={href:"javascript:;"},Ue=c("span",null,"全域黑名單功能: 主帳號將特定手機門號加入黑名單，主帳號和子帳號皆無法發送該門號任何訊息",-1),Oe=c("div",{class:"h-59px px-20px py-24px"},[c("p",{class:"text-center text-sms-grayscale-80"},"您選擇的聯絡人將直接永久刪除。")],-1),Pe=c("div",{class:"h-59px px-20px py-24px"},[c("p",{class:"text-center text-sms-grayscale-80"},"聯絡人列表中，已經存在相同的聯絡人。")],-1),Ne=Ye({__name:"contact-person-archived",props:{toContactPerson:{type:Function,required:!0}},setup(S){const K=S,Y=x([{value:!0,label:"是"},{value:!1,label:"否"}]),{contactPerson:U,pagination:O,getContactPersonArchived:P,deleteContactPerson:B,unArchivedContactPerson:V}=le(),{getGroupLabelOption:$,groupOptions:A}=de(),R=fe(),E=x(!1);Re(async()=>{I(),await $()}),Le(()=>{E.value=!0});const G=[{title:"手機門號",dataIndex:"phone",key:"phone",sorter:!0,fixed:"left",width:"130px"},{title:"姓名",dataIndex:"name",key:"name",sorter:!0,fixed:"left",width:"80px"},{title:"群組標籤",dataIndex:"group",key:"group",fixed:"left",width:"250px"},{title:"性別",dataIndex:"gender",key:"gender",sorter:!0,width:"70px"},{title:"黑名單",dataIndex:"isBlackList",key:"isBlackList",sorter:!0,width:"100px"},{title:"聯絡電話",dataIndex:"contact",key:"contact",sorter:!0,width:"110px"},{title:"公司名稱",dataIndex:"company",key:"company",sorter:!0,ellipsis:!0,width:"121px"},{title:"Email",dataIndex:"email",key:"email",sorter:!0,ellipsis:!0,width:"184px"},{title:"生日",dataIndex:"birth",key:"birth",sorter:!0,width:"95px"},{title:"通訊地址",dataIndex:"address",key:"address",sorter:!0,ellipsis:!0,width:"108px"},{title:"備註",dataIndex:"note",key:"note",sorter:!0,width:"108px"},{title:"建立時間",dataIndex:"createTime",key:"createTime",defaultSortOrder:"descend",sorter:!0,width:"140px"},{title:"修改時間",dataIndex:"updateTime",key:"updateTime",sorter:!0,width:"140px"}],m=Me({selectedRowKeys:[],selectedRows:[],loading:!1}),N=(l,a)=>{console.log("selectedRowKeys changed: ",l,a),m.selectedRowKeys=l,m.selectedRows=a},s=x({sortField:"createTime",sortOrder:"descend",phone:"",name:"",group:[],company:"",createTime:[void 0,void 0],updateTime:[void 0,void 0],keyword:"",blackList:void 0}),j=x(),I=async(l=1,a=10)=>{var _,w;let d={current:l,pageSize:a,...e(s),group:((w=(_=s.value)==null?void 0:_.group)==null?void 0:w.map(p=>p.id))??[]};await P(d)},z=async(l,a,d)=>{console.log("pagination:",l,"sorter:",d),s.value=Object.assign({sortField:d.field,sortOrder:d.order}),await I(l.current,l.pageSize)},T=x(null),H=()=>{var l;I(1),(l=T.value)==null||l.hide()},h=x(!1),q=async()=>{var a;((a=(await B(m.selectedRows.map(d=>d.key))).data)==null?void 0:a.status)==="success"&&(h.value=!1,R.success({message:"聯絡人刪除成功",placement:"top"}))},b=x(!1),J=()=>{b.value=!0},W=async()=>{var a;((a=(await V(m.selectedRowKeys)).data)==null?void 0:a.status)==="success"&&(R.success({message:"聯絡人回復成功",placement:"top"}),K.toContactPerson())},X=()=>{W()},Q=()=>document.body;return(l,a)=>{const d=ve,_=_e,w=ye,p=ce,f=ke,Z=ge,L=we,M=he,ee=be,te=Ce,ae=Ie,oe=me,ne=se,F=Te;return v(),y(k,null,[c("div",De,[c("div",null,[t(_,{status:"small2",class:"me-2",disabled:e(m).selectedRowKeys.length===0,onClick:J},{icon:o(()=>[t(d,{name:"change",width:"16px"})]),default:o(()=>[r("回復聯絡人 ")]),_:1},8,["disabled"]),t(_,{status:"small2",class:"me-2",disabled:e(m).selectedRowKeys.length===0},{icon:o(()=>[t(d,{name:"download",width:"16px"})]),default:o(()=>[r("匯出CSV ")]),_:1},8,["disabled"]),t(_,{status:"small2",class:"me-2",onClick:a[0]||(a[0]=n=>h.value=!0),disabled:e(m).selectedRowKeys.length===0},{icon:o(()=>[t(d,{name:"delete",width:"16px"})]),default:o(()=>[r("永久刪除 ")]),_:1},8,["disabled"])]),t(ue,{ref_key:"filterKeywordInputRef",ref:T,class:"w-440px h-40px",modelValue:e(s).keyword,"onUpdate:modelValue":a[9]||(a[9]=n=>e(s).keyword=n),placeholder:"搜尋門號、姓名、公司、通訊地址、Email、備註",onClearFilter:a[10]||(a[10]=()=>{s.value={sortField:"createTime",sortOrder:"descend",phone:"",name:"",group:[],company:"",createTime:[void 0,void 0],updateTime:[void 0,void 0],keyword:"",blackList:void 0}})},{filterForm:o(()=>[t(te,{ref_key:"formRef",ref:j,layout:"vertical",model:e(s),autocomplete:"off"},{default:o(()=>[t(ee,{gutter:[16,12]},{default:o(()=>[t(f,{span:24},{default:o(()=>[t(p,{label:"手機門號",valueed:e(s).phone},{default:o(()=>[t(w,{value:e(s).phone,"onUpdate:value":a[1]||(a[1]=n=>e(s).phone=n)},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),t(f,{span:24},{default:o(()=>[t(p,{label:"姓名",valueed:e(s).name},{default:o(()=>[t(w,{value:e(s).name,"onUpdate:value":a[2]||(a[2]=n=>e(s).name=n)},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),t(f,{span:24},{default:o(()=>[t(p,{id:"group",label:"群組標籤",valueed:e(re)(e(s).group)},{default:o(()=>[t(L,{options:e(A),maxTagCount:2,showArrow:!0,showSearch:!1,mode:"multiple",value:e(s).group,"onUpdate:value":a[3]||(a[3]=n=>e(s).group=n),class:"w-full"},{option:o(({value:n,label:i})=>[t(Z,{checked:e(s).group.includes(n)},null,8,["checked"]),r(" "+u(i),1)]),menuItemSelectedIcon:o(()=>[r(u(""))]),_:1},8,["options","value"])]),_:1},8,["valueed"])]),_:1}),t(f,{span:24},{default:o(()=>[t(p,{label:"黑名單",valueed:e(ie)(e(s).blackList,e(Y))},{default:o(()=>[t(L,{options:e(Y),maxTagCount:2,showArrow:!0,showSearch:!1,value:e(s).blackList,"onUpdate:value":a[4]||(a[4]=n=>e(s).blackList=n),class:"w-full"},null,8,["options","value"])]),_:1},8,["valueed"])]),_:1}),t(f,{span:24},{default:o(()=>[t(p,{label:"公司名稱",valueed:e(s).company},{default:o(()=>[t(w,{value:e(s).company,"onUpdate:value":a[5]||(a[5]=n=>e(s).company=n),name:"company"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),t(f,{span:24},{default:o(()=>[t(p,{label:"建立時間",valueed:e(s).createTime},{default:o(()=>[t(M,{class:"w-full",value:e(s).createTime,"onUpdate:value":a[6]||(a[6]=n=>e(s).createTime=n),placement:"topLeft",format:"YYYY-MM-DD",valueFormat:"YYYY/MM/DD"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),t(f,{span:24},{default:o(()=>[t(p,{label:"修改時間",valueed:e(s).updateTime},{default:o(()=>[t(M,{class:"w-full",value:e(s).updateTime,"onUpdate:value":a[7]||(a[7]=n=>e(s).updateTime=n),placement:"topLeft",format:"YYYY-MM-DD",valueFormat:"YYYY/MM/DD"},null,8,["value"])]),_:1},8,["valueed"])]),_:1}),t(f,{span:24,class:"text-center"},{default:o(()=>[t(_,{status:"small2",class:"me-5",onClick:a[8]||(a[8]=n=>{var i;return(i=e(T))==null?void 0:i.hide()})},{default:o(()=>[r("取消")]),_:1}),t(_,{status:"small1",onClick:H},{default:o(()=>[r("確定")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),t(ne,{dataSource:e(U),columns:G,scroll:{x:1500},size:"small",showSorterTooltip:!1,"row-selection":{selectedRowKeys:e(m).selectedRowKeys,onChange:N},onChange:z,pagination:{...e(O)}},{headerCell:o(({column:n})=>[n.key==="isBlackList"?(v(),y(k,{key:0},[c("span",Se,u(n.title),1),t(ae,{placement:"top","get-popup-container":Q},{title:o(()=>[Ue]),default:o(()=>[c("a",Ke,[t(d,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1})],64)):g("",!0)]),bodyCell:o(({column:n,record:i,text:C})=>[n.dataIndex==="group"?(v(),Fe(oe,{key:0,chips:i.group,"max-count":3},null,8,["chips"])):g("",!0),n.dataIndex==="phone"?(v(),y(k,{key:1},[r(u(i.countryCode)+u(i.phone),1)],64)):g("",!0),n.dataIndex==="contact"?(v(),y(k,{key:2},[r(u(i.areaCode)+u(i.contact),1)],64)):g("",!0),n.dataIndex==="gender"?(v(),y(k,{key:3},[r(u(e(pe)[C]),1)],64)):g("",!0),n.dataIndex==="isBlackList"?(v(),y(k,{key:4},[r(u(C?"黑名單":""),1)],64)):g("",!0),n.dataIndex==="note"?(v(),y(k,{key:5},[r(u(e(xe)(C)?"-":C),1)],64)):g("",!0)]),_:1},8,["dataSource","row-selection","pagination"]),t(F,{open:e(h),"onUpdate:open":a[11]||(a[11]=n=>D(h)?h.value=n:null),centered:"",title:"是否永久刪除選取的聯絡人？",width:"440px",cancelText:"取消",okText:"確定",onOk:q},{default:o(()=>[Oe]),_:1},8,["open"]),t(F,{open:e(b),"onUpdate:open":a[12]||(a[12]=n=>D(b)?b.value=n:null),centered:"",title:"是否覆蓋現有的聯絡人？",width:"440px",cancelText:"取消",okText:"確定",onOk:X},{default:o(()=>[Pe]),_:1},8,["open"])],64)}}});export{Ne as _};
