import{_ as Ye}from"./index.vuevuetypescriptsetuptruelang-BvsEmuUR.js";import{_ as ge,h as qe,k as He}from"./index-6VRYaluO.js";import{d as ae,f as T,W as c,X as b,F as G,Y as o,u as e,a3 as E,a4 as S,m as ne,A as se,k as n,a5 as fe,_ as K,a9 as _e,K as We,c as X,a7 as Ce,$ as a,Q as Qe,ag as Xe,ah as Je,ab as q,G as p,r as J,H as Te,ad as Ze,ac as et,D as tt,w as nt,B as st}from"./vue-Ckfa8DnP.js";import{u as at,_ as ot,a as lt,b as it,c as rt,d as ut}from"./route-leave-Dl-m7_uv.js";import{_ as Se}from"./index.vuevuetypescriptsetuptruelang-DLsy_35O.js";import{P as Re,N as j,Q as pt,x as ct,T as dt,O as Pe,G as we,U as mt,V as ft,y as _t,W as gt,p as vt,n as yt,o as xt,K as ht,I as bt,B as wt,H as kt,w as $t,X as Tt,r as Ct,F as St}from"./antd-C0t5NcmN.js";import{i as Ft}from"./isToday-Cx9hKzrs.js";import{u as Mt,r as ke}from"./custom-message-vYJ6F-mQ.js";import{u as jt,M as Dt}from"./auto-reply-DWZtR78B.js";import{a as $e}from"./tools-a0gbWjD6.js";import{u as Rt}from"./group-label-CUdy0NqM.js";import"./context-C6iR8jDq.js";import"./index.esm-vX0ReHx7.js";import"./index.vuevuetypestyleindex0lang-D8D-ioKO.js";import"./request-ZF_yO0f6.js";const Pt={class:"relative w-full h-full"},It=["controls","src"],At={key:0,class:"text-sms-grayscale-60 font-500 text-base text-center pt-2"},Nt={key:0,class:"text-sms-grayscale-60 font-500 text-base text-center pb-2"},Ut=["src"],Fe=ae({name:"MultimediaPreview",__name:"index",props:{videoSource:{},showDelBtn:{type:Boolean,default:!0},showFileName:{type:Boolean,default:!0},canPlay:{type:Boolean,default:!0},imageClass:{default:"w-full"},size:{default:"large"}},emits:["deleteVideo"],setup(v,{emit:w}){const _=v,h=w,y=T(!1),u=T();function m(l){y.value=!l.target.paused}function D(){var l;_.canPlay&&((l=u.value)==null||l.play())}function x(){h("deleteVideo")}return(l,g)=>{const Y=ge;return c(),b("div",Pt,[l.videoSource.type==="video"?(c(),b(G,{key:0},[o("video",{id:"video",ref_key:"videoRef",ref:u,class:"w-full h-full bg-sms-grayscale-100",controls:e(y),src:l.videoSource.url,onPlaying:m,onPause:m},null,40,It),l.showFileName?(c(),b("div",At,E(l.videoSource.fileName)+" ("+E(l.videoSource.fileSize)+") ",1)):S("",!0),ne(n(Y,{name:"play-circle",width:l.size==="large"?"80px":"35px",class:"absolute top-50% left-50% translate-x-[-50%] translate-y-[-50%] cursor-pointer",onClick:D},null,8,["width"]),[[se,!e(y)]])],64)):l.videoSource.url?(c(),b(G,{key:1},[l.showFileName?(c(),b("div",Nt,E(l.videoSource.fileName)+" ("+E(l.videoSource.fileSize)+") ",1)):S("",!0),o("img",{src:l.videoSource.url,class:fe(l.imageClass)},null,10,Ut)],64)):S("",!0),l.showDelBtn?(c(),K(Y,{key:2,name:"close-circle",width:l.size==="large"?"32px":"16px",status:"small3",class:"absolute top-1 right-1 text-sms-grayscale-60 cursor-pointer",onClick:x},null,8,["width"])):S("",!0)])}}}),zt="/taiwanmobile-sms-admin-demo/assets/full-phone-rT6RnVLp.png",Ot=["src"],Bt={class:"max-h-706px overflow-auto absolute top-[150px] left-[30px] w-[calc(100%-50px)]"},Kt={class:"text-sms-grayscale-60 text-sm font-400 font-inter text-sm text-right"},Et=["innerHTML"],Lt=ae({name:"FullPhonePreview",__name:"index",props:{message:{type:Array,default:()=>[]}},setup(v){function w(_="",h){return h?`<div class="font-700 text-17px font-sans">${h}</div>${_}`:_}return(_,h)=>{const y=Fe;return c(),b(G,null,[o("img",{src:e(zt),class:"w-428px"},null,8,Ot),o("div",Bt,[(c(!0),b(G,null,_e(v.message,u=>(c(),b("div",{key:u.key,class:fe(["flex flex-col mb-4",{"me-48px ms-5px":u.messageType==="GET","ms-48px me-20px":u.messageType==="SENT"}])},[o("div",Kt,E(u.phone),1),o("div",{class:fe(["flex w-full items-end justify-end gap-4",{"flex-row-reverse ":u.messageType==="GET"}])},[u.contentType==="text"?(c(),b("div",{key:0,class:fe(["bg-sms-grayscale-20 w-214px py-3 px-3 rounded-2 text-17px break-words",{"bg-sms-primary-blue-20":u.messageType==="SENT"}]),innerHTML:w(u.content,u.subject)},null,10,Et)):u.content?(c(),K(y,{key:1,"video-source":{url:u.content,type:u.contentType},"show-file-name":!1,"show-del-btn":!1,"can-play":!1,"image-class":"w-50% block ms-auto"},null,8,["video-source"])):S("",!0)],2)],2))),128))])],64)}}}),Vt=ae({name:"TLiteTable",extends:Re,inheritAttrs:!1,__name:"index",setup(v){const w=We(),_=X(()=>({...e(w)}));return(h,y)=>(c(),K(e(Re),q({class:"t-lite-table"},{...h.$props,...e(_),pagination:!1}),Ce({_:2},[_e(Object.keys(h.$slots),u=>({name:u,fn:a(m=>[Qe(h.$slots,u,Xe(Je(m||{})))])}))]),1040))}}),Gt=o("span",{class:"text-red-500"},"*",-1),Yt=["accept"],qt={for:"fileInput",class:"flex flex-col items-center justify-center h-full text-sms-grayscale-80 text-sm"},Ht=o("p",{class:""}," 拖曳圖片至此 ",-1),Wt=o("p",{class:""}," 拖曳影音至此 ",-1),Qt=ae({name:"DropFile",__name:"index",props:{uploadType:{type:String,default:"image"}},emits:["changeFile"],setup(v,{emit:w}){const _=v,h=w,y=[".jpg",".jpeg",".png",".gif"],u=[".mp4",".mp3"],m=T(),D=T(!1);function x(F){const A=F.target.files;A&&A.length>0&&m.value&&(h("changeFile",A),m.value.value="")}function l(F){F.preventDefault(),D.value=!0}function g(){D.value=!1}function Y(F){var I,A;if(F.preventDefault(),m.value&&((I=F==null?void 0:F.dataTransfer)!=null&&I.files)){const R=[];for(const N of F.dataTransfer.files){const t=(A=N.name)==null?void 0:A.split(".").pop();_.uploadType==="image"?y.includes(`.${t}`)&&R.push(N):u.includes(`.${t}`)&&R.push(N)}R.length>0&&h("changeFile",R)}D.value=!1}return(F,I)=>{const A=ge,R=Se;return c(),b(G,null,[o("label",null,[p(E(v.uploadType==="image"?"上傳檔案":"上傳影音")+" ",1),Gt]),o("div",{class:"dropzone-container",onDragover:l,onDragleave:g,onDrop:Y},[o("input",{id:"fileInput",ref_key:"file",ref:m,type:"file",name:"file",class:"hidden",accept:v.uploadType==="image"?y.join(","):u.join(","),onChange:x},null,40,Yt),o("div",qt,[n(A,{name:"upload-circle",width:"40px",class:"block mb-4",color:"var(--grayscale-40)"}),v.uploadType==="image"?(c(),b(G,{key:0},[Ht,o("p",null,[p(" 或點擊"),n(R,{class:"mx-2",onClick:I[0]||(I[0]=N=>{var t;return(t=e(m))==null?void 0:t.click()})},{default:a(()=>[p(" 開啟資料夾 ")]),_:1}),p("選擇圖片 ")])],64)):S("",!0),v.uploadType==="video"?(c(),b(G,{key:1},[Wt,o("p",null,[p(" 或點擊"),n(R,{class:"mx-2",onClick:I[1]||(I[1]=N=>{var t;return(t=e(m))==null?void 0:t.click()})},{default:a(()=>[p(" 開啟資料夾 ")]),_:1}),p("選擇影音 ")])],64)):S("",!0)])],32)],64)}}});function Xt(v){let w,_;return y=>({draggable:!0,ondrag(){w=y},ondrop(){_=y},ondragend(){if(w&&_&&w!==_){const u=v.indexOf(w),m=v.indexOf(_);[v[u],v[m]]=[v[m],v[u]],w=void 0,_=void 0}},ondragover(){return!1}})}const Jt={class:"px-20px pb-24px"},Zt={class:"text-sms-grayscale-80 font-400 text-base text-center"},en=o("br",null,null,-1),tn={class:"text-sms-primary-blue-80 font-700"},nn={class:"text-sms-primary-blue-80 font-700"},sn={class:"text-sms-primary-blue-80 font-700"},an={class:"text-sms-status-alert-red text-sm font-400 text-center mt-4"},on=o("p",{class:"text-sms-grayscale-80 font-400 text-base"}," 可上傳 2 張圖片，格式為 jpg、png、gif ",-1),ln=o("p",{class:"text-sms-grayscale-80 font-400 text-base"}," 可上傳 1 個影音，格式為 mp4、mp3 ",-1),rn={key:1,class:"h-auto"},un=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"}," 刪除的檔案將無法復原 ",-1),pn={key:0,class:"text-center py-40px w-523px h-auto text-base mx-auto"},cn=ae({__name:"multimedia-upload-modal",emits:["updateMultimediaFile"],setup(v,{expose:w,emit:_}){const h=_;function y(f){return f===0?"0KB":`${Number.parseFloat((f/1024**1).toFixed(0))}KB`}const u=T("image"),m=T(!1),D=T([]),x=J([]),l=J([]),g=T(!1),Y=X(()=>{let f=l.reduce((i,k)=>i+(k==null?void 0:k.size),0);return f=x.reduce((i,k)=>i+(k==null?void 0:k.size),f),f});function F(f){for(const i of f)l.push({key:l.length+1,fileName:i.name,size:i.size,fileSize:y(i.size),file:i,type:"image",url:URL.createObjectURL(i)})}function I(f){if(f.length>0){const i=f[0];x.push({key:x.length+1,fileName:i.name,size:i.size,fileSize:y(i.size),file:i,type:"video",url:URL.createObjectURL(i)})}}function A(f){D.value=f,l.length=0;const i=Object.assign([],f.filter(P=>P.type==="image"));l.push(...i),x.length=0;const k=Object.assign([],f.filter(P=>P.type==="video"));x.push(...k),m.value=!0}const N=[{title:"拖曳順序",dataIndex:"drop",key:"drop",width:"80px",customCell:Xt(l)},{title:"檔案名稱",dataIndex:"fileName",key:"fileName",width:"200px",ellipsis:!0},{title:"檔案大小",dataIndex:"fileSize",key:"fileSize",width:"80px"},{title:"預覽",dataIndex:"preview",key:"preview",width:"60px"},{title:"刪除",dataIndex:"del",key:"del",width:"60px"}],t=J({open:!1,type:"image",index:0,delAll:!1});function H(f,i,k){Object.assign(t,{open:!0,type:i,delAll:f,index:k})}function ve(){t.delAll?(l.length=0,x.length=0,pe()):t.type==="image"?l.splice(t.index,1):x.splice(t.index,1),t.open=!1}function L(f){f.stopImmediatePropagation(),l.length>0||x.length>0?H(!0):m.value=!1}function pe(){if(g.value=!1,Number.parseInt(y(Y.value).replace("KB",""))>300){g.value=!0;return}h("updateMultimediaFile",e(l).concat(e(x))),m.value=!1}const W=J({open:!1,file:void 0});return w({show:A}),(f,i)=>{const k=Qt,P=ge,Z=Se,ye=Vt,oe=ct,le=Fe,xe=dt,ie=Pe;return c(),b(G,null,[n(ie,{open:e(m),"onUpdate:open":i[2]||(i[2]=$=>Te(m)?m.value=$:null),title:"多媒體附件上傳",centered:"",width:"600px","cancel-text":"取消","ok-text":"確定",onOk:pe,onCancel:i[3]||(i[3]=$=>{g.value=!1,D.value=[]})},Ce({default:a(()=>[o("div",Jt,[o("div",Zt,[p(" 請注意，MMS 多媒體附件 (圖片檔/影音檔)，總大小不可超過 300KB "),en,p(" 目前已上傳 "),o("span",tn,E(e(l).length),1),p(" 個圖片檔、"),o("span",nn,E(e(x).length),1),p(" 個影音檔，共 "),o("span",sn,E(y(e(Y))),1)]),ne(o("div",an," 超過 300KB 上限，請修正 ",512),[[se,e(g)]])]),n(xe,{activeKey:e(u),"onUpdate:activeKey":i[1]||(i[1]=$=>Te(u)?u.value=$:null),type:"card","destroy-inactive-tab-pane":!0,class:"full-border-tab last-child-rounded"},{default:a(()=>[n(oe,{key:"image",tab:"圖片"},{default:a(()=>[on,e(l).length<2?(c(),K(k,{key:0,"upload-type":"image",onChangeFile:F})):S("",!0),ne(n(ye,{columns:N,"data-source":e(l)},{bodyCell:a(({column:$,index:he,record:ce})=>[$.dataIndex==="drop"?(c(),K(Z,{key:0,status:"small3"},{icon:a(()=>[n(P,{name:"menu",class:"text-sms-grayscale-100",width:"16px"})]),_:1})):S("",!0),$.dataIndex==="preview"?(c(),K(Z,{key:1,status:"small3",onClick:be=>{e(W).file=ce,e(W).open=!0}},{icon:a(()=>[n(P,{name:"preview-blue",class:"text-sms-primary-blue-80"})]),_:2},1032,["onClick"])):S("",!0),$.dataIndex==="del"?(c(),K(Z,{key:2,status:"small3",onClick:be=>H(!1,"image",he)},{icon:a(()=>[n(P,{name:"del-blue",class:"text-sms-primary-blue-80"})]),_:2},1032,["onClick"])):S("",!0)]),_:1},8,["data-source"]),[[se,e(l).length>0]])]),_:1},8,["tab"]),n(oe,{key:"video",tab:"影音"},{default:a(()=>[ln,e(x).length<1?(c(),K(k,{key:0,"upload-type":"video",onChangeFile:I})):S("",!0),e(x).length>0?(c(),b("div",rn,[n(le,{"video-source":e(x)[0],onDeleteVideo:i[0]||(i[0]=$=>H(!1,"video",0))},null,8,["video-source"])])):S("",!0)]),_:1},8,["tab"])]),_:1},8,["activeKey"])]),_:2},[e(j)(e(D))?{name:"closeIcon",fn:a(()=>[n(e(pt),{class:"ant-modal-close-icon text-black",onClick:L})]),key:"0"}:void 0]),1032,["open"]),n(ie,{open:e(t).open,"onUpdate:open":i[4]||(i[4]=$=>e(t).open=$),title:e(t).delAll?"是否刪除所有已上傳的檔案？":"是否刪除已上傳的檔案？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onOk:ve},{default:a(()=>[un]),_:1},8,["open","title"]),n(ie,{open:e(W).open,"onUpdate:open":i[5]||(i[5]=$=>e(W).open=$),title:" ",centered:"",footer:null,width:"960px"},{default:a(()=>[e(W).file?(c(),b("div",pn,[n(le,{"video-source":e(W).file,"show-del-btn":!1,"image-class":"h-auto w-auto max-w-full"},null,8,["video-source"])])):S("",!0)]),_:1},8,["open"])],64)}}}),dn=o("span",{class:"pe-.5"},"接收關鍵字",-1),mn=o("span",{class:"text-red-500 pe-2"},"*",-1),fn={href:"javascript:;"},_n=o("br",null,null,-1),gn=o("br",null,null,-1),vn=o("br",null,null,-1),yn={class:"flex justify-between w-full items-center"},xn=o("span",{class:"pe-1"},"群組標籤設定",-1),hn={href:"javascript:;"},bn=o("span",null,"新增群組標籤",-1),wn=o("span",{class:"pe-.5"},"自動回覆訊息內容",-1),kn=o("span",{class:"text-red-500 pe-2"},"*",-1),$n={href:"javascript:;"},Tn=o("br",null,null,-1),Cn=o("br",null,null,-1),Sn={class:"flex gap-2 overflow-y-auto h-95px"},Fn={class:"text-sms-grayscale-60 text-xs font-500 font-sans text-center break-words"},Mn=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"}," 刪除的檔案將無法復原 ",-1),jn=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"},[p(" 您編輯過的內容將全部清空 "),o("br"),o("p",null,[p(" 提醒您，SMS支援的字數較MMS少，"),o("br"),p(" 且不能上傳多媒體附件 ")])],-1),Yn=ae({__name:"auto-reply-form",setup(v){we.extend(Ft);const{getGroupLabelOption:w,groupOptions:_}=Rt(),{setHideAlert:h,setShowAlert:y}=at(),u=Ze(),m=qe(),D=et(),x=He(),{replaceFieldToHtml:l}=Mt(),{autoReply:g,getAutoReply:Y,updateAutoReply:F,createAutoReply:I,checkAcceptKeywordExist:A}=jt(),R=X(()=>D.name==="AutoReplyCreate");let N={phone:void 0,acceptKeyword:"",subject:"",messageType:"SMS",multimediaFile:[],group:void 0,newGroupName:"",takeEffectDates:void 0,content:""};const t=J(mt(N)),H=X(()=>t.messageType==="SMS"?335:1e3),ve=J({phone:[{required:!0,message:"請選擇發送門號",trigger:"blur"}],acceptKeyword:[{async validator(r,s){return j(s)?Promise.reject("請輸入接收關鍵字"):!j(s)&&await A(s)?Promise.reject(`生效開始與結束日期已存在接收關鍵字「 ${s} 」的設定，請勿重複新增`):Promise.resolve()},trigger:"blur"}],takeEffectDates:[{required:!0,message:"請選擇生效起迄日",trigger:"blur"}],subject:[{async validator(r,s){return t.messageType==="MMS"&&j(s)?Promise.reject("請輸入訊息主旨"):Promise.resolve()},trigger:"blur"}],content:[{async validator(r,s){var C;return j(s)?Promise.reject("請輸入自動回覆訊息內容"):!j(s)&&((C=t.content)==null?void 0:C.replace(ke,"").length)>H.value?Promise.reject(`限制輸入 ${H.value} 字以內`):Promise.resolve()},trigger:"blur"}]}),{validateInfos:L,validate:pe,clearValidate:W,resetFields:f}=ft(t,ve);tt(async()=>{var r,s,C,O,M,U,V,ee,de,te,me;R.value||(await Y(D.params.id),N={phone:(r=g.value)==null?void 0:r.phone,acceptKeyword:((s=g.value)==null?void 0:s.acceptKeyword)??"",subject:((C=g.value)==null?void 0:C.subject)??"",messageType:((O=g.value)==null?void 0:O.messageType)??"SMS",multimediaFile:((M=g.value)==null?void 0:M.multimediaFile)??[],group:(V=(U=g.value)==null?void 0:U.group)!=null&&V.id?[(ee=g.value)==null?void 0:ee.group.id]:void 0,newGroupName:"",takeEffectDates:(de=g.value)!=null&&de.startDate&&((te=g.value)!=null&&te.endDate)?[g.value.startDate,g.value.endDate]:void 0,content:l((me=g.value)==null?void 0:me.content)},f(N)),m.handleSelectedKeys(["/sms-marketing/auto-reploy"]),w()});const i=T(),k=X(()=>_t(t.group)||j(t.group)?_.value:_.value.map(r=>({...r,class:"pointer-events-none"}))),P=T(!0),Z=X(()=>R.value?"新增自動回覆":"編輯自動回覆");nt(()=>t,r=>{gt(r,N)?h():y()},{deep:!0});function ye(){pe().then(async()=>{var C;((C=(await(e(R)?I:F)(t,D.params.id)).data)==null?void 0:C.status)==="success"&&(x.success({message:e(R)?"自動回覆新增成功":"自動回覆編輯成功",placement:"top"}),h(),u.push("/sms-marketing/auto-reply"))}).catch(r=>{console.log(r)})}const oe=T(null);function le(r){t.content=l(r)}const xe=T(null);function ie(r){for(const s of r)t.content=`${t.content}<span>${s}</span>`}const $=T(null);function he(r){t.content=`${t.content}<a href="${r}">${r}</a>`}const ce=T(null);function be(r){const s=we().add(1,"year"),C=we().subtract(1,"d");return r<C||r>=s}const Ie=X(()=>{const r=[];if(j(t.acceptKeyword)||r.push({content:t.acceptKeyword,messageType:"GET",contentType:"text"}),(!j(t.content)||!j(t.subject))&&r.push({phone:t.phone,content:t.content,...t.messageType==="MMS"&&{subject:t.subject},messageType:"SENT",contentType:"text"}),!j(t.multimediaFile))for(const s of t.multimediaFile)r.push({phone:t.phone,content:s.url,messageType:"SENT",contentType:s.type});return r.map((s,C)=>({...s,key:C}))}),Me=T(null);function Ae(r){t.multimediaFile=r}const re=J({open:!1});function Ne(r){Object.assign(re,{open:!0,delFile:r})}function Ue(){t.multimediaFile=t.multimediaFile.filter(r=>{var s;return r.url!==((s=re.delFile)==null?void 0:s.url)}),Object.assign(re,{open:!1,delFile:void 0})}const ue=T(!1);function ze(){t.messageType==="SMS"?!j(t.content)||!j(t.multimediaFile)?ue.value=!0:t.messageType="SMS":t.messageType="MMS"}return(r,s)=>{const C=vt,O=yt,M=xt,U=ge,V=ht,ee=bt,de=wt,te=Se,me=kt,Oe=$t,Be=Tt,Ke=Fe,Ee=ut,je=Ct,Le=St,Ve=Lt,De=Pe,Ge=Ye;return c(),K(Ge,{title:e(Z),"custom-breadcrumb":[{title:"訊息行銷活動"},{path:"/sms-marketing/auto-reply",title:"自動回覆"},{title:e(Z)}]},{default:a(()=>[n(je,{class:"bg-sms-grayscale-0 rounded-4 p-10 pl-1",wrap:!1},{default:a(()=>[n(M,{flex:"auto"},{default:a(()=>[n(Le,{class:"px-32px",layout:"vertical",autocomplete:"off",onSubmit:ye},{default:a(()=>[n(je,{gutter:[16,14]},{default:a(()=>[n(M,{span:24},{default:a(()=>[n(O,q(e(L).phone,{label:"發送門號",required:""}),{default:a(()=>[n(C,{value:e(t).phone,"onUpdate:value":s[0]||(s[0]=d=>e(t).phone=d),options:[{label:"0935-111-111",value:"0935-111-111"},{label:"0947-127-998",value:"0947-127-998"},{label:"0958-892-006",value:"0958-892-006"}],"allow-clear":"",placeholder:"請選擇發送門號"},null,8,["value"])]),_:1},16)]),_:1}),n(M,{span:24},{default:a(()=>[n(O,q(e(L).acceptKeyword,{extra:"最少 1 個字"}),{label:a(()=>[dn,mn,n(V,{placement:"top","get-popup-container":e($e)},{title:a(()=>[p(" 假設情境："),_n,p(" Step1. 於此處設定接收關鍵字為「1」"),gn,p(" Step2. 傳送訊息，請客戶回覆「1」"),vn,p(" Step3. 若客戶回覆「1」，立即觸發自動回覆功能 ")]),default:a(()=>[o("a",fn,[n(U,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:a(()=>[n(ee,{value:e(t).acceptKeyword,"onUpdate:value":s[1]||(s[1]=d=>e(t).acceptKeyword=d),placeholder:"請輸入接收關鍵字"},null,8,["value"])]),_:1},16)]),_:1}),n(M,{span:24},{default:a(()=>[n(O,q(e(L).group,{"html-for":"","label-col":{style:{width:"100%"}},extra:"可選擇或新增 1 個標籤"}),{label:a(()=>[o("div",yn,[o("div",null,[xn,n(V,{placement:"top","get-popup-container":e($e)},{title:a(()=>[p(" 將回傳該「接收關鍵字」的多筆門號打包至單一群組標籤，後續可進行再行銷 ")]),default:a(()=>[o("a",hn,[n(U,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),e(P)?(c(),K(de,{key:0,type:"link",class:"m-0 p-0",onClickCapture:s[2]||(s[2]=()=>P.value=!1)},{icon:a(()=>[n(U,{name:"plus"})]),default:a(()=>[p(" 新增群組標籤 ")]),_:1})):S("",!0)])]),default:a(()=>[n(C,{ref_key:"groupRef",ref:i,value:e(t).group,"onUpdate:value":s[3]||(s[3]=d=>e(t).group=d),options:e(k),"allow-clear":"","show-arrow":"",disabled:!e(P),placeholder:"請輸入",mode:"multiple",class:"w-full","option-filter-prop":"label","menu-item-selected-icon":" ",onSelect:s[4]||(s[4]=d=>{var Q;return(Q=e(i))==null?void 0:Q.blur()})},null,8,["value","options","disabled"])]),_:1},16)]),_:1}),ne(n(M,{span:24,class:"bg-sms-bg-light-mode-gray rounded-md !p-2 !px-3"},{default:a(()=>[n(O,q({"html-for":"",extra:"只能新增 1 個群組標籤，15 字以內。"},e(L).newSmsCategory,{"label-col":{style:{width:"100%"}}}),{label:a(()=>[bn,n(te,{status:"small3",class:"m-0 p-0 ms-auto",onClick:s[5]||(s[5]=st(()=>{e(W)("newSmsCategory"),P.value=!0},["prevent"]))},{icon:a(()=>[n(U,{name:"close"})]),_:1})]),default:a(()=>[n(ee,{value:e(t).newGroupName,"onUpdate:value":s[6]||(s[6]=d=>e(t).newGroupName=d),placeholder:"請輸入新群組標籤",maxlength:15},null,8,["value"])]),_:1},16)]),_:1},512),[[se,!e(P)]]),n(M,{span:24},{default:a(()=>[n(O,q(e(L).takeEffectDates,{label:"生效開始與結束日期",extra:"最多可設定 1 年"}),{default:a(()=>[n(me,{value:e(t).takeEffectDates,"onUpdate:value":s[7]||(s[7]=d=>e(t).takeEffectDates=d),format:"YYYY/MM/DD","value-format":"YYYY/MM/DD",placeholder:["請選擇生效開始結束日期",""],class:"w-full",separator:"～","disabled-date":be},null,8,["value"])]),_:1},16)]),_:1}),n(M,{span:24},{default:a(()=>[n(O,q({label:"訊息類型"},e(L).messageType,{required:""}),{default:a(()=>[n(Be,{value:e(t).messageType,"onUpdate:value":s[8]||(s[8]=d=>e(t).messageType=d),onChange:ze},{default:a(()=>[(c(!0),b(G,null,_e(Object.entries(e(Dt)),([d,Q])=>(c(),K(Oe,{key:d,value:d},{default:a(()=>[p(E(Q),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16)]),_:1}),ne(n(M,{span:24},{default:a(()=>[n(O,q({label:"訊息主旨"},e(L).subject,{required:"",extra:"15 字以內"}),{default:a(()=>[n(ee,{value:e(t).subject,"onUpdate:value":s[9]||(s[9]=d=>e(t).subject=d),placeholder:"請輸入訊息主旨",maxlength:15},null,8,["value"])]),_:1},16)]),_:1},512),[[se,e(t).messageType==="MMS"]]),n(M,{span:24},{default:a(()=>{var d;return[n(O,q({"html-for":""},e(L).content,{class:"relative",extra:`${e(t).messageType} 上限 ${e(H).toLocaleString()} 字，目前 ${e(j)(e(t).content)?"--":(d=e(t).content)==null?void 0:d.replace(e(ke),"").length} 字`}),{label:a(()=>[wn,kn,n(V,{placement:"top","get-popup-container":e($e)},{title:a(()=>[p(" 假設情境："),Tn,p(" Step1. 客戶回覆包含「接收關鍵字」的訊息"),Cn,p(" Step2. 系統自動回覆此欄位內的內容 ")]),default:a(()=>[o("a",$n,[n(U,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:a(()=>{var Q;return[n(Ee,{modelValue:e(t).content,"onUpdate:modelValue":s[14]||(s[14]=B=>e(t).content=B),contenteditable:"true",style:{height:"292px"},"content-len":(Q=e(t).content)==null?void 0:Q.replace(e(ke),"").length,"max-len":e(H),placeholder:"請輸入文字"},Ce({default:a(()=>[n(V,null,{title:a(()=>[p(" 載入現有的自訂訊息 ")]),default:a(()=>[n(U,{name:"import",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[10]||(s[10]=B=>{var z;return(z=e(oe))==null?void 0:z.show()})})]),_:1}),n(V,null,{title:a(()=>[p(" 增加縮網址 ")]),default:a(()=>[n(U,{name:"link",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[11]||(s[11]=B=>{var z;return(z=e($))==null?void 0:z.show()})})]),_:1}),n(V,null,{title:a(()=>[p(" 多媒體附件上傳 ")]),default:a(()=>[ne(n(U,{name:"cloud-upload",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[12]||(s[12]=B=>{var z;return(z=e(Me))==null?void 0:z.show(e(t).multimediaFile)})},null,512),[[se,e(t).messageType==="MMS"]])]),_:1}),n(V,null,{title:a(()=>[p(" AI 文字生成訊息 ")]),default:a(()=>[n(U,{name:"AI",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:s[13]||(s[13]=B=>{var z;return(z=e(ce))==null?void 0:z.show()})})]),_:1})]),_:2},[e(t).multimediaFile.length>0?{name:"multimediaBlock",fn:a(()=>[o("div",Sn,[(c(!0),b(G,null,_e(e(t).multimediaFile,B=>(c(),b("div",{key:B.url,class:"w-90px max-h-60px"},[n(Ke,{"video-source":{url:B.url,type:B.type},"show-file-name":!1,"can-play":!1,size:"small","image-class":"object-cover w-full h-full",onDeleteVideo:z=>Ne(B)},null,8,["video-source","onDeleteVideo"]),o("div",Fn,E(B.fileName),1)]))),128))])]),key:"0"}:void 0]),1032,["modelValue","content-len","max-len"])]}),_:1},16,["extra"])]}),_:1}),n(M,{span:24,class:"text-end"},{default:a(()=>[n(te,{status:"small2",class:"me-2",onClick:s[15]||(s[15]=d=>r.$router.push("/sms-marketing/custom-message?tabActived=customMessage"))},{default:a(()=>[p(" 取消 ")]),_:1}),n(te,{status:"small1","html-type":"submit"},{default:a(()=>[p(" 確定 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n(M,{flex:"428px",class:"relative"},{default:a(()=>[n(Ve,{message:e(Ie)},null,8,["message"])]),_:1})]),_:1}),n(ot,{ref_key:"importCustomMessageRef",ref:oe,content:e(t).content,onUpdateContent:le},null,8,["content"]),n(lt,{ref_key:"addFieldRef",ref:xe,onAddFieldToContent:ie},null,512),n(it,{ref_key:"addLinkRef",ref:$,onAddLinkToContent:he},null,512),n(rt,{ref_key:"aiTextGenerationRef",ref:ce,content:e(t).content,onUpdateContent:le},null,8,["content"]),n(cn,{ref_key:"multimediaUploadRef",ref:Me,onUpdateMultimediaFile:Ae},null,512),n(De,{open:e(re).open,"onUpdate:open":s[16]||(s[16]=d=>e(re).open=d),title:"是否刪除已上傳的檔案？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onOk:Ue},{default:a(()=>[Mn]),_:1},8,["open"]),n(De,{open:e(ue),"onUpdate:open":s[17]||(s[17]=d=>Te(ue)?ue.value=d:null),title:"是否放棄目前編輯的內容？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onCancel:s[18]||(s[18]=d=>e(t).messageType="MMS"),onOk:s[19]||(s[19]=()=>{e(t).content="",e(t).multimediaFile=[],e(t).subject="",ue.value=!1})},{default:a(()=>[jn]),_:1},8,["open"])]),_:1},8,["title","custom-breadcrumb"])}}});export{Yn as default};
