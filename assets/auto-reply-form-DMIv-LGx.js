import{_ as qe}from"./index.vuevuetypescriptsetuptruelang-CpV2Q3zl.js";import{_ as ve,h as He,k as We}from"./index-CNmZJk7P.js";import{d as oe,f as S,W as c,X as h,F as G,Y as o,a5 as ne,u as e,a3 as L,a4 as C,m as se,A as ae,k as n,_ as E,a9 as ge,K as Qe,c as X,a7 as Te,$ as s,Q as Xe,ag as Je,ah as Ze,ab as q,G as u,r as J,H as Se,ad as et,ac as tt,D as nt,w as st,B as at}from"./vue-Ckfa8DnP.js";import{u as ot,_ as lt,a as it,b as rt,c as ut,d as pt}from"./route-leave-DWbET9MX.js";import{_ as Ce}from"./index.vuevuetypescriptsetuptruelang-CEVcljDz.js";import{Q as Re,O as j,U as ct,y as dt,T as mt,P as Pe,H as ke,V as ft,W as _t,z as gt,X as vt,q as yt,o as xt,p as ht,N as bt,I as wt,B as kt,J as $t,x as St,Y as Tt,s as Ct,F as Mt}from"./antd-DX4Bdc1P.js";import{i as Ft}from"./isToday-Cu6tVeGL.js";import{u as jt,r as $e}from"./custom-message-DB52EBFf.js";import{u as Dt}from"./auto-reply-BCYRu4eC.js";import{a as _e}from"./tools-a0gbWjD6.js";import{u as Rt}from"./group-label-BEtebfII.js";import"./context-ByeIy66j.js";import"./index.esm-CpF9vsgg.js";import"./index.vuevuetypestyleindex0lang-DGtsMRLU.js";import"./request-DR2_mUfI.js";const Pt={class:"relative w-full h-full"},It=["controls","src"],zt={key:0,class:"text-sms-grayscale-60 font-500 text-base text-center pt-2"},At={key:0,class:"text-sms-grayscale-60 font-500 text-base text-center pb-2"},Nt=["src"],Me=oe({name:"MultimediaPreview",__name:"index",props:{videoSource:{},showDelBtn:{type:Boolean,default:!0},showFileName:{type:Boolean,default:!0},canPlay:{type:Boolean,default:!0},imageClass:{default:"w-full"},size:{default:"large"}},emits:["deleteVideo"],setup(m,{emit:w}){const g=m,b=w,y=S(!1),p=S();function f(l){y.value=!l.target.paused}function D(){var l;g.canPlay&&((l=p.value)==null||l.play())}function x(){b("deleteVideo")}return(l,v)=>{const Y=ve;return c(),h("div",Pt,[l.videoSource.type==="video"?(c(),h(G,{key:0},[o("video",{id:"video",ref_key:"videoRef",ref:p,class:ne(["h-full w-full bg-sms-grayscale-100",{"max-h-356px":l.size==="large"}]),controls:e(y),src:l.videoSource.url,onPlaying:f,onPause:f},null,42,It),l.showFileName?(c(),h("div",zt,L(l.videoSource.fileName)+" ("+L(l.videoSource.fileSize)+") ",1)):C("",!0),se(n(Y,{name:"play-circle",width:l.size==="large"?"80px":"35px",class:"absolute top-50% left-50% translate-x-[-50%] translate-y-[-50%] cursor-pointer",onClick:D},null,8,["width"]),[[ae,!e(y)]])],64)):l.videoSource.url?(c(),h(G,{key:1},[l.showFileName?(c(),h("div",At,L(l.videoSource.fileName)+" ("+L(l.videoSource.fileSize)+") ",1)):C("",!0),o("img",{src:l.videoSource.url,class:ne(l.imageClass)},null,10,Nt)],64)):C("",!0),l.showDelBtn?(c(),E(Y,{key:2,name:"close-circle",width:l.size==="large"?"32px":"16px",status:"small3",class:"absolute top-1 right-1 text-sms-grayscale-60 cursor-pointer",onClick:x},null,8,["width"])):C("",!0)])}}}),Ut="/taiwanmobile-sms-admin-demo/assets/full-phone-rT6RnVLp.png",Ot=["src"],Bt={class:"max-h-706px overflow-auto absolute top-[150px] left-[30px] w-[calc(100%-50px)]"},Kt={class:"text-sms-grayscale-60 text-sm font-400 font-inter text-sm text-right"},Lt=["innerHTML"],Vt=oe({name:"FullPhonePreview",__name:"index",props:{message:{type:Array,default:()=>[]}},setup(m){function w(g="",b){return b?`<div class="font-700 text-17px font-sans">${b}</div>${g}`:g}return(g,b)=>{const y=Me;return c(),h(G,null,[o("img",{src:e(Ut),class:"w-428px"},null,8,Ot),o("div",Bt,[(c(!0),h(G,null,ge(m.message,p=>(c(),h("div",{key:p.key,class:ne(["flex flex-col mb-4",{"me-48px ms-5px":p.messageType==="GET","ms-48px me-20px":p.messageType==="SENT"}])},[o("div",Kt,L(p.phone),1),o("div",{class:ne(["flex w-full items-end justify-end gap-4",{"flex-row-reverse ":p.messageType==="GET"}])},[p.contentType==="text"?(c(),h("div",{key:0,class:ne(["bg-sms-grayscale-20 w-214px py-3 px-3 rounded-2 text-17px break-words",{"bg-sms-primary-blue-20":p.messageType==="SENT"}]),innerHTML:w(p.content,p.subject)},null,10,Lt)):p.content?(c(),h("div",{key:1,class:ne({"h-130px w-196px":p.contentType==="video"})},[n(y,{"video-source":{url:p.content,type:p.contentType},"show-file-name":!1,"show-del-btn":!1,"can-play":!1,"image-class":"w-50% block ms-auto"},null,8,["video-source"])],2)):C("",!0)],2)],2))),128))])],64)}}}),Et=oe({name:"TLiteTable",extends:Re,inheritAttrs:!1,__name:"index",setup(m){const w=Qe(),g=X(()=>({...e(w)}));return(b,y)=>(c(),E(e(Re),q({class:"t-lite-table"},{...b.$props,...e(g),pagination:!1}),Te({_:2},[ge(Object.keys(b.$slots),p=>({name:p,fn:s(f=>[Xe(b.$slots,p,Je(Ze(f||{})))])}))]),1040))}}),Gt=o("span",{class:"text-red-500"},"*",-1),Yt=["accept"],qt={for:"fileInput",class:"flex flex-col items-center justify-center h-full text-sms-grayscale-80 text-sm"},Ht=o("p",{class:""}," 拖曳圖片至此 ",-1),Wt=o("p",{class:""}," 拖曳影音至此 ",-1),Qt=oe({name:"DropFile",__name:"index",props:{uploadType:{type:String,default:"image"}},emits:["changeFile"],setup(m,{emit:w}){const g=m,b=w,y=[".jpg",".jpeg",".png",".gif"],p=[".mp4",".mp3"],f=S(),D=S(!1);function x(M){const A=M.target.files;A&&A.length>0&&f.value&&(b("changeFile",A),f.value.value="")}function l(M){M.preventDefault(),D.value=!0}function v(){D.value=!1}function Y(M){var z,A;if(M.preventDefault(),f.value&&((z=M==null?void 0:M.dataTransfer)!=null&&z.files)){const R=[];for(const N of M.dataTransfer.files){const t=(A=N.name)==null?void 0:A.split(".").pop();g.uploadType==="image"?y.includes(`.${t}`)&&R.push(N):p.includes(`.${t}`)&&R.push(N)}R.length>0&&b("changeFile",R)}D.value=!1}return(M,z)=>{const A=ve,R=Ce;return c(),h(G,null,[o("label",null,[u(L(m.uploadType==="image"?"上傳檔案":"上傳影音")+" ",1),Gt]),o("div",{class:"dropzone-container",onDragover:l,onDragleave:v,onDrop:Y},[o("input",{id:"fileInput",ref_key:"file",ref:f,type:"file",name:"file",class:"hidden",accept:m.uploadType==="image"?y.join(","):p.join(","),onChange:x},null,40,Yt),o("div",qt,[n(A,{name:"upload-circle",width:"40px",class:"block mb-4",color:"var(--grayscale-40)"}),m.uploadType==="image"?(c(),h(G,{key:0},[Ht,o("p",null,[u(" 或點擊"),n(R,{class:"mx-2",onClick:z[0]||(z[0]=N=>{var t;return(t=e(f))==null?void 0:t.click()})},{default:s(()=>[u(" 開啟資料夾 ")]),_:1}),u("選擇圖片 ")])],64)):C("",!0),m.uploadType==="video"?(c(),h(G,{key:1},[Wt,o("p",null,[u(" 或點擊"),n(R,{class:"mx-2",onClick:z[1]||(z[1]=N=>{var t;return(t=e(f))==null?void 0:t.click()})},{default:s(()=>[u(" 開啟資料夾 ")]),_:1}),u("選擇影音 ")])],64)):C("",!0)])],32)],64)}}});function Xt(m){let w,g;return y=>({draggable:!0,ondrag(){w=y},ondrop(){g=y},ondragend(){if(w&&g&&w!==g){const p=m.indexOf(w),f=m.indexOf(g);[m[p],m[f]]=[m[f],m[p]],w=void 0,g=void 0}},ondragover(){return!1}})}const Jt={class:"px-20px pb-24px"},Zt={class:"text-sms-grayscale-80 font-400 text-base text-center"},en=o("br",null,null,-1),tn={class:"text-sms-primary-blue-80 font-700"},nn={class:"text-sms-primary-blue-80 font-700"},sn={class:"text-sms-primary-blue-80 font-700"},an={class:"text-sms-status-alert-red text-sm font-400 text-center mt-4"},on=o("p",{class:"text-sms-grayscale-80 font-400 text-base"}," 可上傳 2 張圖片，格式為 jpg、png、gif ",-1),ln=o("p",{class:"text-sms-grayscale-80 font-400 text-base"}," 可上傳 1 個影音，格式為 mp4、mp3 ",-1),rn={key:1,class:"h-auto"},un=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"}," 刪除的檔案將無法復原 ",-1),pn={key:0,class:"text-center py-40px w-523px h-auto text-base mx-auto"},cn=oe({__name:"multimedia-upload-modal",emits:["updateMultimediaFile"],setup(m,{expose:w,emit:g}){const b=g;function y(_){return _===0?"0KB":`${Number.parseFloat((_/1024**1).toFixed(0))}KB`}const p=S("image"),f=S(!1),D=S([]),x=J([]),l=J([]),v=S(!1),Y=X(()=>{let _=l.reduce((i,k)=>i+(k==null?void 0:k.size),0);return _=x.reduce((i,k)=>i+(k==null?void 0:k.size),_),_});function M(_){for(const i of _)l.push({key:l.length+1,fileName:i.name,size:i.size,fileSize:y(i.size),file:i,type:"image",url:URL.createObjectURL(i)})}function z(_){if(_.length>0){const i=_[0];x.push({key:x.length+1,fileName:i.name,size:i.size,fileSize:y(i.size),file:i,type:"video",url:URL.createObjectURL(i)})}}function A(_){D.value=_,l.length=0;const i=Object.assign([],_.filter(P=>P.type==="image"));l.push(...i),x.length=0;const k=Object.assign([],_.filter(P=>P.type==="video"));x.push(...k),f.value=!0}const N=[{title:"拖曳順序",dataIndex:"drop",key:"drop",width:"80px",customCell:Xt(l)},{title:"檔案名稱",dataIndex:"fileName",key:"fileName",width:"200px",ellipsis:!0},{title:"檔案大小",dataIndex:"fileSize",key:"fileSize",width:"80px"},{title:"預覽",dataIndex:"preview",key:"preview",width:"60px"},{title:"刪除",dataIndex:"del",key:"del",width:"60px"}],t=J({open:!1,type:"image",index:0,delAll:!1});function H(_,i,k){Object.assign(t,{open:!0,type:i,delAll:_,index:k})}function ye(){t.delAll?(l.length=0,x.length=0,ce()):t.type==="image"?l.splice(t.index,1):x.splice(t.index,1),t.open=!1}function V(_){_.stopImmediatePropagation(),l.length>0||x.length>0?H(!0):f.value=!1}function ce(){if(v.value=!1,Number.parseInt(y(Y.value).replace("KB",""))>300){v.value=!0;return}b("updateMultimediaFile",e(l).concat(e(x))),f.value=!1}const W=J({open:!1,file:void 0});return w({show:A}),(_,i)=>{const k=Qt,P=ve,Z=Ce,xe=Et,le=dt,ie=Me,he=mt,re=Pe;return c(),h(G,null,[n(re,{open:e(f),"onUpdate:open":i[2]||(i[2]=$=>Se(f)?f.value=$:null),title:"多媒體附件上傳",centered:"",width:"600px","cancel-text":"取消","ok-text":"確定",onOk:ce,onCancel:i[3]||(i[3]=$=>{v.value=!1,D.value=[]})},Te({default:s(()=>[o("div",Jt,[o("div",Zt,[u(" 請注意，MMS 多媒體附件 (圖片檔/影音檔)，總大小不可超過 300KB "),en,u(" 目前已上傳 "),o("span",tn,L(e(l).length),1),u(" 個圖片檔、"),o("span",nn,L(e(x).length),1),u(" 個影音檔，共 "),o("span",sn,L(y(e(Y))),1)]),se(o("div",an," 超過 300KB 上限，請修正 ",512),[[ae,e(v)]])]),n(he,{activeKey:e(p),"onUpdate:activeKey":i[1]||(i[1]=$=>Se(p)?p.value=$:null),type:"card","destroy-inactive-tab-pane":!0,class:"full-border-tab last-child-rounded"},{default:s(()=>[n(le,{key:"image",tab:"圖片"},{default:s(()=>[on,e(l).length<2?(c(),E(k,{key:0,"upload-type":"image",onChangeFile:M})):C("",!0),se(n(xe,{columns:N,"data-source":e(l)},{bodyCell:s(({column:$,index:be,record:de})=>[$.dataIndex==="drop"?(c(),E(Z,{key:0,status:"small3"},{icon:s(()=>[n(P,{name:"menu",class:"text-sms-grayscale-100",width:"16px"})]),_:1})):C("",!0),$.dataIndex==="preview"?(c(),E(Z,{key:1,status:"small3",onClick:we=>{e(W).file=de,e(W).open=!0}},{icon:s(()=>[n(P,{name:"preview-blue",class:"text-sms-primary-blue-80"})]),_:2},1032,["onClick"])):C("",!0),$.dataIndex==="del"?(c(),E(Z,{key:2,status:"small3",onClick:we=>H(!1,"image",be)},{icon:s(()=>[n(P,{name:"del-blue",class:"text-sms-primary-blue-80"})]),_:2},1032,["onClick"])):C("",!0)]),_:1},8,["data-source"]),[[ae,e(l).length>0]])]),_:1},8,["tab"]),n(le,{key:"video",tab:"影音"},{default:s(()=>[ln,e(x).length<1?(c(),E(k,{key:0,"upload-type":"video",onChangeFile:z})):C("",!0),e(x).length>0?(c(),h("div",rn,[n(ie,{"video-source":e(x)[0],onDeleteVideo:i[0]||(i[0]=$=>H(!1,"video",0))},null,8,["video-source"])])):C("",!0)]),_:1},8,["tab"])]),_:1},8,["activeKey"])]),_:2},[e(j)(e(D))?{name:"closeIcon",fn:s(()=>[n(e(ct),{class:"ant-modal-close-icon text-black",onClick:V})]),key:"0"}:void 0]),1032,["open"]),n(re,{open:e(t).open,"onUpdate:open":i[4]||(i[4]=$=>e(t).open=$),title:e(t).delAll?"是否刪除所有已上傳的檔案？":"是否刪除已上傳的檔案？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onOk:ye},{default:s(()=>[un]),_:1},8,["open","title"]),n(re,{open:e(W).open,"onUpdate:open":i[5]||(i[5]=$=>e(W).open=$),title:" ",centered:"",footer:null,width:"960px"},{default:s(()=>[e(W).file?(c(),h("div",pn,[n(ie,{"video-source":e(W).file,"show-del-btn":!1,"image-class":"h-auto w-auto max-w-full"},null,8,["video-source"])])):C("",!0)]),_:1},8,["open"])],64)}}});var Ie=(m=>(m.SMS="SMS",m.MMS="MMS",m))(Ie||{});const dn=o("span",{class:"pe-.5"},"接收關鍵字",-1),mn=o("span",{class:"text-red-500 pe-2"},"*",-1),fn={href:"javascript:;"},_n=o("br",null,null,-1),gn=o("br",null,null,-1),vn=o("br",null,null,-1),yn={class:"flex justify-between w-full items-center"},xn=o("span",{class:"pe-1"},"群組標籤設定",-1),hn={href:"javascript:;"},bn=o("span",null,"新增群組標籤",-1),wn=o("span",{class:"pe-.5"},"訊息類型",-1),kn=o("span",{class:"text-red-500 pe-2"},"*",-1),$n={href:"javascript:;"},Sn=o("br",null,null,-1),Tn=o("span",{class:"pe-.5"},"自動回覆訊息內容",-1),Cn=o("span",{class:"text-red-500 pe-2"},"*",-1),Mn={href:"javascript:;"},Fn=o("br",null,null,-1),jn=o("br",null,null,-1),Dn={class:"flex gap-2 overflow-y-auto h-95px"},Rn={class:"text-sms-grayscale-60 text-xs font-500 font-sans text-center break-words"},Pn=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"}," 刪除的檔案將無法復原 ",-1),In=o("div",{class:"text-center px-30px py-20px w-328px text-base mx-auto"},[u(" 您編輯過的內容將全部清空 "),o("br"),o("p",null,[u(" 提醒您，SMS支援的字數較MMS少，"),o("br"),u(" 且不能上傳多媒體附件 ")])],-1),Qn=oe({__name:"auto-reply-form",setup(m){ke.extend(Ft);const{getGroupLabelOption:w,groupOptions:g}=Rt(),{setHideAlert:b,setShowAlert:y}=ot(),p=et(),f=He(),D=tt(),x=We(),{replaceFieldToHtml:l}=jt(),{autoReply:v,getAutoReply:Y,updateAutoReply:M,createAutoReply:z,checkAcceptKeywordExist:A}=Dt(),R=X(()=>D.name==="AutoReplyCreate");let N={phone:void 0,acceptKeyword:"",subject:"",messageType:"SMS",multimediaFile:[],group:void 0,newGroupName:"",takeEffectDates:void 0,content:""};const t=J(ft(N)),H=X(()=>t.messageType==="SMS"?335:1e3),ye=J({phone:[{required:!0,message:"請選擇發送門號",trigger:"blur"}],acceptKeyword:[{async validator(r,a){return j(a)?Promise.reject("請輸入接收關鍵字"):!j(a)&&await A(a)?Promise.reject(`生效開始與結束日期已存在接收關鍵字「 ${a} 」的設定，請勿重複新增`):Promise.resolve()},trigger:"blur"}],takeEffectDates:[{required:!0,message:"請選擇生效起迄日",trigger:"blur"}],subject:[{async validator(r,a){return t.messageType==="MMS"&&j(a)?Promise.reject("請輸入訊息主旨"):Promise.resolve()},trigger:"blur"}],content:[{async validator(r,a){var T;return j(a)?Promise.reject("請輸入自動回覆訊息內容"):!j(a)&&((T=t.content)==null?void 0:T.replace($e,"").length)>H.value?Promise.reject(`限制輸入 ${H.value} 字以內`):Promise.resolve()},trigger:"blur"}]}),{validateInfos:V,validate:ce,clearValidate:W,resetFields:_}=_t(t,ye);nt(async()=>{var r,a,T,O,F,I,B,ee,me,te,fe;R.value||(await Y(D.params.id),N={phone:(r=v.value)==null?void 0:r.phone,acceptKeyword:((a=v.value)==null?void 0:a.acceptKeyword)??"",subject:((T=v.value)==null?void 0:T.subject)??"",messageType:((O=v.value)==null?void 0:O.messageType)??"SMS",multimediaFile:((F=v.value)==null?void 0:F.multimediaFile)??[],group:(B=(I=v.value)==null?void 0:I.group)!=null&&B.id?[(ee=v.value)==null?void 0:ee.group.id]:void 0,newGroupName:"",takeEffectDates:(me=v.value)!=null&&me.startDate&&((te=v.value)!=null&&te.endDate)?[v.value.startDate,v.value.endDate]:void 0,content:l((fe=v.value)==null?void 0:fe.content)},_(N)),f.handleSelectedKeys(["/sms-marketing/auto-reploy"]),w()});const i=S(),k=X(()=>gt(t.group)||j(t.group)?g.value:g.value.map(r=>({...r,class:"pointer-events-none"}))),P=S(!0),Z=X(()=>R.value?"新增自動回覆":"編輯自動回覆");st(()=>t,r=>{vt(r,N)?b():y()},{deep:!0});function xe(){ce().then(async()=>{var T;((T=(await(e(R)?z:M)(t,D.params.id)).data)==null?void 0:T.status)==="success"&&(x.success({message:e(R)?"自動回覆新增成功":"自動回覆編輯成功",placement:"top"}),b(),p.push("/sms-marketing/auto-reply"))}).catch(r=>{console.log(r)})}const le=S(null);function ie(r){t.content=l(r)}const he=S(null);function re(r){for(const a of r)t.content=`${t.content}<span>${a}</span>`}const $=S(null);function be(r){t.content=`${t.content}<a href="${r}">${r}</a>`}const de=S(null);function we(r){const a=ke().add(1,"year"),T=ke().subtract(1,"d");return r<T||r>=a}const ze=X(()=>{const r=[];if(j(t.acceptKeyword)||r.push({content:t.acceptKeyword,messageType:"GET",contentType:"text"}),(!j(t.content)||!j(t.subject))&&r.push({phone:t.phone,content:t.content,...t.messageType==="MMS"&&{subject:t.subject},messageType:"SENT",contentType:"text"}),!j(t.multimediaFile))for(const a of t.multimediaFile)r.push({phone:t.phone,content:a.url,messageType:"SENT",contentType:a.type});return r.map((a,T)=>({...a,key:T}))}),Fe=S(null);function Ae(r){t.multimediaFile=r}const ue=J({open:!1});function Ne(r){Object.assign(ue,{open:!0,delFile:r})}function Ue(){t.multimediaFile=t.multimediaFile.filter(r=>{var a;return r.url!==((a=ue.delFile)==null?void 0:a.url)}),Object.assign(ue,{open:!1,delFile:void 0})}const pe=S(!1);function Oe(){t.messageType==="SMS"?!j(t.content)||!j(t.multimediaFile)?pe.value=!0:t.messageType="SMS":t.messageType="MMS"}return(r,a)=>{const T=yt,O=xt,F=ht,I=ve,B=bt,ee=wt,me=kt,te=Ce,fe=$t,Be=St,Ke=Tt,Le=Me,Ve=pt,je=Ct,Ee=Mt,Ge=Vt,De=Pe,Ye=qe;return c(),E(Ye,{title:e(Z),"custom-breadcrumb":[{title:"訊息行銷活動"},{path:"/sms-marketing/auto-reply",title:"自動回覆"},{title:e(Z)}]},{default:s(()=>[n(je,{class:"bg-sms-grayscale-0 rounded-4 p-10 pl-1",wrap:!1},{default:s(()=>[n(F,{flex:"auto"},{default:s(()=>[n(Ee,{class:"px-32px",layout:"vertical",autocomplete:"off",onSubmit:xe},{default:s(()=>[n(je,{gutter:[16,14]},{default:s(()=>[n(F,{span:24},{default:s(()=>[n(O,q(e(V).phone,{label:"發送門號",required:""}),{default:s(()=>[n(T,{value:e(t).phone,"onUpdate:value":a[0]||(a[0]=d=>e(t).phone=d),options:[{label:"0935-111-111",value:"0935-111-111"},{label:"0947-127-998",value:"0947-127-998"},{label:"0958-892-006",value:"0958-892-006"}],"allow-clear":"",placeholder:"請選擇發送門號"},null,8,["value"])]),_:1},16)]),_:1}),n(F,{span:24},{default:s(()=>[n(O,q(e(V).acceptKeyword,{extra:"最少 1 個字"}),{label:s(()=>[dn,mn,n(B,{placement:"top","get-popup-container":e(_e)},{title:s(()=>[u(" 假設情境："),_n,u(" Step1. 於此處設定接收關鍵字為「1」"),gn,u(" Step2. 傳送訊息，請客戶回覆「1」"),vn,u(" Step3. 若客戶回覆「1」，立即觸發自動回覆功能 ")]),default:s(()=>[o("a",fn,[n(I,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:s(()=>[n(ee,{value:e(t).acceptKeyword,"onUpdate:value":a[1]||(a[1]=d=>e(t).acceptKeyword=d),placeholder:"請輸入接收關鍵字"},null,8,["value"])]),_:1},16)]),_:1}),n(F,{span:24},{default:s(()=>[n(O,q(e(V).group,{"html-for":"","label-col":{style:{width:"100%"}},extra:"可選擇或新增 1 個標籤"}),{label:s(()=>[o("div",yn,[o("div",null,[xn,n(B,{placement:"top","get-popup-container":e(_e)},{title:s(()=>[u(" 將回傳該「接收關鍵字」的多筆門號打包至單一群組標籤，後續可進行再行銷 ")]),default:s(()=>[o("a",hn,[n(I,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),e(P)?(c(),E(me,{key:0,type:"link",class:"m-0 p-0",onClickCapture:a[2]||(a[2]=()=>P.value=!1)},{icon:s(()=>[n(I,{name:"plus"})]),default:s(()=>[u(" 新增群組標籤 ")]),_:1})):C("",!0)])]),default:s(()=>[n(T,{ref_key:"groupRef",ref:i,value:e(t).group,"onUpdate:value":a[3]||(a[3]=d=>e(t).group=d),options:e(k),"allow-clear":"","show-arrow":"",disabled:!e(P),placeholder:"請輸入",mode:"multiple",class:"w-full","option-filter-prop":"label","menu-item-selected-icon":" ",onSelect:a[4]||(a[4]=d=>{var Q;return(Q=e(i))==null?void 0:Q.blur()})},null,8,["value","options","disabled"])]),_:1},16)]),_:1}),se(n(F,{span:24,class:"bg-sms-bg-light-mode-gray rounded-md !p-2 !px-3"},{default:s(()=>[n(O,q({"html-for":"",extra:"只能新增 1 個群組標籤，15 字以內。"},e(V).newSmsCategory,{"label-col":{style:{width:"100%"}}}),{label:s(()=>[bn,n(te,{status:"small3",class:"m-0 p-0 ms-auto",onClick:a[5]||(a[5]=at(()=>{e(W)("newSmsCategory"),P.value=!0},["prevent"]))},{icon:s(()=>[n(I,{name:"close"})]),_:1})]),default:s(()=>[n(ee,{value:e(t).newGroupName,"onUpdate:value":a[6]||(a[6]=d=>e(t).newGroupName=d),placeholder:"請輸入新群組標籤",maxlength:15},null,8,["value"])]),_:1},16)]),_:1},512),[[ae,!e(P)]]),n(F,{span:24},{default:s(()=>[n(O,q(e(V).takeEffectDates,{label:"生效開始與結束日期",extra:"最多可設定 1 年"}),{default:s(()=>[n(fe,{value:e(t).takeEffectDates,"onUpdate:value":a[7]||(a[7]=d=>e(t).takeEffectDates=d),format:"YYYY/MM/DD","value-format":"YYYY/MM/DD",placeholder:["請選擇生效開始結束日期",""],class:"w-full",separator:"～","disabled-date":we},null,8,["value"])]),_:1},16)]),_:1}),n(F,{span:24},{default:s(()=>[n(O,q({"html-for":""},e(V).messageType),{label:s(()=>[wn,kn,n(B,{placement:"top","get-popup-container":e(_e)},{title:s(()=>[u(" SMS：上限 335 字"),Sn,u(" MMS：上限 1,000 字，可上傳多媒體 ")]),default:s(()=>[o("a",$n,[n(I,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:s(()=>[n(Ke,{value:e(t).messageType,"onUpdate:value":a[8]||(a[8]=d=>e(t).messageType=d),onChange:Oe},{default:s(()=>[(c(!0),h(G,null,ge(Object.entries(e(Ie)),([d,Q])=>(c(),E(Be,{key:d,value:d},{default:s(()=>[u(L(Q),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16)]),_:1}),se(n(F,{span:24},{default:s(()=>[n(O,q({label:"訊息主旨"},e(V).subject,{required:"",extra:"15 字以內"}),{default:s(()=>[n(ee,{value:e(t).subject,"onUpdate:value":a[9]||(a[9]=d=>e(t).subject=d),placeholder:"請輸入訊息主旨",maxlength:15},null,8,["value"])]),_:1},16)]),_:1},512),[[ae,e(t).messageType==="MMS"]]),n(F,{span:24},{default:s(()=>{var d;return[n(O,q({"html-for":""},e(V).content,{class:"relative",extra:`${e(t).messageType} 上限 ${e(H).toLocaleString()} 字，目前 ${e(j)(e(t).content)?"--":(d=e(t).content)==null?void 0:d.replace(e($e),"").length} 字`}),{label:s(()=>[Tn,Cn,n(B,{placement:"top","get-popup-container":e(_e)},{title:s(()=>[u(" 假設情境："),Fn,u(" Step1. 客戶回覆包含「接收關鍵字」的訊息"),jn,u(" Step2. 系統自動回覆此欄位內的內容 ")]),default:s(()=>[o("a",Mn,[n(I,{name:"union",width:"16px",class:"text-sms-grayscale-60"})])]),_:1},8,["get-popup-container"])]),default:s(()=>{var Q;return[n(Ve,{modelValue:e(t).content,"onUpdate:modelValue":a[14]||(a[14]=K=>e(t).content=K),contenteditable:"true",style:{height:"292px"},"content-len":(Q=e(t).content)==null?void 0:Q.replace(e($e),"").length,"max-len":e(H),placeholder:"請輸入文字"},Te({default:s(()=>[n(B,null,{title:s(()=>[u(" 載入現有的自訂訊息 ")]),default:s(()=>[n(I,{name:"import",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:a[10]||(a[10]=K=>{var U;return(U=e(le))==null?void 0:U.show()})})]),_:1}),n(B,null,{title:s(()=>[u(" 增加縮網址 ")]),default:s(()=>[n(I,{name:"link",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:a[11]||(a[11]=K=>{var U;return(U=e($))==null?void 0:U.show()})})]),_:1}),n(B,null,{title:s(()=>[u(" 多媒體附件上傳 ")]),default:s(()=>[se(n(I,{name:"cloud-upload",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:a[12]||(a[12]=K=>{var U;return(U=e(Fe))==null?void 0:U.show(e(t).multimediaFile)})},null,512),[[ae,e(t).messageType==="MMS"]])]),_:1}),n(B,null,{title:s(()=>[u(" AI 文字生成訊息 ")]),default:s(()=>[n(I,{name:"AI",class:"text-sms-bg-dark-mode cursor-pointer me-4",width:"24px",onClick:a[13]||(a[13]=K=>{var U;return(U=e(de))==null?void 0:U.show()})})]),_:1})]),_:2},[e(t).multimediaFile.length>0?{name:"multimediaBlock",fn:s(()=>[o("div",Dn,[(c(!0),h(G,null,ge(e(t).multimediaFile,K=>(c(),h("div",{key:K.url,class:"w-90px max-h-60px"},[n(Le,{"video-source":{url:K.url,type:K.type},"show-file-name":!1,"can-play":!1,size:"small","image-class":"object-cover w-full h-full",onDeleteVideo:U=>Ne(K)},null,8,["video-source","onDeleteVideo"]),o("div",Rn,L(K.fileName),1)]))),128))])]),key:"0"}:void 0]),1032,["modelValue","content-len","max-len"])]}),_:1},16,["extra"])]}),_:1}),n(F,{span:24,class:"text-end"},{default:s(()=>[n(te,{status:"small2",class:"me-2",onClick:a[15]||(a[15]=d=>r.$router.push("/sms-marketing/custom-message?tabActived=customMessage"))},{default:s(()=>[u(" 取消 ")]),_:1}),n(te,{status:"small1","html-type":"submit"},{default:s(()=>[u(" 確定 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n(F,{flex:"428px",class:"relative"},{default:s(()=>[n(Ge,{message:e(ze)},null,8,["message"])]),_:1})]),_:1}),n(lt,{ref_key:"importCustomMessageRef",ref:le,content:e(t).content,onUpdateContent:ie},null,8,["content"]),n(it,{ref_key:"addFieldRef",ref:he,onAddFieldToContent:re},null,512),n(rt,{ref_key:"addLinkRef",ref:$,onAddLinkToContent:be},null,512),n(ut,{ref_key:"aiTextGenerationRef",ref:de,content:e(t).content,onUpdateContent:ie},null,8,["content"]),n(cn,{ref_key:"multimediaUploadRef",ref:Fe,onUpdateMultimediaFile:Ae},null,512),n(De,{open:e(ue).open,"onUpdate:open":a[16]||(a[16]=d=>e(ue).open=d),title:"是否刪除已上傳的檔案？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onOk:Ue},{default:s(()=>[Pn]),_:1},8,["open"]),n(De,{open:e(pe),"onUpdate:open":a[17]||(a[17]=d=>Se(pe)?pe.value=d:null),title:"是否放棄目前編輯的內容？",centered:"","cancel-text":"取消","ok-text":"確定",width:"400px",onCancel:a[18]||(a[18]=d=>e(t).messageType="MMS"),onOk:a[19]||(a[19]=()=>{e(t).content="",e(t).multimediaFile=[],e(t).subject="",pe.value=!1})},{default:s(()=>[In]),_:1},8,["open"])]),_:1},8,["title","custom-breadcrumb"])}}});export{Qn as default};
